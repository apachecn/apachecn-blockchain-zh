# å¦‚ä½•ç”¨ä»¥å¤ªåŠã€Web3.js & Solidity æ™ºèƒ½åˆçº¦æ­å»ºåŒºå—é“¾ App

> åŸæ–‡ï¼š<https://www.dappuniversity.com/articles/how-to-build-a-blockchain-app>

ä½œè€…æ ¼é›·æˆˆé‡ŒÂ·éº¦å¡å®¾2022 å¹´ 12 æœˆ 1 æ—¥

å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯æ¥è‡ª [Dapp å¤§å­¦çš„](https://www.youtube.com/c/DappUniversity)[Gregory](https://www.twitter.com/DappUniversity)ï¼

æˆ‘å°†å‘æ‚¨å±•ç¤ºå¦‚ä½•ä½¿ç”¨ Ethereumã€Web3.js å’Œ Solidity smart contracts åˆ›å»ºæ‚¨çš„ç¬¬ä¸€ä¸ªåŒºå—é“¾åº”ç”¨ç¨‹åºã€‚ä½ ä¸éœ€è¦äº†è§£åŒºå—é“¾çš„ä»»ä½•äº‹æƒ…ã€‚æˆ‘ä»å¤´æ•™ä½ ã€‚ä½¿ç”¨è¿™ä¸ªåŒ…å«ä»£ç ç¤ºä¾‹å’Œä¹¦é¢è¯´æ˜çš„åˆ†æ­¥æŒ‡å—ï¼Œç«‹å³å¼€å§‹æ‚¨çš„åŒºå—é“¾å¼€å‘è€…ä¹‹æ—…ï¼

[https://www.youtube.com/embed/VH9Q2lf2mNo](https://www.youtube.com/embed/VH9Q2lf2mNo)

[*JOIN MY FREE TRAINING!*](/bootcamp) *

åœ¨ä¸Šé¢ 3 å°æ—¶çš„è§†é¢‘ä¸­ï¼Œæˆ‘å°†å¸¦æ‚¨æ„å»ºä¸€ä¸ªå®Œæ•´çš„åŒºå—é“¾åº”ç”¨ç¨‹åºã€‚æ‚¨ä¹Ÿå¯ä»¥æŒ‰ç…§æœ¬æŒ‡å—ä¸­çš„é€æ­¥è¯´æ˜è¿›è¡Œæ“ä½œã€‚å¦‚æœä½ å·²ç»çŸ¥é“äº†åŸºç¡€çŸ¥è¯†ï¼Œä½ å¯ä»¥[è·³è¿‡è¿™ä¸€æ­¥ï¼Œç°åœ¨å°±å¼€å§‹ç¼–å†™åº”ç”¨ç¨‹åºï¼](#part1)

## ç›®å½•

*   ä»‹ç»

*   æˆ‘ä»¬è¦å»ºé€ ä»€ä¹ˆï¼Ÿ
*   [ä»€ä¹ˆæ˜¯åŒºå—é“¾ï¼Ÿ](#whatIsABlockchain)
*   ä»€ä¹ˆæ˜¯æ™ºèƒ½åˆåŒï¼Ÿ
*   [åŒºå—é“¾ App æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ](#howDoesABlockchainAppWork)

*   æ•™ç¨‹æ­¥éª¤

*   [å®‰è£…ä¾èµ–å…³ç³»](#dependencies)
*   [ç¬¬ 1 éƒ¨åˆ†:é¡¹ç›®è®¾ç½®](#part1)
*   [ç¬¬äºŒéƒ¨åˆ†:é”€å”®äº§å“](#part2)
*   [ç¬¬ä¸‰éƒ¨åˆ†:è´­ä¹°äº§å“](#part3)
*   [ç¬¬ 4 éƒ¨åˆ†:å¸‚åœºç½‘ç«™è®¾ç½®(å‰ç«¯)](#part4)
*   [ç¬¬äº”éƒ¨åˆ†:é”€å”®äº§å“(å‰ç«¯)](#part5)
*   [ç¬¬å…­éƒ¨åˆ†:è´­ä¹°äº§å“(å‰ç«¯)](#part6)
*   [ç¬¬ä¸ƒéƒ¨åˆ†:éƒ¨ç½²é¡¹ç›®](#part7)

### æˆ‘ä»¬è¦å»ºé€ ä»€ä¹ˆï¼Ÿ

ä»Šå¤©ï¼Œæˆ‘å°†é€šè¿‡æ„å»ºä¸€ä¸ªç”±åŒºå—é“¾æ”¯æŒçš„å®Œæ•´åº”ç”¨ç¨‹åºï¼Œä»å¤´å¼€å§‹æ•™ä½ åŒºå—é“¾ç¼–ç¨‹ã€‚

æˆ‘ä»¬å°†åˆ›å»º:

1.  ä»¥å¤ªåŠæ™ºèƒ½åˆçº¦ä¸ Solidity ç¼–ç¨‹è¯­è¨€
2.  æˆ‘ä»¬å°†ç”¨ JavaScript ä¸ºæ™ºèƒ½åˆçº¦ç¼–å†™æµ‹è¯•
3.  æˆ‘ä»¬å°†æ™ºèƒ½åˆåŒéƒ¨ç½²åˆ°åŒºå—é“¾
4.  æˆ‘ä»¬å°†ä½¿ç”¨ Web3.js å’Œ React.js åˆ›å»ºä¸€ä¸ªå®¢æˆ·ç«¯ç½‘ç«™ï¼Œä»¥ä¾¿ç”¨æˆ·å¯ä»¥ä¸æ™ºèƒ½åˆåŒå¯¹è¯

å¦‚æœä½ ä¸æ‡‚è¿™äº›è¯­è¨€ï¼Œä¸è¦æ‹…å¿ƒï¼Œæˆ‘ä¼šè¾¹å­¦è¾¹æ•™ï¼

è®©æˆ‘ä»¬çœ‹çœ‹æˆ‘ä»¬å°†è¦æ„å»ºçš„åº”ç”¨ç¨‹åº:

![Blockchain App Demo Gif](img/b648b4ce7160253ec5bca82ddbf9497c.png)

è¿™æ˜¯ä¸€ä¸ªåœ¨åŒºå—é“¾ä¸Šè¿è¡Œçš„å¸‚åœºï¼Œæœ‰ç‚¹åƒ Craigslistã€‚å®ƒå…è®¸äººä»¬åˆ—å‡ºå¾…å”®å•†å“ï¼Œä½†ä¸ Craigslist ä¸åŒçš„æ˜¯ï¼Œå®ƒè¿˜å…è®¸äººä»¬åœ¨ç½‘ç«™ä¸Šç”¨åŠ å¯†è´§å¸è´­ä¹°å•†å“ã€‚

![Maketplace Blockchain App Diagram](img/55575e8c1deb4c47ec09c5a1e455cebd.png)

æ¯å½“æœ‰äººè´­ä¹°è¯¥ç‰©å“ï¼Œä»–ä»¬ç«‹å³æˆä¸ºæ‰€æœ‰è€…ã€‚è¿™æ˜¯å› ä¸ºè¯¥åº”ç”¨ç¨‹åºç”±åŒºå—é“¾ä¸Šç®¡ç†å¸‚åœºçš„æ™ºèƒ½åˆçº¦æä¾›æ”¯æŒã€‚å®ƒè·Ÿè¸ªè°æ‹¥æœ‰å¾…å”®å•†å“ï¼Œæ¯å½“æœ‰äººç”¨åŠ å¯†è´§å¸è´­ä¹°å•†å“æ—¶ï¼Œå®ƒå°±ä¼šè‡ªåŠ¨è½¬ç§»å•†å“çš„æ‰€æœ‰æƒã€‚å®ƒåƒè‡ªåŠ¨å”®è´§æœºä¸€æ ·å·¥ä½œã€‚

è®©æˆ‘æŠŠå®ƒåˆ†è§£ä¸€ä¸‹ï¼Œä»¥é˜²æœ‰ä»€ä¹ˆæ··æ·†ã€‚æˆ‘æ¥å›ç­”å‡ ä¸ªåŸºæœ¬é—®é¢˜ã€‚

### ä»€ä¹ˆæ˜¯åŒºå—é“¾ï¼Ÿ

åŒºå—é“¾æ˜¯ä¸€ä¸ªç‚¹å¯¹ç‚¹çš„èŠ‚ç‚¹ç½‘ç»œï¼Œæ‰€æœ‰èŠ‚ç‚¹éƒ½å¯ä»¥ç›¸äº’é€šä¿¡ã€‚è¿™äº›èŠ‚ç‚¹æœ¬è´¨ä¸Šæ˜¯åˆ†æ‹…ç±»ä¼¼äº web æœåŠ¡å™¨çš„èŒè´£çš„è®¡ç®—æœºï¼Œä¾‹å¦‚è¿è¡Œç¨‹åºå’Œå­˜å‚¨æ•°æ®ï¼Œåªè¦è¿æ¥åˆ°åŒºå—é“¾å°±å¯ä»¥è®¿é—®è¿™äº›æ•°æ®ã€‚æ‰€æœ‰èŠ‚ç‚¹ä¸€èµ·å·¥ä½œï¼Œåˆ›å»ºä¸€ä¸ªä»»ä½•äººéƒ½å¯ä»¥è¿æ¥çš„å…¬å…±ç½‘ç»œã€‚

ä½ å¯ä»¥ä»å‡ ä¸ªæ–¹é¢æ¥æ€è€ƒåŒºå—é“¾:

*   ä¸€å°å·¨å¤§çš„ä¸–ç•ŒèŒƒå›´çš„è®¡ç®—æœºç”±ååŒå·¥ä½œçš„å°å‹è®¡ç®—æœº(èŠ‚ç‚¹)ç»„æˆã€‚
*   ä»»ä½•äººéƒ½å¯ä»¥è¿æ¥åˆ°çš„ç½‘ç»œï¼Œç”¨äºæ±‡æ¬¾ã€è¿è¡Œç¨‹åºç­‰...
*   ä¸€ä¸ªå…è®¸ä½ å­˜å‚¨å’Œæ£€ç´¢ä¿¡æ¯çš„æ•°æ®åº“ã€‚

åŒºå—é“¾æ‰¿æ‹… web æœåŠ¡å™¨é€šå¸¸æ‰¿æ‹…çš„è´£ä»»:

*   è¿è¡Œåº”ç”¨ç¨‹åºä»£ç 
*   æ‰˜ç®¡æ•°æ®åº“

![Blockchain Node Diagram](img/8d5b41a15fe4317521f540e3b92c024c.png)

ç„¶è€Œï¼ŒåŒºå—é“¾å·¥ä½œæ–¹å¼ä¸åŒäºä¼ ç»Ÿçš„ web æœåŠ¡å™¨ã€‚åŒºå—é“¾ä¸Šçš„æ‰€æœ‰ä»£ç å’Œæ•°æ®éƒ½æ˜¯åˆ†æ•£çš„ï¼Œå³å®ƒåˆ†å¸ƒåœ¨ç½‘ç»œä¸­çš„æ‰€æœ‰èŠ‚ç‚¹ä¸Šã€‚å®ƒä¸ä½äºä¸­å¤®ç½‘ç»œæœåŠ¡å™¨ä¸Šã€‚

æ‰€æœ‰è¿™äº›æ•°æ®éƒ½åŒ…å«åœ¨åä¸º**æ•°æ®å—**çš„è®°å½•åŒ…ä¸­ï¼Œè¿™äº›æ•°æ®å— <u>*é“¾æ¥åœ¨ä¸€èµ·*</u> ç»„æˆå…¬å…±æ€»è´¦ã€‚ç½‘ç»œä¸Šçš„æ‰€æœ‰èŠ‚ç‚¹éƒ½å‚ä¸ç¡®ä¿è¿™äº›æ•°æ®ä¿æŒå®‰å…¨å’Œä¸å˜ã€‚è¿™å°±æ˜¯åŒºå—é“¾å¦‚æ­¤å¼ºå¤§çš„åŸå› ï¼

é‚£ä¹ˆï¼Œä½ å¦‚ä½•è¿æ¥åˆ°åŒºå—é“¾å¹¶ä½¿ç”¨å®ƒå‘¢ï¼Ÿ

ç”±äºè¿™æ˜¯ä¸€ä¸ªèŠ‚ç‚¹ç½‘ç»œï¼Œæ‚¨å¯ä»¥è¿è¡Œè‡ªå·±çš„èŠ‚ç‚¹ï¼Œæˆ–è€…è¿æ¥åˆ°ä¸€ä¸ªèŠ‚ç‚¹ã€‚ä¸€æ—¦ä½ è¿™æ ·åšäº†ï¼Œä½ å°±èƒ½è·å¾—åŒºå—é“¾çš„å…¨éƒ¨åŠ›é‡ï¼

### ä»€ä¹ˆæ˜¯æ™ºèƒ½åˆåŒï¼Ÿ

æ™ºèƒ½åˆçº¦æ˜¯æˆ‘ä»¬ç”¨æ¥åˆ›å»ºåŒºå—é“¾åº”ç”¨ç¨‹åºçš„æ„ä»¶ã€‚å®ƒä»¬æ˜¯æˆ‘ä»¬å¯ä»¥ç”¨æºä»£ç ç¼–å†™å¹¶éƒ¨ç½²åˆ°åŒºå—é“¾çš„ç¨‹åºã€‚å®ƒä»¬æ˜¯ç”¨ Solidity ç¼–ç¨‹è¯­è¨€ç¼–å†™çš„ï¼Œæˆ‘å°†åœ¨æœ¬æ•™ç¨‹ä¸­æ•™ä½ ã€‚

æ™ºèƒ½åˆçº¦æ˜¯ä¸å¯å˜çš„ï¼Œè¿™æ„å‘³ç€ä¸€æ—¦å®ƒä»¬è¢«åˆ›å»ºå°±ä¸èƒ½æ”¹å˜ï¼ä¸€æ—¦æ™ºèƒ½åˆçº¦è¢«éƒ¨ç½²åˆ°åŒºå—é“¾ï¼Œå…¶ä»£ç å°±ä¸èƒ½åƒæ™®é€šåº”ç”¨ç¨‹åºä¸€æ ·è¢«æ›´æ–°ã€‚è¿™æ˜¯å› ä¸ºå®ƒä»£è¡¨äº†ä¸€ä¸ªæ•°å­—åˆåŒæˆ–åè®®ã€‚æ¯•ç«Ÿï¼Œæ‚¨ä¸å¸Œæœ›ä»»ä½•å…¶ä»–çœŸå®ä¸–ç•Œçš„åˆåŒåœ¨åˆ›å»ºåå‘ç”Ÿå˜åŒ–ï¼Œå¯¹å—ï¼Ÿ

ä½ å¯ä»¥æŠŠæ™ºèƒ½åˆçº¦æƒ³è±¡æˆç½‘ç»œä¸Šçš„å¾®æœåŠ¡æˆ– APIã€‚å¦‚æœå…¬å…±åˆ†ç±»å¸å°±åƒä¸€ä¸ªæ•°æ®åº“ï¼Œé‚£ä¹ˆæ™ºèƒ½å¥‘çº¦å°±æ˜¯è¯»å–ã€å†™å…¥å’Œæ‰§è¡Œä¸šåŠ¡é€»è¾‘çš„å±‚ã€‚

#### æ™ºèƒ½åˆåŒæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ

åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†ç¼–å†™æ™ºèƒ½åˆåŒæ¥æ¨åŠ¨å¸‚åœºã€‚å®ƒçš„å·¥ä½œæ–¹å¼æœ‰ç‚¹åƒè‡ªåŠ¨å”®è´§æœºã€‚

![Maketplace Blockchain App Diagram](img/55575e8c1deb4c47ec09c5a1e455cebd.png)

ä»»ä½•æ—¶å€™æœ‰äººåœ¨å¸‚åœºä¸Šè´­ä¹°ç‰©å“ï¼Œä»–ä»¬éƒ½ä¼šå‘æ™ºèƒ½åˆçº¦å‘é€ä»¥å¤ªåŠåŠ å¯†è´§å¸ã€‚æ™ºèƒ½åˆåŒå°†åƒè‡ªåŠ¨å”®è´§æœºä¸€æ ·å·¥ä½œï¼Œå‘ä¹°å®¶åˆ†å‘å•†å“ï¼Œå¹¶å°†åŠ å¯†è´§å¸æ”¯ä»˜å³æ—¶è½¬ç§»åˆ°å–å®¶ã€‚

### åŒºå—é“¾ App æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ

ä¸ºäº†ç†è§£åŒºå—é“¾åº”ç”¨ç¨‹åºæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œè®©æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ä¸€ä¸ªæ™®é€šçš„ web åº”ç”¨ç¨‹åºæ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚

![Web Application Diagram](img/655588761c99d3fee2ec83c0bd4e4bb3.png)

é€šå¸¸ï¼Œå¯¹äº web åº”ç”¨ç¨‹åºï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ web æµè§ˆå™¨è®¿é—®ç½‘é¡µã€‚è¯¥ç½‘ç«™çš„æ‰€æœ‰ HTMLã€CSS å’Œ JavaScript ä»£ç éƒ½ä½äºä¸€ä¸ªä¸­å¤®ç½‘ç»œæœåŠ¡å™¨ä¸Šï¼Œå¹¶ä¸åç«¯(ç”¨ä»»ä½•ç¼–ç¨‹è¯­è¨€ç¼–å†™)å¯¹è¯ï¼Œåç«¯ä¹Ÿä¸æ•°æ®åº“å¯¹è¯ã€‚

æˆ‘ä»¬å°†åœ¨æœ¬æ•™ç¨‹ä¸­æ„å»ºçš„åŒºå—é“¾åº”ç”¨ç¨‹åºçš„å·¥ä½œæ–¹å¼ä¸åŒã€‚

![Blockchain App Diagram](img/1f1c29a7770dd39e2e5f9cc563d19903.png)

æˆ‘ä»¬å°†é€šè¿‡ä¸€ä¸ªç‰¹æ®Šçš„ web æµè§ˆå™¨è®¿é—®æˆ‘ä»¬çš„åŒºå—é“¾åº”ç”¨ç¨‹åºï¼Œè¯¥æµè§ˆå™¨ä¸ä¸€ä¸ªç”¨ HTMLã€CSS å’Œ JavaScript ç¼–å†™çš„å‰ç«¯ç½‘ç«™è¿›è¡Œå¯¹è¯ã€‚è¯¥ç½‘ç«™å°†ç›´æ¥ä¸åŒºå—é“¾å¯¹è¯ï¼Œè€Œä¸æ˜¯ä¸åç«¯ web æœåŠ¡å™¨å¯¹è¯ã€‚åŒºå—é“¾æœ¬è´¨ä¸Šå°†æ˜¯æˆ‘ä»¬çš„åç«¯ï¼Œä¸ºæˆ‘ä»¬åˆ†æ•£çš„å¸‚åœºæ‰˜ç®¡æ‰€æœ‰çš„ä»£ç å’Œæ•°æ®ã€‚

ç°åœ¨æˆ‘ä»¬å·²ç»ä»‹ç»äº†åŸºç¡€çŸ¥è¯†ï¼Œè®©æˆ‘ä»¬å¼€å§‹æ„å»ºæˆ‘ä»¬çš„é¡¹ç›®å§ï¼

## å®‰è£…ä¾èµ–é¡¹

æ•™ç¨‹è¿™ä¸€éƒ¨åˆ†çš„è§†é¢‘ç‰‡æ®µä» [5:49](https://www.youtube.com/watch?v=VH9Q2lf2mNo&feature=youtu.be&t=5m49s) å¼€å§‹ã€‚

ç°åœ¨è®©æˆ‘ä»¬å®‰è£…æ„å»ºé¡¹ç›®æ‰€éœ€çš„æ‰€æœ‰ä¾èµ–é¡¹ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬å°†å»ºç«‹ä¸€ä¸ªåŒºå—é“¾äººæ¥æœ¬åœ°å¼€å‘åº”ç”¨ç¨‹åºã€‚

##### Ganache ä¸ªäººåŒºå—é“¾

è¿™ç§ä¾èµ–æ€§æ˜¯ä¸€ç§ä¸ªäººåŒºå—é“¾ï¼Œæ˜¯ä¸€ç§æœ¬åœ°å¼€å‘åŒºå—é“¾ï¼Œå¯ç”¨äºæ¨¡ä»¿å…¬å…±åŒºå—é“¾çš„è¡Œä¸ºã€‚æˆ‘æ¨èä½¿ç”¨ [Ganache](http://truffleframework.com/ganache) ä½œä¸ºä½ ä»¥å¤ªåŠå¼€å‘çš„ä¸ªäººåŒºå—é“¾ã€‚å®ƒå°†å…è®¸æ‚¨éƒ¨ç½²æ™ºèƒ½åˆçº¦ã€å¼€å‘åº”ç”¨ç¨‹åºå’Œè¿è¡Œæµ‹è¯•ã€‚å®ƒå¯ä»¥ä½œä¸ºæ¡Œé¢åº”ç”¨ç¨‹åºå’Œå‘½ä»¤è¡Œå·¥å…·åœ¨ Windowsã€Mac å’Œ Linux ä¸Šä½¿ç”¨ï¼

![Ganache Personal Blockchain Application](img/ec8c8648c5fa5be4e5b4dbc42f7a411c.png)

åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘å°†æŒ‡å¯¼æ‚¨è®¾ç½®æ¡Œé¢åº”ç”¨ç¨‹åºã€‚ä½ å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°ä½ çš„æ“ä½œç³»ç»Ÿçš„æœ€æ–°ç‰ˆæœ¬ã€‚ä¸€æ—¦ä¸‹è½½äº†å­˜æ¡£çš„åŒ…ï¼Œè§£å‹å®‰è£…ç¨‹åºå¹¶è¿è¡Œå®‰è£…æ­¥éª¤ã€‚å®‰è£…å®Œæˆåï¼Œæ— è®ºä½•æ—¶æ‰“å¼€å®ƒï¼Œæ‚¨éƒ½ä¼šçœ‹åˆ°ä»¥ä¸‹å±å¹•:

![Ganache Personal Blockchain Application](img/406a84d52dfbafa5804518762028a0dd.png)

è€¶ï¼ğŸ‰ç°åœ¨ä½ æœ‰ä¸€ä¸ªä¸ªäººåŒºå—é“¾ç½‘ç»œè¿è¡Œï¼æ‚¨å¯ä»¥çœ‹åˆ°è¿è¡Œ Ganache çš„æœåŠ¡å™¨çš„ä¸€äº›è¯¦ç»†ä¿¡æ¯ï¼Œä»¥åŠè¿æ¥åˆ°ç½‘ç»œçš„å¸æˆ·åˆ—è¡¨ã€‚æ¯ä¸ªè´¦æˆ·éƒ½è¢«è®°å…¥ 100 è‹±é•‘ã€‚è¿™æ˜¯ä¸€ä¸ªå·¨å¤§çš„æ—¶é—´èŠ‚çœï¼å¦‚æœä½ æ‰“ç®—ä»å¤´å¼€å§‹åˆ›å»ºä½ è‡ªå·±çš„ä¸ªäººåŒºå—é“¾ç½‘ç»œï¼Œæˆ–è€…åœ¨ä¸€ä¸ªæµ‹è¯•ç½‘ç»œä¸Šå¼€å‘ä½ çš„åº”ç”¨ç¨‹åºï¼Œä½ å°†ä¸å¾—ä¸æ‰‹åŠ¨åˆ›å»ºæ‰€æœ‰ 10 ä¸ªå¸æˆ·ï¼Œå¹¶å‘æ¯ä¸ªå¸æˆ·å­˜å…¥ä¹™é†šã€‚è°¢å¤©è°¢åœ°ï¼ŒGanache å·²ç»ä¸ºæˆ‘ä»¬åšäº†è¿™ä»¶äº‹ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸å¿…æ‹…å¿ƒå®ƒã€‚

##### èŠ‚ç‚¹ã€‚å°„æµç ”ç©¶â€¦

æ—¢ç„¶æ‚¨å·²ç»è¿è¡Œäº†ç§æœ‰åŒºå—é“¾ï¼Œé‚£ä¹ˆæ‚¨éœ€è¦é…ç½®æ‚¨çš„ç¯å¢ƒæ¥å¼€å‘æ™ºèƒ½åˆçº¦ã€‚æ‚¨éœ€è¦çš„ç¬¬ä¸€ä¸ªä¾èµ–é¡¹æ˜¯ Node.js é™„å¸¦çš„[èŠ‚ç‚¹åŒ…ç®¡ç†å™¨](https://nodejs.org/en/)æˆ– NPMã€‚æ‚¨å¯ä»¥æŸ¥çœ‹æ˜¯å¦å·²ç»å®‰è£…äº† Nodeï¼Œæ–¹æ³•æ˜¯åœ¨ç»ˆç«¯ä¸Šé”®å…¥:

```js
$ node -v
```

å¦‚æœä½ è¿˜æ²¡æœ‰å®‰è£… nodeï¼Œä½ å¯ä»¥è®¿é—® [Node.js ç½‘ç«™](https://nodejs.org/en/)ä¸‹è½½ã€‚

##### å—èŒæ¡†æ¶

ç°åœ¨è®©æˆ‘ä»¬å®‰è£… [Truffle æ¡†æ¶](http://truffleframework.com/)ï¼Œå®ƒæä¾›äº†ä¸€å¥—ç”¨ Solidity ç¼–ç¨‹è¯­è¨€å¼€å‘ä»¥å¤ªåŠæ™ºèƒ½è”ç³»äººçš„å·¥å…·ã€‚

![Truffle Blockchain Smart Contract Development Framework](img/5bf384e0f0348826d8cb278471a06260.png)

ä»¥ä¸‹æ˜¯æˆ‘ä»¬å°†ä» Truffle æ¡†æ¶ä¸­è·å¾—çš„æ‰€æœ‰åŠŸèƒ½çš„æ¦‚è¿°:

*   æ™ºèƒ½åˆåŒç®¡ç† -ç”¨ Solidity ç¼–ç¨‹è¯­è¨€ç¼–å†™æ™ºèƒ½åˆåŒï¼Œå¹¶å°†å®ƒä»¬ç¼–è¯‘æˆè¿è¡Œåœ¨ä»¥å¤ªåŠè™šæ‹Ÿæœº(EVM)ä¸Šçš„å­—èŠ‚ç ã€‚
*   è‡ªåŠ¨åŒ–æµ‹è¯•(Automated Testing)â€”â€”é’ˆå¯¹ä½ çš„æ™ºèƒ½åˆçº¦ç¼–å†™æµ‹è¯•ï¼Œä»¥ç¡®ä¿å®ƒä»¬æŒ‰ç…§ä½ æƒ³è¦çš„æ–¹å¼è¿è¡Œã€‚è¿™äº›æµ‹è¯•å¯ä»¥ç”¨ JavaScript æˆ– Solidity ç¼–å†™ï¼Œå¯ä»¥åœ¨ Truffle é…ç½®çš„ä»»ä½•ç½‘ç»œä¸Šè¿è¡Œï¼ŒåŒ…æ‹¬å…¬å…±åŒºå—é“¾ç½‘ç»œã€‚
*   **éƒ¨ç½²&è¿ç§»** -ç¼–å†™è„šæœ¬å°†æ™ºèƒ½åˆçº¦è¿ç§»å’Œéƒ¨ç½²åˆ°ä»»ä½•å…¬å…±ä»¥å¤ªåŠåŒºå—é“¾ç½‘ç»œã€‚
*   **ç½‘ç»œç®¡ç†** -è¿æ¥åˆ°ä»»ä½•å…¬å…±ä»¥å¤ªåŠåŒºå—é“¾ç½‘ç»œï¼Œä»¥åŠä»»ä½•ä½ å¯èƒ½ç”¨äºå¼€å‘ç›®çš„çš„ä¸ªäººåŒºå—é“¾ç½‘ç»œã€‚
*   **å¼€å‘æ§åˆ¶å°**â€”â€”ä½¿ç”¨ Truffle æ§åˆ¶å°åœ¨ JavaScript è¿è¡Œæ—¶ç¯å¢ƒä¸­ä¸æ™ºèƒ½åˆçº¦è¿›è¡Œäº¤äº’ã€‚ä¸ºæ­¤ï¼Œæ‚¨å¯ä»¥è¿æ¥åˆ°æ‚¨åœ¨ç½‘ç»œé…ç½®ä¸­æŒ‡å®šçš„ä»»ä½•åŒºå—é“¾ç½‘ç»œã€‚
*   ç”¨ JavaScript ç¼–å†™å¯ä»¥åœ¨åŒºå—é“¾å…¬å…±ç½‘ç»œä¸Šè¿è¡Œçš„å®šåˆ¶è„šæœ¬ã€‚æ‚¨å¯ä»¥åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­ç¼–å†™ä»»æ„ä»£ç ï¼Œå¹¶åœ¨é¡¹ç›®ä¸­è¿è¡Œå®ƒã€‚
*   **å®¢æˆ·ç«¯å¼€å‘**â€”â€”é…ç½®æ‚¨çš„ truffle é¡¹ç›®æ¥æ‰˜ç®¡å®¢æˆ·ç«¯åº”ç”¨ç¨‹åºï¼Œè¿™äº›åº”ç”¨ç¨‹åºä¸éƒ¨ç½²åˆ°åŒºå—é“¾çš„æ™ºèƒ½åˆçº¦è¿›è¡Œå¯¹è¯ã€‚

ä½ å¯ä»¥åƒè¿™æ ·åœ¨å‘½ä»¤è¡Œä¸­å®‰è£…å¸¦æœ‰ NPM çš„æ¾éœ²ã€‚æ³¨æ„:ä¸ºäº†è·Ÿéšæœ¬æ•™ç¨‹ï¼Œä½¿ç”¨ä¸‹é¢æŒ‡å®šçš„æ¾éœ²çš„ç²¾ç¡®ç‰ˆæœ¬æ˜¯å¾ˆé‡è¦çš„ã€‚

```js
$ npm install -g [[emailÂ protected]](/cdn-cgi/l/email-protection)
```

##### Metamask ä»¥å¤ªåŠé’±åŒ…

ç°åœ¨æ˜¯æ—¶å€™æŠŠä½ çš„ç½‘ç»œæµè§ˆå™¨å˜æˆåŒºå—é“¾æµè§ˆå™¨äº†ã€‚å¤§å¤šæ•°ä¸»è¦çš„ç½‘ç»œæµè§ˆå™¨ç›®å‰éƒ½æ²¡æœ‰è¿æ¥åˆ°åŒºå—é“¾ç½‘ç»œï¼Œæ‰€ä»¥æˆ‘ä»¬å¿…é¡»å®‰è£…ä¸€ä¸ªæµè§ˆå™¨æ‰©å±•æ¥å…è®¸ä»–ä»¬è¿™æ ·åšã€‚

![Metamask Ethereum Wallet Browser Extension](img/8a69f48e4b01cf67ac98cf17178f69a4.png)

æˆ‘å°†ä¸ºè°·æ­Œæµè§ˆå™¨æ‰©å±•[å…ƒæ©ç ã€‚è¦å®‰è£… Metamaskï¼Œ](https://chrome.google.com/webstore/detail/metamask/nkbihfbeogaeaoehlefnkodbefgpgknn?hl=en)[è¯·è®¿é—®æ­¤é“¾æ¥](https://chrome.google.com/webstore/detail/metamask/nkbihfbeogaeaoehlefnkodbefgpgknn?hl=en)æˆ–åœ¨è°·æ­Œ Chrome ç½‘ç»œå•†åº—æœç´¢ Metamask Chrome æ’ä»¶ã€‚ä¸€æ—¦ä½ å®‰è£…äº†å®ƒï¼Œç¡®ä¿å®ƒåœ¨ä½ çš„æ‰©å±•åˆ—è¡¨ä¸­è¢«é€‰ä¸­ã€‚å®‰è£… Chrome æµè§ˆå™¨åï¼Œä½ ä¼šåœ¨æµè§ˆå™¨çš„å³ä¸Šè§’çœ‹åˆ°ç‹ç‹¸å›¾æ ‡ã€‚å¦‚æœé‡åˆ°å›°éš¾ï¼Œè¯·å‚è€ƒè§†é¢‘æ¼”ç¤ºï¼

Metamask è¿˜å…è®¸æˆ‘ä»¬åœ¨è¿æ¥åˆ°åŒºå—é“¾æ—¶ç®¡ç†æˆ‘ä»¬çš„ä¸ªäººè´¦æˆ·ï¼Œä»¥åŠç®¡ç†æˆ‘ä»¬éœ€è¦æ”¯ä»˜äº¤æ˜“çš„ä»¥å¤ªç½‘èµ„é‡‘ã€‚

## ç¬¬ 1 éƒ¨åˆ†:é¡¹ç›®è®¾ç½®

æ•™ç¨‹è¿™ä¸€éƒ¨åˆ†çš„è§†é¢‘ç‰‡æ®µä» [8:40](https://www.youtube.com/watch?v=VH9Q2lf2mNo&feature=youtu.be&t=8m40s) å¼€å§‹ã€‚é¦–å…ˆï¼Œç¡®ä¿æ‚¨å·²ç»å®‰è£…äº†[ä¸Šä¸€èŠ‚](#dependencies)ä¸­çš„æ‰€æœ‰ä¾èµ–é¡¹ã€‚

è®©æˆ‘ä»¬å¿«é€Ÿå¼€å§‹æ„å»ºæˆ‘ä»¬çš„åº”ç”¨ç¨‹åºå§ï¼æˆ‘ä»¬å°†ä½¿ç”¨æˆ‘çš„[åˆå­¦è€…å·¥å…·åŒ…](https://github.com/dappuniversity/starter_kit)ï¼Œè€Œä¸æ˜¯æ‰‹åŠ¨è®¾ç½®é¡¹ç›®ã€‚é€šè¿‡å…‹éš†åˆå­¦è€…å·¥å…·åŒ…åˆ›å»ºæ‚¨çš„é¡¹ç›®ï¼Œå¦‚ä¸‹æ‰€ç¤º:

```js
$ git clone https://github.com/dappuniversity/starter_kit marketplace
```

ç°åœ¨ï¼Œåƒè¿™æ ·è¿›å…¥åˆšåˆšå…‹éš†çš„ç›®å½•:

```js
$ cd marketplace
```

ğŸ‰ç»´å¥¥æ‹‰ã€‚æ‚¨å·²ç»ç«‹å³å»ºç«‹äº†æ‚¨çš„é¡¹ç›®ã€‚è®©æˆ‘ä»¬æ¥çœ‹çœ‹æˆ‘ä»¬åˆšåˆšåˆ›å»ºçš„å†…å®¹:

![Blockchain App File Structure](img/1dbf8fe64734958ced9bf74c1aa4b19e.png)

è¿™æ˜¯ä¸€ä¸ªè‡ªå®šä¹‰çš„ truffle é¡¹ç›®ï¼Œæˆ‘å·²ç»åˆ›å»ºæ¥å¸®åŠ©æ‚¨å¿«é€Ÿå¼€å§‹æ„å»ºå…¨æ ˆåŒºå—é“¾åº”ç”¨ç¨‹åºï¼æ‚¨å¯ä»¥åˆ›å»ºæ™ºèƒ½åˆçº¦ï¼Œæµ‹è¯•å®ƒä»¬ï¼Œå¹¶ä½¿ç”¨è¿™ä¸ªé¡¹ç›®ä¸­çš„ [Web3.js](https://github.com/ethereum/web3.js/) ã€ [React.js](https://reactjs.org/) å’Œ [Bootstrap](https://getbootstrap.com/) æ„å»ºå‰ç«¯ web åº”ç”¨ç¨‹åºã€‚

åœ¨`package.json`æ–‡ä»¶ä¸­å·²ç»æœ‰äº†æ‚¨éœ€è¦çš„æ‰€æœ‰ä¾èµ–é¡¹:

```js
{
  "name": "eth-marketplace",
  "version": "0.1.0",
  "description": "An Ethereum Marketplace",
  "author": "[[emailÂ protected]](/cdn-cgi/l/email-protection)",
  "dependencies": {
    "babel-polyfill": "6.26.0",
    "babel-preset-env": "1.7.0",
    "babel-preset-es2015": "6.24.1",
    "babel-preset-stage-2": "6.24.1",
    "babel-preset-stage-3": "6.24.1",
    "babel-register": "6.26.0",
    "bootstrap": "4.3.1",
    "chai": "4.2.0",
    "chai-as-promised": "7.1.1",
    "chai-bignumber": "3.0.0",
    "react": "16.8.4",
    "react-bootstrap": "1.0.0-beta.5",
    "react-dom": "16.8.4",
    "react-scripts": "2.1.3",
    "truffle": "5.0.5",
    "web3": "1.0.0-beta.55"
  },
  "scripts": {
    "start": "react-scripts start",
    "build": "react-scripts build",
    "test": "react-scripts test",
    "eject": "react-scripts eject"
  },
  "eslintConfig": {
    "extends": "react-app"
  },
  "browserslist": [
    ">0.2%",
    "not dead",
    "not ie <= 11",
    "not op_mini all"
  ]
} 
```

æ‚¨å¯ä»¥åƒè¿™æ ·ç»§ç»­å®‰è£…æ‚¨çš„ä¾èµ–é¡¹:

```js
$ npm install
```

æ¥ä¸‹æ¥è®©æˆ‘ä»¬çœ‹çœ‹`truffle-config.js`æ–‡ä»¶:

```js
require('babel-register');
require('babel-polyfill');

module.exports = {
  networks: {
    development: {
      host: "127.0.0.1",
      port: 7545,
      network_id: "*" // Match any network id
    },
  },
  contracts_directory: './src/contracts/',
  contracts_build_directory: './src/abis/',
  compilers: {
    solc: {
      optimizer: {
        enabled: true,
        runs: 200
      }
    }
  }
} 
```

è¯¥æ–‡ä»¶çš„ä¸»è¦èŒè´£æ˜¯å°†æˆ‘ä»¬çš„é¡¹ç›®è¿æ¥åˆ°åŒºå—é“¾ç½‘ç»œã€‚æˆ‘å·²ç»è®¾ç½®å¥½è¿æ¥åˆ°æˆ‘ä»¬çš„ Ganache ä¸ªäººåŒºå—é“¾ï¼Œå³`127.0.0.1:7545`ã€‚æˆ‘è¿˜ä¼šæåˆ°ï¼Œæˆ‘å·²ç»å°†è¿™ä¸ªé¡¹ç›®çš„ç»“æ„é…ç½®ä¸ºä¸åŒäº Truffle çš„é»˜è®¤æ–‡ä»¶ç»“æ„ã€‚æˆ‘å·²ç»å°†æ™ºèƒ½åˆåŒç§»åŠ¨åˆ°äº†`src`ç›®å½•ï¼Œè¿™æ · react åº”ç”¨ç¨‹åºå°±å¯ä»¥è®¿é—®å®ƒä»¬ã€‚ä½ å¯ä»¥åœ¨`contracts_directory`å’Œ`contracts_build_directory`è®¾ç½®ä¸‹çœ‹åˆ°é‚£ä¸ªé…ç½®ã€‚

ç°åœ¨æˆ‘ä»¬å·²ç»çœ‹åˆ°äº†é¡¹ç›®ç»“æ„ï¼Œè®©æˆ‘ä»¬é€šè¿‡åœ¨ contracts ç›®å½•ä¸­åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶æ¥å¼€å§‹ç¼–å†™æˆ‘ä»¬çš„æ™ºèƒ½åˆçº¦:

```js
$ touch src/contracts/Marketplace.sol
```

åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­ï¼Œè®©æˆ‘ä»¬å¼€å§‹ç¼–å†™æˆ‘ä»¬çš„æ™ºèƒ½å¥‘çº¦å¯é æ€§ç¼–ç¨‹è¯­è¨€:

```js
pragma solidity ^0.5.0;

contract Marketplace {

}
```

é¦–å…ˆï¼Œæˆ‘ä»¬é¦–å…ˆå£°æ˜æˆ‘ä»¬æƒ³è¦ä½¿ç”¨çš„ Solidity ç¼–ç¨‹è¯­è¨€çš„ç‰ˆæœ¬ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å£°æ˜æˆ‘ä»¬çš„æ™ºèƒ½å¥‘çº¦`Marketplace`ã€‚æˆ‘ä»¬å°†åœ¨èŠ±æ‹¬å·å†…æ·»åŠ æ‰€æœ‰æ™ºèƒ½åˆçº¦ä»£ç ã€‚è®©æˆ‘ä»¬è¿™æ ·åš:

```js
pragma solidity ^0.5.0;

contract Marketplace {
    string public name;

}
```

è¯¥ä»£ç åˆ›å»ºäº†ä¸€ä¸ªâ€œçŠ¶æ€å˜é‡â€ï¼Œå…¶å€¼å°†å­˜å‚¨åœ¨åŒºå—é“¾ä¸Šã€‚æˆ‘ä»¬å°†è°ƒç”¨å˜é‡`name`,å› ä¸ºæˆ‘ä»¬å°†ä½¿ç”¨å®ƒæ¥å­˜å‚¨æ™ºèƒ½åˆçº¦çš„åç§°(ä»…ç”¨äºæµ‹è¯•ç›®çš„)ã€‚ç”±äº Solidity æ˜¯ä¸€ç§é™æ€ç±»å‹çš„ç¼–ç¨‹è¯­è¨€ï¼Œæˆ‘ä»¬å¿…é¡»åœ¨å£°æ˜å˜é‡ä¹‹å‰å£°æ˜`string`æ•°æ®ç±»å‹ã€‚æœ€åï¼Œæˆ‘ä»¬å£°æ˜çŠ¶æ€å˜é‡`public`,è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åœ¨æ™ºèƒ½å¥‘çº¦ä¹‹å¤–è¯»å–å®ƒçš„å€¼ï¼Œæˆ‘ä»¬é©¬ä¸Šå°±ä¼šè¿™ä¹ˆåšã€‚

æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬è¿™æ ·è®¾ç½®è¿™ä¸ªå˜é‡çš„å€¼:

```js
pragma solidity ^0.5.0;

contract Marketplace {
    string public name;

    constructor() public {
        name = "Dapp University Marketplace";
    }
}
```

æˆ‘ä»¬åœ¨`constructor`å‡½æ•°ä¸­æŒ‡å®š`name`çš„å€¼ã€‚è¿™æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„å‡½æ•°ï¼Œæ¯å½“é¦–æ¬¡åˆ›å»ºæ™ºèƒ½åˆçº¦æ—¶ï¼Œå³éƒ¨ç½²åˆ°åŒºå—é“¾æ—¶ï¼Œéƒ½ä¼šè°ƒç”¨è¯¥å‡½æ•°ã€‚æ— è®ºä½•æ—¶éƒ¨ç½²ï¼Œå®ƒéƒ½ä¼šå°†`name`çš„å€¼è®¾ç½®ä¸ºæˆ‘ä»¬åœ¨è¿™é‡ŒæŒ‡å®šçš„å­—ç¬¦ä¸²ã€‚

ç°åœ¨ï¼Œè®©æˆ‘ä»¬ç¼–è¯‘æ™ºèƒ½åˆåŒï¼Œä»¥ç¡®ä¿ä¸€åˆ‡æ­£å¸¸:

```js
$ truffle compile
```

ç»ˆç«¯ä¸­çš„è¾“å‡ºå°†æ˜¾ç¤ºç¼–è¯‘åçš„æ™ºèƒ½åˆçº¦çš„ä½ç½®ï¼

æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬å°† mart å¥‘çº¦éƒ¨ç½²åˆ°æˆ‘ä»¬çš„ Ganache ä¸ªäºº blockhainã€‚ä¸ºæ­¤ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„è¿ç§»æ–‡ä»¶ï¼Œå¦‚ä¸‹æ‰€ç¤º:

```js
$ touch migrations/2_deploy_contracts.js
```

è¿™ä¸ªæ–‡ä»¶å‘Šè¯‰ Truffle å°†æˆ‘ä»¬çš„æ™ºèƒ½åˆåŒéƒ¨ç½²åˆ°åŒºå—é“¾ã€‚å¦‚æœä½ ç†Ÿæ‚‰çš„è¯ï¼Œè¿™æœ‰ç‚¹åƒä¼ ç»Ÿæ•°æ®åº“çš„è¿ç§»æ–‡ä»¶ã€‚å¦å¤–ï¼Œè¯·æ³¨æ„ï¼Œè¿ç§»æ–‡ä»¶æ˜¯æœ‰ç¼–å·çš„ï¼Œä»¥ä¾¿ Truffle çŸ¥é“ä»¥ä»€ä¹ˆé¡ºåºè¿è¡Œå®ƒä»¬ã€‚

å°†æ­¤ä»£ç è¾“å…¥åˆ°æ–°åˆ›å»ºçš„è¿ç§»ä¸­:

```js
const Marketplace = artifacts.require("Marketplace");

module.exports = function(deployer) {
  deployer.deploy(Marketplace);
};
```

ç°åœ¨è¿ç§»åƒè¿™æ ·è¿è¡Œè¿ç§»:

```js
$ truffle migrate
```

ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥ä»æ¾éœ²æ§åˆ¶å°æ£€æŸ¥æˆ‘ä»¬çš„æ™ºèƒ½åˆåŒã€‚æ‚¨å¯ä»¥ä»å‘½ä»¤è¡Œå¯åŠ¨ Truffle æ§åˆ¶å°ï¼Œå¦‚ä¸‹æ‰€ç¤º:

```js
$ truffle console
```

ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ§åˆ¶å°ä¸­ä½¿ç”¨ JavaScript è·å¾—æ™ºèƒ½åˆçº¦**çš„éƒ¨ç½²å‰¯æœ¬ï¼Œå¦‚ä¸‹æ‰€ç¤º:**

```js
marketplace = await Marketplace.deployed()
```

ä½ çš„ä¸»æœºå¯èƒ½ä¼šè¿”å›`undefined`ï¼Œä½†æ²¡å…³ç³»ï¼æ‚¨å¯ä»¥é€šè¿‡å†æ¬¡é”®å…¥å˜é‡åæ¥è·å–æ™ºèƒ½åå®šçš„å€¼ï¼Œå¦‚ä¸‹æ‰€ç¤º:

```js
marketplace
```

æ‚¨å¯ä»¥åœ¨åŒºå—é“¾ä¸Šè·å¾—æ™ºèƒ½åˆçº¦çš„åœ°å€ï¼Œå¦‚ä¸‹æ‰€ç¤º:

```js
marketplace.address
```

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¥è¯»ä¸€ä¸‹åå­—:

```js
name = await marketplace.name()
```

ç„¶å:

```js
name
```

è€¶ï¼ğŸ‰æ‚¨å·²ç»æˆåŠŸè®¾ç½®äº†é¡¹ç›®ï¼Œå¹¶å°†åŸºæœ¬æ™ºèƒ½åˆçº¦éƒ¨ç½²åˆ°åŒºå—é“¾ï¼

ç°åœ¨è®©æˆ‘ä»¬ä¸ºæ™ºèƒ½åˆçº¦ç¼–å†™ä¸€ä¸ªæµ‹è¯•ã€‚æµ‹è¯•æ™ºèƒ½åˆçº¦éå¸¸é‡è¦ï¼Œå› ä¸ºåœ¨åŒºå—é“¾ä¸Šçº¿ä¹‹å‰ï¼Œä½ éœ€è¦ç¡®ä¿å®ƒä»¬èƒ½å¤Ÿå®Œç¾è¿è¡Œã€‚è¯·è®°ä½ï¼Œä¸€æ—¦æ‚¨éƒ¨ç½²äº†å®ƒä»¬ï¼Œå®ƒä»¬å°±æ— æ³•æ›´æ”¹ï¼æ‚¨åªèƒ½é‡æ–°éƒ¨ç½²æ–°çš„å‰¯æœ¬ã€‚

ä¸ºæ™ºèƒ½åˆçº¦æµ‹è¯•åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶ï¼Œå¦‚ä¸‹æ‰€ç¤º:

```js
$ mkdir test
$ touch test/Marketplace.test.js 
```

åœ¨è¯¥æ–‡ä»¶ä¸­ï¼Œä½¿ç”¨ä»¥ä¸‹ä»£ç :

```js
const Marketplace = artifacts.require('./Marketplace.sol')

contract('Marketplace', (accounts) => {
  let marketplace

  before(async () => {
    marketplace = await Marketplace.deployed()
  })

  describe('deployment', async () => {
    it('deploys successfully', async () => {
      const address = await marketplace.address
      assert.notEqual(address, 0x0)
      assert.notEqual(address, '')
      assert.notEqual(address, null)
      assert.notEqual(address, undefined)
    })

    it('has a name', async () => {
      const name = await marketplace.name()
      assert.equal(name, 'Dapp University Marketplace')
    })

  })
})
```

æˆ‘æ¥è§£é‡Šä¸€ä¸‹è¿™ä¸ªæµ‹è¯•ã€‚æˆ‘ä»¬åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­ç”¨ Javascript ç¼–å†™äº†æ‰€æœ‰çš„æµ‹è¯•ï¼Œä½¿ç”¨äº†[Mocha æµ‹è¯•æ¡†æ¶](https://mochajs.org/)å’Œ[æŸ´æ–­è¨€åº“](http://www.chaijs.com/)ã€‚è¿™äº›éƒ½ä¸ Truffle æ¡†æ¶æ†ç»‘åœ¨ä¸€èµ·ã€‚æˆ‘ä»¬å°†ä½¿ç”¨ JavaScript ç¼–å†™æ‰€æœ‰è¿™äº›æµ‹è¯•æ¥æ¨¡æ‹Ÿå®¢æˆ·ç«¯ä¸æ™ºèƒ½åˆçº¦çš„äº¤äº’ï¼Œå°±åƒæˆ‘ä»¬åœ¨æ§åˆ¶å°ä¸­æ‰€åšçš„ä¸€æ ·ã€‚

è¿™ä¸ªæµ‹è¯•åšä¸¤ä»¶äº‹:

*   æ£€æŸ¥æ™ºèƒ½åˆçº¦æ˜¯å¦æœ‰åœ°å€ï¼Œå³å®ƒæ˜¯å¦å·²æˆåŠŸéƒ¨ç½²åˆ°ç½‘ç»œã€‚
*   æ£€æŸ¥éƒ¨ç½²æ—¶æ˜¯å¦è®¾ç½®äº†åç§°ã€‚

æ‚¨å¯ä»¥è§‚çœ‹è§†é¢‘ä»¥è·å¾—å¯¹è¯¥æµ‹è¯•æ–‡ä»¶çš„æ›´æ·±å…¥çš„è§£é‡Šã€‚

ç°åœ¨ï¼Œè®©æˆ‘ä»¬ä»å‘½ä»¤è¡Œè¿è¡Œæµ‹è¯•ï¼Œå¦‚ä¸‹æ‰€ç¤º:

```js
$ truffle test
```

ğŸ‰è€¶ï¼Œä»–ä»¬é€šè¿‡äº†ï¼

å¹²å¾—å¥½ï¼å¦‚æœä½ å¡ä½äº†ï¼Œè¯·éšæ„[å†çœ‹ä¸€éè¿™éƒ¨åˆ†è§†é¢‘ï¼Œä»¥ä¾¿è¿›ä¸€æ­¥æ¾„æ¸…](https://www.youtube.com/watch?v=VH9Q2lf2mNo&feature=youtu.be&t=8m40s)ã€‚ä½ ä¹Ÿå¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°æ‰€æœ‰ä»£ç çš„[å‰¯æœ¬](https://github.com/dappuniversity/marketplace/releases/tag/part-1)ã€‚

## ç¬¬ 2 éƒ¨åˆ†:é”€å”®äº§å“

è¿™éƒ¨åˆ†æ•™ç¨‹çš„è§†é¢‘ç‰‡æ®µä» [33:10](https://www.youtube.com/watch?v=VH9Q2lf2mNo&feature=youtu.be&t=33m10s) å¼€å§‹ã€‚ä½ ä¹Ÿå¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°[çš„ä»£ç ](https://github.com/dappuniversity/marketplace/releases/tag/part-2)ã€‚

ç°åœ¨ï¼Œè®©æˆ‘ä»¬ç»§ç»­æ„å»ºå¸‚åœºæ™ºèƒ½åˆçº¦ã€‚æˆ‘ä»¬å°†åˆ›å»ºç¬¬ä¸€ä¸ªåŠŸèƒ½ï¼Œå®ƒå°†å…è®¸ç”¨æˆ·åˆ—å‡ºå¸‚åœºä¸­çš„å¾…å”®å•†å“ã€‚ä¸ºäº†åšåˆ°è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬éœ€è¦ç”¨è¿™æ ·çš„ç»“æ„å¯¹äº§å“å»ºæ¨¡:

```js
struct Product {
    uint id;
    string name;
    uint price;
    address owner;
    bool purchased;
}
```

Solidity å…è®¸ä½ åˆ›å»ºä½ è‡ªå·±çš„æ•°æ®ç»“æ„ï¼Œå…·æœ‰ä»»æ„å±æ€§ã€‚è¿™æ­£æ˜¯æˆ‘ä»¬é€šè¿‡åˆ›å»ºä¸€ä¸ª`Product`ç»“æ„æ‰€åšçš„ã€‚å®ƒå­˜å‚¨äº†æˆ‘ä»¬éœ€è¦çš„äº§å“çš„æ‰€æœ‰å±æ€§ï¼Œæ¯”å¦‚`id`ã€`name`ã€`price`ã€`owner`å’Œ`purchased`ã€‚

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªåœ°æ–¹æ¥å‚¨å­˜åŒºå—é“¾ä¸Šçš„äº§å“ã€‚æˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªå®åº¦æ˜ å°„ï¼Œå¦‚ä¸‹æ‰€ç¤º:

```js
mapping(uint => Product) public products;
```

æ˜ å°„çš„å·¥ä½œæ–¹å¼ç±»ä¼¼äºå¸¦æœ‰é”®å€¼å¯¹çš„å…³è”æ•°ç»„æˆ–å“ˆå¸Œè¡¨ã€‚æ˜ å°„å…·æœ‰è¿”å›å”¯ä¸€å€¼çš„å”¯ä¸€é”®ã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ä¸€ä¸ª`id`ä½œä¸ºé”®ï¼Œå€¼å°†æ˜¯ä¸€ä¸ª`Product`ç»“æ„ã€‚è¿™å°†åŸºæœ¬ä¸Šå…è®¸æˆ‘ä»¬é€šè¿‡ id æŸ¥æ‰¾äº§å“ï¼Œå°±åƒæ•°æ®åº“ä¸€æ ·ã€‚

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å¸Œæœ›ä½¿ç”¨å¦‚ä¸‹æ‰€ç¤ºçš„`productCount`è®¡æ•°å™¨ç¼“å­˜æ¥è·Ÿè¸ªæ™ºèƒ½åˆåŒä¸­æœ‰å¤šå°‘äº§å“:

```js
uint public productCount = 0;
```

æˆ‘ä»¬ä½¿ç”¨è®¡æ•°å™¨ç¼“å­˜ï¼Œå› ä¸ºæ²¡æœ‰åŠæ³•çŸ¥é“æ˜ å°„ä¸­æœ‰å¤šå°‘äº§å“ã€‚ä½ ä¸èƒ½åœ¨ Solidiy ä¸­æ£€æŸ¥è´´å›¾çš„â€œé•¿åº¦â€æˆ–â€œå¤§å°â€ã€‚å› æ­¤ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è·å–æ‰€æœ‰çš„äº§å“ï¼Œæˆ‘ä»¬å¿…é¡»é€ä¸ªè¯»å‡ºå®ƒä»¬ã€‚æˆ‘ä»¬å°†ä½¿ç”¨è®¡æ•°å™¨ç¼“å­˜æ¥ç¡®å®šè¿™æ ·åšçš„æ¬¡æ•°ã€‚

æ­¤æ—¶ï¼Œæ‚¨çš„æ™ºèƒ½åˆçº¦åº”è¯¥å¦‚ä¸‹æ‰€ç¤º:

```js
pragma solidity ^0.5.0;

contract Marketplace {
    string public name;
    uint public productCount = 0;
    mapping(uint => Product) public products;

    struct Product {
        uint id;
        string name;
        uint price;
        address owner;
        bool purchased;
    }

    constructor() public {
        name = "Dapp University Marketplace";
    }

}
```

æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå‡½æ•°æ¥åˆ›å»ºæ–°äº§å“ã€‚è¿™ä¸ªå‡½æ•°å°†åšå‡ ä»¶äº‹:

*   ç”¨ç»“æ„åˆ›å»ºæ–°äº§å“
*   å°†è¯¥ç»“æ„æ·»åŠ åˆ°æ˜ å°„ä¸­ï¼Œå¹¶å°†å…¶å­˜å‚¨åœ¨åŒºå—é“¾ä¸Š
*   è§¦å‘ä¸€ä¸ªäº‹ä»¶ï¼Œè®©æŸäººçŸ¥é“ä¸€ä¸ªäº§å“è¢«åˆ›é€ äº†

æˆ‘ä»¬å¯ä»¥åƒè¿™æ ·åˆ›å»ºå‡½æ•°:

```js
function createProduct(string memory _name, uint _price) public {
    // Require a valid name
    require(bytes(_name).length > 0);
    // Require a valid price
    require(_price > 0);
    // Increment product count
    productCount ++;
    // Create the product
    products[productCount] = Product(productCount, _name, _price, msg.sender, false);
    // Trigger an event
    emit ProductCreated(productCount, _name, _price, msg.sender, false);
}
```

è®©æˆ‘è§£é‡Šä¸€ä¸‹è¿™æ®µä»£ç :

*   é¦–å…ˆï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ¥å—

    ```js
    name
    ```

    å’Œ

    ```js
    price
    ```

    å‚æ•°çš„å‡½æ•°ã€‚äº§å“ä»·æ ¼ç”¨ä»¥å¤ªçš„æœ€å°ç»†åˆ†å•ä½é­è¡¨ç¤º(å®Œæ•´è§£é‡Šè§è§†é¢‘)ã€‚
*   æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ·»åŠ ä¸€äº›åœ¨å‡½æ•°ç»§ç»­æ‰§è¡Œä¹‹å‰å¿…é¡»æ»¡è¶³çš„è¦æ±‚ã€‚æˆ‘ä»¬æ£€æŸ¥åç§°æ˜¯å¦å­˜åœ¨ï¼Œä»·æ ¼æ˜¯å¦å¤§äº 0ã€‚
*   æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬é€šè¿‡ä½¿ç”¨`++`æ“ä½œç¬¦å¢åŠ äº§å“è®¡æ•°æ¥ç”Ÿæˆä¸€ä¸ªæ–°çš„äº§å“ id(è¿™åªæ˜¯å°†å‰ä¸€ä¸ªå€¼åŠ  1)ã€‚
*   ç„¶åï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–°äº§å“å¹¶å°†å…¶æ·»åŠ åˆ°æ˜ å°„ä¸­ã€‚æ³¨æ„`msg.sender`æ˜¯åˆ›å»ºäº§å“çš„ç”¨æˆ·çš„åœ°å€ã€‚
*   æœ€åï¼Œæˆ‘ä»¬è§¦å‘ä¸€ä¸ªäº‹ä»¶ï¼Œè®©æ¯ä¸ªäººéƒ½çŸ¥é“äº§å“å·²ç»æˆåŠŸåˆ›å»ºã€‚

ç°åœ¨è®©æˆ‘ä»¬æ·»åŠ äº‹ä»¶å®šä¹‰ï¼Œä»¥ä¾¿å¯ä»¥è§¦å‘å®ƒ:

```js
event ProductCreated(
    uint id,
    string name,
    uint price,
    address owner,
    bool purchased
);
```

å¤–éƒ¨è®¢é˜…è€…å¯ä»¥ä¾¦å¬æ­¤äº‹ä»¶ï¼Œä»¥éªŒè¯äº§å“æ˜¯åœ¨åŒºå—é“¾ä¸Šåˆ›å»ºçš„ã€‚æˆ‘ä»¬å°†åœ¨æ™ºèƒ½åˆçº¦æµ‹è¯•ä¸­æ£€æŸ¥è¯¥äº‹ä»¶ã€‚

ç°åœ¨ï¼Œè¯¥éƒ¨åˆ†çš„å®Œæ•´æ™ºèƒ½åˆçº¦ä»£ç åº”è¯¥å¦‚ä¸‹æ‰€ç¤º:

```js
pragma solidity ^0.5.0;

contract Marketplace {
    string public name;
    uint public productCount = 0;
    mapping(uint => Product) public products;

    struct Product {
        uint id;
        string name;
        uint price;
        address owner;
        bool purchased;
    }

    event ProductCreated(
        uint id,
        string name,
        uint price,
        address owner,
        bool purchased
    );

    constructor() public {
        name = "Dapp University Marketplace";
    }

    function createProduct(string memory _name, uint _price) public {
        // Require a valid name
        require(bytes(_name).length > 0);
        // Require a valid price
        require(_price > 0);
        // Increment product count
        productCount ++;
        // Create the product
        products[productCount] = Product(productCount, _name, _price, msg.sender, false);
        // Trigger an event
        emit ProductCreated(productCount, _name, _price, msg.sender, false);
    }
}
```

ç°åœ¨è®©æˆ‘ä»¬æ·»åŠ ä¸€äº›æµ‹è¯•æ¥ç¡®ä¿è¿™ä¸ªå‡½æ•°æ­£å¸¸å·¥ä½œã€‚åœ¨æµ‹è¯•æ–‡ä»¶ä¸­ä½¿ç”¨ä»¥ä¸‹ä»£ç :

```js
const Marketplace = artifacts.require('./Marketplace.sol')

require('chai')
  .use(require('chai-as-promised'))
  .should()

contract('Marketplace', ([deployer, seller, buyer]) => {
  let marketplace

  before(async () => {
    marketplace = await Marketplace.deployed()
  })

  describe('deployment', async () => {
    it('deploys successfully', async () => {
      const address = await marketplace.address
      assert.notEqual(address, 0x0)
      assert.notEqual(address, '')
      assert.notEqual(address, null)
      assert.notEqual(address, undefined)
    })

    it('has a name', async () => {
      const name = await marketplace.name()
      assert.equal(name, 'Dapp University Marketplace')
    })
  })

  describe('products', async () => {
    let result, productCount

    before(async () => {
      result = await marketplace.createProduct('iPhone X', web3.utils.toWei('1', 'Ether'), { from: seller })
      productCount = await marketplace.productCount()
    })

    it('creates products', async () => {
      // SUCCESS
      assert.equal(productCount, 1)
      const event = result.logs[0].args
      assert.equal(event.id.toNumber(), productCount.toNumber(), 'id is correct')
      assert.equal(event.name, 'iPhone X', 'name is correct')
      assert.equal(event.price, '1000000000000000000', 'price is correct')
      assert.equal(event.owner, seller, 'owner is correct')
      assert.equal(event.purchased, false, 'purchased is correct')

      // FAILURE: Product must have a name
      await await marketplace.createProduct('', web3.utils.toWei('1', 'Ether'), { from: seller }).should.be.rejected;
      // FAILURE: Product must have a price
      await await marketplace.createProduct('iPhone X', 0, { from: seller }).should.be.rejected;
    })
  })
})
```

è®©æˆ‘ä»¬æ£€æŸ¥æ¯ä¸ªæ–°é›¶ä»¶ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬åƒè¿™æ ·åœ¨æµ‹è¯•å¥—ä»¶ä¸­æ·»åŠ ä¸€äº›é¢å¤–çš„å·¥å…·ã€‚æˆ‘ä»¬å·²ç»åœ¨æˆ‘ä»¬çš„åŒ…ä¸­å®‰è£…äº†è¿™äº›ã€‚

```js
require('chai')
.use(require('chai-as-promised'))
.should() 
```

æ¥ä¸‹æ¥ï¼Œå‘æµ‹è¯•åœºæ™¯æ·»åŠ  3 ä¸ªæ–°å¸æˆ·ï¼Œ`deployer`ã€`seller`å’Œ`buyer`:

```js
contract('Marketplace', ([deployer, seller, buyer]) => {
```

ç„¶åï¼Œæˆ‘ä»¬ä¸ºåˆ›å»ºäº§å“åˆ›å»ºä¸€ä¸ªæ–°çš„æµ‹è¯•ç¤ºä¾‹:

```js
describe('products', async () => {
  let result, productCount

  before(async () => {
    result = await marketplace.createProduct('iPhone X', web3.utils.toWei('1', 'Ether'), { from: seller })
    productCount = await marketplace.productCount()
  })

  //... 
```

è¿™ç”¨ä¸€ä¸ª`before`é’©å­è®¾ç½®äº†æµ‹è¯•ç¤ºä¾‹ï¼Œåœ¨æ¯ä¸ªæµ‹è¯•è¿è¡Œä¹‹å‰åˆ›å»ºä¸€ä¸ªäº§å“ã€‚æœ€åï¼Œæˆ‘ä»¬ä¸ºäº§å“åˆ›å»ºåˆ›å»ºä¸€ä¸ªå®Œæ•´çš„æµ‹è¯•ï¼Œå¦‚ä¸‹æ‰€ç¤º:

```js
it('creates products', async () => {
  // SUCCESS
  assert.equal(productCount, 1)
  const event = result.logs[0].args
  assert.equal(event.id.toNumber(), productCount.toNumber(), 'id is correct')
  assert.equal(event.name, 'iPhone X', 'name is correct')
  assert.equal(event.price, '1000000000000000000', 'price is correct')
  assert.equal(event.owner, seller, 'owner is correct')
  assert.equal(event.purchased, false, 'purchased is correct')

  // FAILURE: Product must have a name
  await await marketplace.createProduct('', web3.utils.toWei('1', 'Ether'), { from: seller }).should.be.rejected;
  // FAILURE: Product must have a price
  await await marketplace.createProduct('iPhone X', 0, { from: seller }).should.be.rejected;
})
```

é¦–å…ˆï¼Œæˆ‘ä»¬æ£€æŸ¥åˆ›å»ºä¸€ä¸ªäº§å“æ˜¯å¦ä½¿äº§å“æ•°é‡å¢åŠ äº† 1ã€‚ç„¶åï¼Œæˆ‘ä»¬æ£€æŸ¥æ™ºèƒ½åˆçº¦äº‹ä»¶æ—¥å¿—ï¼Œä»¥æŸ¥çœ‹äº§å“æ˜¯ç”¨æ­£ç¡®çš„å€¼åˆ›å»ºçš„ã€‚æˆ‘ä»¬åƒè¿™æ ·æ·±å…¥ç ”ç©¶äº‹ä»¶æ—¥å¿—:`result.logs[0].args`(å°è¯•å°†è¿™äº›å€¼è®°å½•åˆ°æ§åˆ¶å°ï¼Œçœ‹çœ‹å®ƒä»¬æ˜¯ä»€ä¹ˆæ ·å­)ã€‚æˆ‘ä»¬æ£€æŸ¥æ‰€æœ‰è¿™äº›å€¼æ˜¯å¦æ­£ç¡®ï¼Œå¦‚ idã€å§“åã€ä»·æ ¼ç­‰...

æœ€åï¼Œæˆ‘ä»¬æ£€æŸ¥å¤±è´¥æ¡ˆä¾‹ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ²¡æœ‰åå­—ï¼Œæˆ–è€…å¦‚æœä»·æ ¼å°äºæˆ–ç­‰äº 0ï¼Œæˆ‘ä»¬ç¡®ä¿å‡½æ•°è°ƒç”¨å¤±è´¥ã€‚

å¹²å¾—å¥½ï¼å¦‚æœä½ å¡ä½äº†ï¼Œè¯·éšæ„[å†çœ‹ä¸€éè¿™éƒ¨åˆ†è§†é¢‘ï¼Œä»¥ä¾¿è¿›ä¸€æ­¥æ¾„æ¸…](https://www.youtube.com/watch?v=VH9Q2lf2mNo&feature=youtu.be&t=33m10s)ã€‚ä½ ä¹Ÿå¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°æ‰€æœ‰ä»£ç çš„[å‰¯æœ¬](https://github.com/dappuniversity/marketplace/releases/tag/part-2)ã€‚

## ç¬¬ 3 éƒ¨åˆ†:è´­ä¹°äº§å“

æœ¬æ•™ç¨‹è¿™ä¸€éƒ¨åˆ†çš„è§†é¢‘ç‰‡æ®µä» [01:01:07](https://www.youtube.com/watch?v=VH9Q2lf2mNo&feature=youtu.be&t=1h1m7s) å¼€å§‹ã€‚ä½ ä¹Ÿå¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°[çš„ä»£ç ](https://github.com/dappuniversity/marketplace/releases/tag/part-2)ã€‚

ç°åœ¨è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªè´­ä¹°äº§å“çš„å‡½æ•°ã€‚æ¯å½“æœ‰äººè°ƒç”¨è¿™ä¸ªå‡½æ•°æ—¶ï¼Œä»–ä»¬å°†æäº¤ä»–ä»¬æƒ³è¦è´­ä¹°çš„äº§å“çš„`id`(è¿™å°†ç”±æˆ‘ä»¬çš„å®¢æˆ·ç«¯åº”ç”¨ç¨‹åºå¤„ç†)ã€‚æ­¤å¤–ï¼Œå½“ä»–ä»¬è°ƒç”¨è¯¥åŠŸèƒ½æ—¶ï¼Œä»–ä»¬å°†ä»é’±åŒ…ä¸­å‘é€ä»¥å¤ªåŠåŠ å¯†è´§å¸æ¥è´­ä¹°äº§å“ã€‚æˆ‘ä»¬å°†åƒè¿™æ ·è®¾ç½®å‡½æ•°:

```js
function purchaseProduct(uint _id) public payable {
  // ...
}
```

æ³¨æ„ï¼Œæˆ‘ä»¬å·²ç»åšäº†è¿™ä¸ªå‡½æ•°`payable`ï¼Œè¿™æ„å‘³ç€å®ƒå°†æ¥å— Etherum åŠ å¯†è´§å¸ã€‚æˆ‘ä»¬å¾ˆå¿«å°±ä¼šçœ‹åˆ°è¿™ä¸€ç‚¹ã€‚å› ä¸ºæˆ‘ä»¬è¦å‘æ‰€æœ‰è€…ä»˜è´¹ï¼Œæ‰€ä»¥æˆ‘ä»¬å¿…é¡»æ›´æ–°ç°æœ‰çš„ç»“æ„å’Œäº‹ä»¶æ¥ä½¿ç”¨`address payable`ç±»å‹ï¼Œå¦‚ä¸‹æ‰€ç¤º:

```js
struct Product {
    uint id;
    string name;
    uint price;
    address payable owner;
    bool purchased;
}
```

```js
event ProductCreated(
    uint id,
    string name,
    uint price,
    address payable owner,
    bool purchased
);
```

ç°åœ¨è®©æˆ‘ä»¬å¡«å†™å‡½æ•°å†…éƒ¨çš„ä»£ç :

```js
function purchaseProduct(uint _id) public payable {
    // Fetch the product
    Product memory _product = products[_id];
    // Fetch the owner
    address payable _seller = _product.owner;
    // Make sure the product has a valid id
    require(_product.id > 0 && _product.id <= productCount);
    // Require that there is enough Ether in the transaction
    require(msg.value >= _product.price);
    // Require that the product has not been purchased already
    require(!_product.purchased);
    // Require that the buyer is not the seller
    require(_seller != msg.sender);
    // Transfer ownership to the buyer
    _product.owner = msg.sender;
    // Mark as purchased
    _product.purchased = true;
    // Update the product
    products[_id] = _product;
    // Pay the seller by sending them Ether
    address(_seller).transfer(msg.value);
    // Trigger an event
    emit ProductPurchased(productCount, _product.name, _product.price, msg.sender, true);
}
```

è®©æˆ‘è§£é‡Šä¸€ä¸‹è¿™ä¸ªå‡½æ•°çš„ä½œç”¨ã€‚

*   é¦–å…ˆï¼Œæˆ‘ä»¬ä»æ˜ å°„ä¸­è·å–äº§å“ï¼Œå¹¶åœ¨å†…å­˜ä¸­åˆ›å»ºå®ƒçš„æ–°å‰¯æœ¬ã€‚
*   ç„¶åï¼Œæˆ‘ä»¬å°†å½“å‰æ‰€æœ‰è€…å­˜å‚¨åˆ°ä¸€ä¸ªå˜é‡ä¸­ã€‚æˆ‘ä»¬å°†åœ¨è¿™ä¸ªå‡½æ•°ä¸­è½¬ç§»äº§å“çš„æ‰€æœ‰æƒï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦çŸ¥é“æœ€åˆçš„æ‰€æœ‰è€…æ˜¯è°ã€‚
*   æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ·»åŠ ä¸€äº›éœ€æ±‚ã€‚æˆ‘ä»¬æ£€æŸ¥æœ‰æ•ˆçš„ idï¼Œäº¤æ˜“ä¸­æœ‰è¶³å¤Ÿçš„ä»¥å¤ªç½‘åŠ å¯†è´§å¸ï¼Œä¹°æ–¹ä¸æ˜¯å–æ–¹ï¼Œå¹¶ä¸”äº§å“å°šæœªè´­ä¹°ã€‚
*   ç„¶åæˆ‘ä»¬ä¿ƒæˆäº¤æ˜“ã€‚æˆ‘ä»¬å°†æ‰€æœ‰æƒè½¬ç§»ç»™ä¹°æ–¹ï¼Œå°†äº§å“æ ‡è®°ä¸ºå·²è´­ä¹°ï¼Œå¹¶å°†äº§å“æ·»åŠ å›æ˜ å°„ã€‚ä¹‹åï¼Œæˆ‘ä»¬å°†åŠ å¯†è´§å¸ä»˜æ¬¾å‘é€ç»™å–å®¶ã€‚è¯·æ³¨æ„ï¼Œä»¥å¤ªåŠ å¯†è´§å¸é‡‘é¢æ˜¯ç”¨å‡½æ•°çš„å…ƒæ•°æ®æ¥è·Ÿè¸ªçš„ã€‚æˆ‘ä»¬å¯ä»¥ç”¨å…¨å±€å˜é‡`msg.sender`æ¥è®¿é—®è¿™ä¸ªå€¼ã€‚åŒæ ·ï¼Œè¯¥å€¼ç”¨ Wei è¡¨ç¤º(è¿›ä¸€æ­¥è§£é‡Šè§è§†é¢‘)ã€‚
*   æœ€åï¼Œæˆ‘ä»¬è§¦å‘ä¸€ä¸ªäº‹ä»¶æ¥å£°æ˜äº§å“å·²ç»æˆåŠŸåˆ›å»ºã€‚

ç°åœ¨è®©æˆ‘ä»¬ä¸ºäº§å“é”€å”®åˆ›å»ºä¸€ä¸ªæ–°äº‹ä»¶ã€‚å®ƒçš„å·¥ä½œæ–¹å¼ä¸æˆ‘ä»¬åœ¨ä¸Šä¸€èŠ‚ä¸­åˆ›å»ºçš„äº‹ä»¶å‡ ä¹å®Œå…¨ä¸€æ ·ï¼Œåªæ˜¯åç§°ä¸åŒ:

```js
event ProductPurchased(
    uint id,
    string name,
    uint price,
    address payable owner,
    bool purchased
);
```

ç°åœ¨è®©æˆ‘ä»¬ä¸º`purchaseProduct`å‡½æ•°æ·»åŠ ä¸€ä¸ªæµ‹è¯•ï¼Œå¦‚ä¸‹æ‰€ç¤º:

```js
it('sells products', async () => {
  // Track the seller balance before purchase
  let oldSellerBalance
  oldSellerBalance = await web3.eth.getBalance(seller)
  oldSellerBalance = new web3.utils.BN(oldSellerBalance)

  // SUCCESS: Buyer makes purchase
  result = await marketplace.purchaseProduct(productCount, { from: buyer, value: web3.utils.toWei('1', 'Ether')})

  // Check logs
  const event = result.logs[0].args
  assert.equal(event.id.toNumber(), productCount.toNumber(), 'id is correct')
  assert.equal(event.name, 'iPhone X', 'name is correct')
  assert.equal(event.price, '1000000000000000000', 'price is correct')
  assert.equal(event.owner, buyer, 'owner is correct')
  assert.equal(event.purchased, true, 'purchased is correct')

  // Check that seller received funds
  let newSellerBalance
  newSellerBalance = await web3.eth.getBalance(seller)
  newSellerBalance = new web3.utils.BN(newSellerBalance)

  let price
  price = web3.utils.toWei('1', 'Ether')
  price = new web3.utils.BN(price)

  const exepectedBalance = oldSellerBalance.add(price)

  assert.equal(newSellerBalance.toString(), exepectedBalance.toString())

  // FAILURE: Tries to buy a product that does not exist, i.e., product must have valid id
  await marketplace.purchaseProduct(99, { from: buyer, value: web3.utils.toWei('1', 'Ether')}).should.be.rejected;      // FAILURE: Buyer tries to buy without enough ether
  // FAILURE: Buyer tries to buy without enough ether
  await marketplace.purchaseProduct(productCount, { from: buyer, value: web3.utils.toWei('0.5', 'Ether') }).should.be.rejected;
  // FAILURE: Deployer tries to buy the product, i.e., product can't be purchased twice
  await marketplace.purchaseProduct(productCount, { from: deployer, value: web3.utils.toWei('1', 'Ether') }).should.be.rejected;
  // FAILURE: Buyer tries to buy again, i.e., buyer can't be the seller
  await marketplace.purchaseProduct(productCount, { from: buyer, value: web3.utils.toWei('1', 'Ether') }).should.be.rejected;
})
```

è¿™ä¸ªæµ‹è¯•çš„å·¥ä½œæ–¹å¼å¾ˆåƒ`sellProduct()`åŠŸèƒ½æµ‹è¯•ã€‚å®ƒåšäº†å‡ ä»¶å…³é”®çš„äº‹æƒ…:

*   æ£€æŸ¥äº§å“æ˜¯å¦å·²è½¬è®©ç»™ä¹°æ–¹
*   æ£€æŸ¥å–å®¶æ˜¯å¦è‡ªåŠ¨æ”¶åˆ°åŠ å¯†è´§å¸èµ„é‡‘
*   æ£€æŸ¥æ‰€æœ‰çš„å¤±è´¥æ¡ˆä¾‹ï¼Œä»¥ç¡®ä¿æˆ‘ä»¬åœ¨å‡½æ•°å†…éƒ¨é˜²æ­¢å®ƒä»¬

ç°åœ¨ï¼Œè®©æˆ‘ä»¬ä»å‘½ä»¤è¡Œè¿è¡Œæµ‹è¯•ï¼Œå¦‚ä¸‹æ‰€ç¤º:

```js
$ truffle test
```

ğŸ‰è€¶ï¼Œä»–ä»¬é€šè¿‡äº†ï¼

æœ€åï¼Œè®©æˆ‘ä»¬å°†æ™ºèƒ½åˆåŒéƒ¨ç½²åˆ°ç½‘ç»œä¸­ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åœ¨ä¸‹ä¸€èŠ‚å¼€å§‹æ„å»ºå®¢æˆ·ç«¯åº”ç”¨ç¨‹åºæ¥ä¸å®ƒäº¤äº’ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨`--reset`æ ‡å¿—é‡æ–°è¿è¡Œæˆ‘ä»¬çš„è¿ç§»ï¼Œå°†æ™ºèƒ½åˆåŒè¿ç§»åˆ°ç½‘ç»œä¸­ã€‚å®ƒå°†åœ¨åŒºå—é“¾å·ä¸Šåˆ›å»ºæ™ºèƒ½åˆåŒçš„æ–°å‰¯æœ¬:

```js
$ truffle migrate --reset
```

å¹²å¾—å¥½ï¼å¦‚æœä½ å¡ä½äº†ï¼Œè¯·éšæ„[å†çœ‹ä¸€éè¿™éƒ¨åˆ†è§†é¢‘ï¼Œä»¥ä¾¿è¿›ä¸€æ­¥æ¾„æ¸…](https://www.youtube.com/watch?v=VH9Q2lf2mNo&feature=youtu.be&t=1h1m07s)ã€‚ä½ ä¹Ÿå¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°æ‰€æœ‰ä»£ç çš„[å‰¯æœ¬](https://github.com/dappuniversity/marketplace/releases/tag/part-3)ã€‚

## ç¬¬ 4 éƒ¨åˆ†:å¸‚åœºç½‘ç«™è®¾ç½®(å‰ç«¯)

æœ¬æ•™ç¨‹è¿™ä¸€éƒ¨åˆ†çš„è§†é¢‘ç‰‡æ®µä» [01:26:20](https://www.youtube.com/watch?v=VH9Q2lf2mNo&feature=youtu.be&t=1h26m20s) å¼€å§‹ã€‚ä½ ä¹Ÿå¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°[çš„ä»£ç ](https://github.com/dappuniversity/marketplace/releases/tag/part-4)ã€‚

ç°åœ¨è®©æˆ‘ä»¬å¼€å§‹ä¸ºå¸‚åœºæ„å»ºå®¢æˆ·ç«¯åº”ç”¨ç¨‹åºã€‚æˆ‘ä»¬å°†åœ¨è¿™ä¸€éƒ¨åˆ†åšä»¥ä¸‹å·¥ä½œ:

*   å¯åŠ¨åº”ç”¨ç¨‹åºï¼Œå¹¶åœ¨æˆ‘ä»¬çš„æµè§ˆå™¨ä¸­è¿è¡Œåˆå­¦è€…å·¥å…·åŒ…
*   å°†æˆ‘ä»¬çš„ç½‘ç»œæµè§ˆå™¨è¿æ¥åˆ°åŒºå—é“¾
*   å°†æˆ‘ä»¬çš„ web åº”ç”¨ç¨‹åºè¿æ¥åˆ°åŒºå—é“¾ï¼Œå¹¶å¼€å§‹ä¸å¸‚åœºæ™ºèƒ½åˆçº¦å¯¹è¯

*   åœ¨æˆ‘ä»¬å¼€å§‹ä¹‹å‰ï¼Œè¯·ç¡®ä¿æ‚¨çš„å¼€å‘æœåŠ¡å™¨æ­£åœ¨è¿è¡Œ:

```js
$ npm run start
```

è¿™å°†å¯åŠ¨æ‚¨çš„ web æœåŠ¡å™¨ï¼Œå¹¶è‡ªåŠ¨åœ¨æ‚¨çš„æµè§ˆå™¨ä¸­æ‰“å¼€ç½‘ç«™ï¼Œå¦‚ä¸‹æ‰€ç¤º:

![Blockchain App Template](img/02c3e9a00f735c921c17b63fced09c4d.png)

è¿™ä¸ªåˆå­¦è€…å·¥å…·åŒ…æä¾›äº†æ„å»ºæˆ‘ä»¬çš„åº”ç”¨ç¨‹åºæ‰€éœ€çš„ä¸€åˆ‡:

*   React.js æ¥æ„å»ºæ¥å£
*   æ— éœ€ç¼–å†™ CSS å³å¯åˆ›å»º UI å…ƒç´ çš„å¼•å¯¼ç¨‹åº
*   Web3.js å°†æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºè¿æ¥åˆ°åŒºå—é“¾

ç°åœ¨è®©æˆ‘ä»¬å°†ç½‘ç»œæµè§ˆå™¨è¿æ¥åˆ°åŒºå—é“¾ã€‚æˆ‘ä»¬å°†ä¸ºæ­¤ä½¿ç”¨å…ƒæ©ç ï¼Œå®ƒå®‰è£…åœ¨æœ¬æ•™ç¨‹çš„ä¾èµ–éƒ¨åˆ†ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦åšä¸¤ä»¶äº‹:

*   å°†å…ƒæ©ç è¿æ¥åˆ°æˆ‘ä»¬çš„ Ganache ä¸ªäººåŒºå—é“¾å®ä¾‹
*   å°†ä¸€äº›å¸æˆ·ä» Ganache å¯¼å…¥ Metamaskï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ä»£è¡¨ä»–ä»¬ä½œä¸ºæˆ‘ä»¬çš„å¸‚åœºåº”ç”¨ç¨‹åºçš„ç”¨æˆ·

ä½ å¯ä»¥åœ¨è§†é¢‘ä¸­çœ‹åˆ°æˆ‘åœ¨æ­¤æ—¶è®¾ç½®å…ƒæ©ç [ã€‚](https://www.youtube.com/watch?v=VH9Q2lf2mNo&feature=youtu.be&t=1h27m06s)

æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ç®€å•è§£é‡Šä¸€ä¸‹ä¸ºä»€ä¹ˆæˆ‘ä»¬ä½¿ç”¨ [React.js](https://reactjs.org/) æ¥æ„å»ºæˆ‘ä»¬çš„é¡¹ç›®ã€‚æˆ‘ä»¬éœ€è¦ä¸€ç§æ–¹æ³•æ¥ç®¡ç†åº”ç”¨ç¨‹åºçš„æ‰€æœ‰å®¢æˆ·ç«¯è¡Œä¸ºï¼Œå¹¶å­˜å‚¨æ¥è‡ªåŒºå—é“¾çš„æ•°æ®ã€‚React.js ä¸æ˜¯æ‰‹åŠ¨å®Œæˆæ‰€æœ‰è¿™äº›å·¥ä½œï¼Œè€Œæ˜¯é€šè¿‡å°†ä»£ç ç»„ç»‡æˆå¯é‡ç”¨çš„ç»„ä»¶ï¼Œå¹¶ä½¿ç”¨çŠ¶æ€å¯¹è±¡ç®¡ç†åº”ç”¨ç¨‹åºçŠ¶æ€ï¼Œä¸ºæˆ‘ä»¬æä¾›äº†å¼€ç®±å³ç”¨çš„èƒ½åŠ›ã€‚ä½ å¯ä»¥åœ¨è§†é¢‘ä¸­çœ‹åˆ°æˆ‘å¯¹ React.js [çš„å®Œæ•´è§£é‡Šã€‚](https://www.youtube.com/watch?v=VH9Q2lf2mNo&feature=youtu.be&t=1h30m17s)

ç°åœ¨ï¼Œè®©æˆ‘ä»¬å€ŸåŠ© a href = " https://web 3js . readthe docs . io/en/1.0/" target = " _ blank " > web 3 . jsï¼Œå°†å®¢æˆ·ç«¯åº”ç”¨ç¨‹åºè¿æ¥åˆ°åŒºå—é“¾ã€‚æˆ‘ä»¬é¦–å…ˆå°†`web3`å¯¼å…¥åˆ°ä¸»`App.js`ç»„ä»¶ä¸­ï¼Œå¦‚ä¸‹æ‰€ç¤º:

```js
import Web3 from 'web3'
```

ç°åœ¨è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œæ¯å½“æˆ‘ä»¬çš„ React ç»„ä»¶è¢«åŠ è½½æ—¶ï¼Œè¿™ä¸ªå‡½æ•°éƒ½ä¼šè¢«è°ƒç”¨ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å°†è°ƒç”¨ä¸€ä¸ªå®ä¾‹åŒ– web3 çš„å‡½æ•°ã€‚

```js
async componentWillMount() {
  await this.loadWeb3()
}
```

ç°åœ¨ï¼Œè®©æˆ‘ä»¬åˆ›å»º`loadWeb3()`å‡½æ•°ï¼Œå®ƒå°†åƒè¿™æ ·åˆ›å»ºè¿æ¥:

```js
async loadWeb3() {
  if (window.ethereum) {
    window.web3 = new Web3(window.ethereum)
    await window.ethereum.enable()
  }
  else if (window.web3) {
    window.web3 = new Web3(window.web3.currentProvider)
  }
  else {
    window.alert('Non-Ethereum browser detected. You should consider trying MetaMask!')
  }
}
```

è¯¥åŠŸèƒ½æ£€æµ‹ç½‘ç»œæµè§ˆå™¨ä¸­ä»¥å¤ªåŠæä¾›å•†çš„å­˜åœ¨ï¼Œå…è®¸æˆ‘ä»¬å°†åº”ç”¨ç¨‹åºè¿æ¥åˆ°åŒºå—é“¾ã€‚å¦‚æœæ‚¨ä¸ç†è§£è¿™ä¸ªå‡½æ•°å†…éƒ¨çš„æ‰€æœ‰å†…å®¹ï¼Œä¹Ÿä¸ç”¨æ‹…å¿ƒã€‚æ²¡å…³ç³»ï¼å®ƒç›´æ¥å–è‡ª[å…ƒæ©ç æä¾›ç»™](https://medium.com/metamask/https-medium-com-metamask-breaking-change-injecting-web3-7722797916a8)çš„æŒ‡ä»¤ã€‚:)

ç°åœ¨ï¼Œè®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªä»åŒºå—é“¾åŠ è½½æ•°æ®çš„å‡½æ•°ã€‚æˆ‘ä»¬å…ˆè¿™æ ·ç§°å‘¼å®ƒ:

```js
async componentWillMount() {
  await this.loadWeb3()
  await this.loadBlockchainData()
}
```

æˆ‘ä»¬å°†è¿™æ ·å®šä¹‰å®ƒ:

```js
async loadBlockchainData() {
  const web3 = window.web3
}
```

åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å°†å­˜å‚¨çš„ web3 è¿æ¥è¿æ¥åˆ°ä¸€ä¸ªå˜é‡ã€‚ç°åœ¨ï¼Œè®©æˆ‘ä»¬ä»å…ƒæ©ç ä¸­è·å–å¸æˆ·ï¼Œå¹¶å°†å®ƒä»¬è®°å½•åˆ°æ§åˆ¶å°ï¼Œå¦‚ä¸‹æ‰€ç¤º:

```js
async loadBlockchainData() {
  const web3 = window.web3
  const accounts = await web3.eth.getAccounts()
  console.log(accounts)
}
```

ç°åœ¨è½¬åˆ°æµè§ˆå™¨ï¼ŒæŸ¥çœ‹ç™»å½•åˆ°æ§åˆ¶å°çš„å¸æˆ·ï¼

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†æŠŠè¿™ä¸ªå¸æˆ·å­˜å‚¨åˆ° React çŠ¶æ€å¯¹è±¡ä¸­ï¼Œä»¥ä¾¿ä»¥åä½¿ç”¨:

```js
async loadBlockchainData() {
  const web3 = window.web3
  const accounts = await web3.eth.getAccounts()
  console.log(accounts)
  this.setState({ account: accounts[0] })
}
```

ç°åœ¨ï¼Œè®©æˆ‘ä»¬ä¸º state å¯¹è±¡è®¾ç½®ä¸€äº›é»˜è®¤å€¼ã€‚React è®©æˆ‘ä»¬è¿™æ ·åš:

```js
constructor(props) {
  super(props)
  this.state = {
    account: '',
    productCount: 0,
    products: [],
    loading: true
  }
}
```

ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨é¡µé¢çš„å¯¼èˆªæ ä¸­åˆ—å‡ºå¸æˆ·ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘å°†ç»§ç»­ä¸ºå¯¼èˆªæ åˆ›å»ºä¸€ä¸ªæ–°ç»„ä»¶ã€‚æˆ‘åœ¨è§†é¢‘çš„æœ€ååšè¿™ä¸ªï¼Œæ‰€ä»¥æœ‰ç‚¹ä¹±ã€‚ç„¶è€Œï¼Œæˆ‘è®¤ä¸ºè¿™æ˜¯åšè¿™ä»¶äº‹çš„æœ€ä½³æ—¶æœºã€‚

é¦–å…ˆï¼Œåœ¨ä¸`App.js`ç›¸åŒçš„ç›®å½•ä¸­åˆ›å»ºä¸€ä¸ªåä¸º`Navbar.js`çš„æ–°ç»„ä»¶ã€‚ç„¶ååœ¨è¯¥æ–‡ä»¶ä¸­ä½¿ç”¨ä»¥ä¸‹ä»£ç :

```js
import React, { Component } from 'react';

class Navbar extends Component {

  render() {
    return (
      <nav className="navbar navbar-dark fixed-top bg-dark flex-md-nowrap p-0 shadow">
        <a
          className="navbar-brand col-sm-3 col-md-2 mr-0"
          href="http://www.dappuniversity.com/bootcamp"
          target="_blank"
          rel="noopener noreferrer"
        >
          Dapp University's Blockchain Marketplace
        </a>
        <ul className="navbar-nav px-3">
          <li className="nav-item text-nowrap d-none d-sm-none d-sm-block">
            <small className="text-white"><span id="account">{this.props.account}</span></small>
          </li>
        </ul>
      </nav>
    );
  }
}
export default Navbar;
```

æ³¨æ„ï¼Œå®ƒç”¨`{this.props.account}`è¯»å–è´¦æˆ·ã€‚è¿™ä½¿ç”¨äº† React çš„ props å¯¹è±¡ï¼Œè¯¥å¯¹è±¡å¯ç”¨äºæ‰€æœ‰ React ç»„ä»¶ã€‚å½“æˆ‘ä»¬åœ¨`App.js`ä¸­æ¸²æŸ“è¿™ä¸ªç»„ä»¶æ—¶ï¼Œæˆ‘ä»¬éœ€è¦å°†è¿™äº›é“å…·ä¼ é€’ç»™å®ƒã€‚è®©æˆ‘ä»¬æ¥ä¸‹æ¥åšé‚£ä»¶äº‹ã€‚

ç°åœ¨å¯¼å…¥`App.js`é¡¶éƒ¨çš„å¯¼èˆªæ¡ç»„ä»¶:

```js
import Navbar from './Navbar'
```

ç°åœ¨è®©æˆ‘ä»¬æŠŠå®ƒå‘ˆç°åœ¨é¡µé¢ä¸Šã€‚é¦–å…ˆï¼Œåˆ é™¤æ‰€æœ‰æ—§çš„ Navbar ä»£ç ï¼Œå¹¶æ›¿æ¢ä¸º:

```js
<Navbar account={this.state.account} />
```

æ³¨æ„ï¼Œæˆ‘ä»¬ä» React çš„çŠ¶æ€å¯¹è±¡ä¸­è¯»å–å¸æˆ·ï¼Œç„¶åé€šè¿‡ props å°†å…¶ä¼ é€’ç»™ Navbar ç»„ä»¶ã€‚ç°åœ¨ï¼Œåœ¨ç½‘ç»œæµè§ˆå™¨ä¸­è®¿é—®æ‚¨çš„åº”ç”¨ç¨‹åºï¼ŒæŸ¥çœ‹é¡µé¢ä¸Šåˆ—å‡ºçš„å¸æˆ·ï¼

æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬å°†è¿æ¥æ·»åŠ åˆ°å¸‚åœºæ™ºèƒ½åˆçº¦ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬å°†åœ¨`App.js`çš„é¡¶éƒ¨å¯¼å…¥æ™ºèƒ½åˆçº¦ ABIï¼Œå¦‚ä¸‹æ‰€ç¤º:

```js
import Marketplace from '../abis/Marketplace.json'
```

ç°åœ¨ï¼Œè®©æˆ‘ä»¬æ›´æ–°`loadBlockchainData()`å‡½æ•°æ¥è¿æ¥æ™ºèƒ½åˆçº¦:

```js
async loadBlockchainData() {
  const web3 = window.web3
  // Load account
  const accounts = await web3.eth.getAccounts()
  this.setState({ account: accounts[0] })
  const networkId = await web3.eth.net.getId()
  const networkData = Marketplace.networks[networkId]
  if(networkData) {
    const marketplace = web3.eth.Contract(Marketplace.abi, networkData.address)
    console.log(marketplace)
  } else {
    window.alert('Marketplace contract not deployed to detected network.')
  }
}
```

è¿™æ®µä»£ç åšäº†å‡ ä»¶äº‹:

*   è¯»å– networkID ä»¥ç¡®å®šæˆ‘ä»¬ä½¿ç”¨ Metamask è¿æ¥åˆ°å“ªä¸ªç½‘ç»œï¼Œå³ Ganacheã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨è¿™ä¸ªç½‘ç»œ ID è¿æ¥åˆ°éƒ¨ç½²åˆ° Ganache ç½‘ç»œçš„æ™ºèƒ½åˆçº¦ï¼Œè€Œä¸æ˜¯ä¸»ä»¥å¤ªåŠç½‘ç»œã€‚
*   æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ç”¨`web3.eth.Contract()`å®ä¾‹åŒ– Web3.js çš„æ™ºèƒ½åˆçº¦ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦ä¸¤æ¡ä¿¡æ¯:æ™ºèƒ½åˆåŒ ABI å’Œåœ°å€ã€‚æˆ‘ä»¬ä»åˆšåˆšå¯¼å…¥çš„æ–‡ä»¶ä¸­è·å–è¿™ä¸¤è€…ã€‚
*   æœ€åï¼Œå¦‚æœæˆ‘ä»¬åœ¨ç½‘ç»œä¸Šæ‰¾ä¸åˆ°æ™ºèƒ½åˆçº¦ï¼Œæˆ‘ä»¬ä¼šæé†’ç”¨æˆ·ã€‚æ‚¨å¯ä»¥é€šè¿‡åˆ‡æ¢åˆ° Metamask ä¸­çš„ä¸»ä»¥å¤ªåŠç½‘ç»œæ¥æµ‹è¯•è¿™ä¸€ç‚¹(åªæ˜¯ä¸è¦å¿˜è®°åˆ‡æ¢å›æ¥)ã€‚

ç°åœ¨ï¼Œæ‚¨çš„æœ€ç»ˆç»„ä»¶åº”è¯¥å¦‚ä¸‹æ‰€ç¤º:

```js
import React, { Component } from 'react';
import Web3 from 'web3'
import logo from '../logo.png';
import './App.css';
import Marketplace from '../abis/Marketplace.json'
import Navbar from './Navbar'

class App extends Component {

  async componentWillMount() {
    await this.loadWeb3()
    await this.loadBlockchainData()
  }

  async loadWeb3() {
    if (window.ethereum) {
      window.web3 = new Web3(window.ethereum)
      await window.ethereum.enable()
    }
    else if (window.web3) {
      window.web3 = new Web3(window.web3.currentProvider)
    }
    else {
      window.alert('Non-Ethereum browser detected. You should consider trying MetaMask!')
    }
  }

  async loadBlockchainData() {
    const web3 = window.web3
    // Load account
    const accounts = await web3.eth.getAccounts()
    this.setState({ account: accounts[0] })
    const networkId = await web3.eth.net.getId()
    const networkData = Marketplace.networks[networkId]
    if(networkData) {
      const marketplace = web3.eth.Contract(Marketplace.abi, networkData.address)
      console.log(marketplace)
    } else {
      window.alert('Marketplace contract not deployed to detected network.')
    }
  }

  constructor(props) {
    super(props)
    this.state = {
      account: '',
      productCount: 0,
      products: [],
      loading: true
    }
  }

  render() {
    return (
      <div>
        <Navbar account={this.state.account} />
        <div className="container-fluid mt-5">
          <div className="row">
            <main role="main" className="col-lg-12 d-flex text-center">
              <div className="content mr-auto ml-auto">
                <a
                  href="http://www.dappuniversity.com/bootcamp"
                  target="_blank"
                  rel="noopener noreferrer"
                >
                  <img src={logo} className="App-logo" alt="logo" />
                </a>
                <h1>Dapp University Starter Kit</h1>
                <p>
                  Edit <code>src/components/App.js</code> and save to reload.
                </p>
                <a
                  className="App-link"
                  href="http://www.dappuniversity.com/bootcamp"
                  target="_blank"
                  rel="noopener noreferrer"
                >
                  LEARN BLOCKCHAIN <u><b>NOW! </b></u>
                </a>
              </div>
            </main>
          </div>
        </div>
      </div>
    );
  }
}

export default App;
```

å“‡ï¼åœ¨è¿™ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä»¬å¾ˆå¿«å°±è°ˆåˆ°äº†å¾ˆå¤šå†…å®¹ã€‚å¦‚æœä¿¡æ¯å¾ˆå¤šä¹Ÿä¸ç”¨æ‹…å¿ƒã€‚è¯·éšæ„[å†çœ‹ä¸€éè¿™éƒ¨åˆ†è§†é¢‘ï¼Œä»¥ä¾¿è¿›ä¸€æ­¥æ¾„æ¸…](https://www.youtube.com/watch?v=VH9Q2lf2mNo&feature=youtu.be&t=1h26m20s)ã€‚ä½ ä¹Ÿå¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°æ‰€æœ‰ä»£ç çš„[å‰¯æœ¬](https://github.com/dappuniversity/marketplace/releases/tag/part-4)ã€‚

## ç¬¬ 5 éƒ¨åˆ†:é”€å”®äº§å“(å‰ç«¯)

æœ¬æ•™ç¨‹è¿™ä¸€éƒ¨åˆ†çš„è§†é¢‘ç‰‡æ®µä» [01:53:10](https://www.youtube.com/watch?v=VH9Q2lf2mNo&feature=youtu.be&t=1h53m10s) å¼€å§‹ã€‚ä½ ä¹Ÿå¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°[çš„ä»£ç ](https://github.com/dappuniversity/marketplace/releases/tag/part-5)ã€‚

ç°åœ¨è®©æˆ‘ä»¬åˆ›å»ºä¸€ç§ä»æˆ‘ä»¬çš„å¸‚åœºç½‘ç«™é”€å”®äº§å“çš„æ–¹æ³•ã€‚æˆ‘ä»¬å°†å®Œæˆä»¥ä¸‹ä»»åŠ¡:

*   åˆ›å»ºä¸€ä¸ª react ç»„ä»¶æ¥ä¿å­˜æˆ‘ä»¬ä»£ç çš„æ¡†æ¶ï¼ŒåŒ…æ‹¬ä¸€ä¸ªå…è®¸ç”¨æˆ·åˆ—å‡ºæ–°äº§å“çš„è¡¨å•å’Œä¸€ä¸ªæ˜¾ç¤ºå¾…å”®äº§å“çš„è¡¨æ ¼ã€‚
*   æˆ‘ä»¬å°†è¿æ¥è¡¨å•ï¼Œä»¥ä¾¿ç”¨æˆ·å¯ä»¥åœ¨åŒºå—é“¾ä¸Šå®é™…åˆ—å‡ºä»–ä»¬çš„å¾…å”®äº§å“ã€‚

é¦–å…ˆï¼Œè®©æˆ‘ä»¬å‘æˆ‘ä»¬çš„`loadBlockchainData()`å‡½æ•°æ·»åŠ ä¸€äº›æ•°æ®ã€‚æˆ‘ä»¬ä¼šå¾—åˆ°`productCount`

```js
async loadBlockchainData() {
  const web3 = window.web3
  // Load account
  const accounts = await web3.eth.getAccounts()
  this.setState({ account: accounts[0] })
  const networkId = await web3.eth.net.getId()
  const networkData = Marketplace.networks[networkId]
  if(networkData) {
    const marketplace = web3.eth.Contract(Marketplace.abi, networkData.address)
    this.setState({ marketplace })
    const productCount = await marketplace.methods.productCount().call()
    console.log(productCount.toString())
    this.setState({ loading: false})
  } else {
    window.alert('Marketplace contract not deployed to detected network.')
  }
}
```

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªå‡½æ•°ï¼Œé€šè¿‡ç”¨ Web3.js è°ƒç”¨`createProduct()`å‡½æ•°å°†äº§å“æ·»åŠ åˆ°åŒºå—é“¾ï¼Œå¦‚ä¸‹æ‰€ç¤º:

```js
createProduct(name, price) {
this.setState({ loading: true })
this.state.marketplace.methods.createProduct(name, price).send({ from: this.state.account })
.once('receipt', (receipt) => {
  this.setState({ loading: false })
})
```

è®©æˆ‘è§£é‡Šä¸€ä¸‹è¿™æ®µä»£ç :

*   é¦–å…ˆï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ª JavaScript å‡½æ•°ï¼Œå®ƒæ¥å—ä¸æ™ºèƒ½å¥‘çº¦å‡½æ•°ç›¸åŒçš„å‚æ•°
*   ç„¶ååœ¨è°ƒç”¨æ™ºèƒ½åˆçº¦å‡½æ•°ä¹‹å‰ï¼Œæˆ‘ä»¬å‘Šè¯‰ React æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºæ­£åœ¨â€œåŠ è½½â€ï¼Œä»¥ä¾¿ç”¨æˆ·çŸ¥é“å‡½æ•°å·²æäº¤ã€‚
*   ç„¶åæˆ‘ä»¬ç”¨ Web3.js ç”¨`this.state.marketplace.methods.createProduct(name, price).send({ from: this.state.account })`è°ƒç”¨æ™ºèƒ½åˆçº¦å‡½æ•°ã€‚è¿™å°†è°ƒç”¨è¯¥å‡½æ•°ï¼Œå¹¶å‘Šè¯‰ Web3 å½“å‰å¸æˆ·æ˜¯è°ƒç”¨å®ƒçš„ç”¨æˆ·ã€‚
*   æœ€åï¼Œä¸€æ—¦æ”¶åˆ°äº¤æ˜“æ”¶æ®ï¼Œæˆ‘ä»¬å°†åº”ç”¨ç¨‹åºä»â€œåŠ è½½â€çŠ¶æ€ä¸­ç§»é™¤ï¼Œè¿™æ ·ç”¨æˆ·å°±çŸ¥é“å‡½æ•°è°ƒç”¨å®Œæˆäº†ã€‚

ä¸ºäº†ç”¨è¡¨å•è°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼Œæˆ‘ä»¬å¿…é¡»å°†å®ƒç»‘å®šåˆ°æ„é€ å‡½æ•°å†…éƒ¨çš„ç»„ä»¶ï¼Œå¦‚ä¸‹æ‰€ç¤º:

```js
constructor(props) {
  // ...
  this.createProduct = this.createProduct.bind(this)
}
```

ç°åœ¨æˆ‘ä»¬å¯ä»¥æŠŠå®ƒä¼ é€’ç»™å­ç»„ä»¶ã€‚ä½†é¦–å…ˆæˆ‘ä»¬å¿…é¡»åˆ›é€ å®ƒï¼è®©æˆ‘ä»¬åœ¨å½“å‰ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªåä¸º

```js
Main.js
```

with the following code:

```js
import React, { Component } from 'react';

class Main extends Component {

  render() {
    return (
      <div id="content">
        <h1>Add Product</h1>
        <form onSubmit={(event) => {
          event.preventDefault()
          const name = this.productName.value
          const price = window.web3.utils.toWei(this.productPrice.value.toString(), 'Ether')
          this.props.createProduct(name, price)
        }}>
          <div className="form-group mr-sm-2">
            <input
              id="productName"
              type="text"
              ref={(input) => { this.productName = input }}
              className="form-control"
              placeholder="Product Name"
              required />
          </div>
          <div className="form-group mr-sm-2">
            <input
              id="productPrice"
              type="text"
              ref={(input) => { this.productPrice = input }}
              className="form-control"
              placeholder="Product Price"
              required />
          </div>
          <button type="submit" className="btn btn-primary">Add Product</button>
        </form>
        <p>Â </p>
        <h2>Buy Product</h2>
        <table className="table">
          <thead>
            <tr>
              <th scope="col">#</th>
              <th scope="col">Name</th>
              <th scope="col">Price</th>
              <th scope="col">Owner</th>
              <th scope="col"></th>
            </tr>
          </thead>
          <tbody id="productList">
            <tr>
              <th scope="row">1</th>
              <td>iPhone x</td>
              <td>1 Eth</td>
              <td>0x39C7BC5496f4eaaa1fF75d88E079C22f0519E7b9</td>
              <td><button className="buyButton">Buy</button></td>
            </tr>
            <tr>
              <th scope="row">2</th>
              <td>Macbook Pro</td>
              <td>3 eth</td>
              <td>0x39C7BC5496f4eaaa1fF75d88E079C22f0519E7b9</td>
              <td><button className="buyButton">Buy</button></td>
            </tr>
            <tr>
              <th scope="row">3</th>
              <td>Airpods</td>
              <td>0.5 eth</td>
              <td>0x39C7BC5496f4eaaa1fF75d88E079C22f0519E7b9</td>
              <td><button className="buyButton">Buy</button></td>
            </tr>
          </tbody>
        </table>
      </div>
    );
  }
}

export default Main;
```

è¯¥ç»„ä»¶ä¸ºå¸‚åœº UI æ·»åŠ äº†æ‰€æœ‰çš„è„šæ‰‹æ¶ã€‚å®ƒè¿˜åˆ›å»ºäº†ä¸€ä¸ªè¡¨å•ï¼Œé€šè¿‡è°ƒç”¨`createProduct()`å‡½æ•°å°†äº§å“æ·»åŠ åˆ°åŒºå—é“¾ã€‚è¯·éšæ„åœ¨è§†é¢‘ä¸­æŸ¥çœ‹è¿™æ®µä»£ç çš„å®Œæ•´è§£é‡Šã€‚

ä½†æ˜¯è¿™ä¸ªç»„ä»¶ç°åœ¨è¿˜ä¸èƒ½å·¥ä½œï¼æˆ‘ä»¬éœ€è¦å…ˆåšå‡ ä»¶äº‹ã€‚è¿”å›åˆ°`App.js`ï¼Œåœ¨æ–‡ä»¶é¡¶éƒ¨å¯¼å…¥æ–°åˆ›å»ºçš„ç»„ä»¶ï¼Œå¦‚ä¸‹æ‰€ç¤º:

```js
import Main from './Main'
```

ç°åœ¨ç”¨ä¸‹é¢çš„ä»£ç æ›¿æ¢`<main>` HTML æ ‡ç­¾ä¸­çš„æ‰€æœ‰å†…å®¹:

```js
<main role="main" className="col-lg-12 d-flex">
  { this.state.loading
    ? <div id="loader" className="text-center"><p className="text-center">Loading...</p></div>
    : <Main createProduct={this.createProduct} />
  }
</main>
```

æ¯å½“åŠ è½½åº”ç”¨ç¨‹åºæ—¶ï¼Œè¿™å°†åœ¨é¡µé¢ä¸Šå‘ˆç°æ–°åˆ›å»ºçš„ç»„ä»¶ã€‚å¦‚æœæ˜¯åŠ è½½ï¼Œé‚£ä¹ˆå°±ä¼šæ˜¾ç¤ºåŠ è½½å™¨ï¼

ğŸ‰è€¶ï¼ç°åœ¨ï¼Œè¿›å…¥æ‚¨çš„æµè§ˆå™¨ï¼Œå°è¯•ä½¿ç”¨è¿™ç§æ–°å½¢å¼æ·»åŠ äº§å“ï¼

å“‡ï¼åœ¨è¿™ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä»¬å¾ˆå¿«å°±è°ˆåˆ°äº†å¾ˆå¤šå†…å®¹ã€‚å¦‚æœä¿¡æ¯å¾ˆå¤šä¹Ÿä¸ç”¨æ‹…å¿ƒã€‚è¯·éšæ„[å†çœ‹ä¸€éè¿™éƒ¨åˆ†è§†é¢‘ï¼Œä»¥ä¾¿è¿›ä¸€æ­¥æ¾„æ¸…](https://www.youtube.com/watch?v=VH9Q2lf2mNo&feature=youtu.be&t=1h53m10s)ã€‚ä½ ä¹Ÿå¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°æ‰€æœ‰ä»£ç çš„[å‰¯æœ¬](https://github.com/dappuniversity/marketplace/releases/tag/part-5)ã€‚

## ç¬¬ 6 éƒ¨åˆ†:è´­ä¹°äº§å“(å‰ç«¯)

æœ¬æ•™ç¨‹è¿™ä¸€éƒ¨åˆ†çš„è§†é¢‘ç‰‡æ®µä» [02:11:53](https://www.youtube.com/watch?v=VH9Q2lf2mNo&feature=youtu.be&t=2h11m53s) å¼€å§‹ã€‚ä½ ä¹Ÿå¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°[çš„ä»£ç ](https://github.com/dappuniversity/marketplace)ã€‚

ç°åœ¨è®©æˆ‘ä»¬é€šè¿‡å…è®¸ç”¨æˆ·åœ¨å¸‚åœºä¸­è´­ä¹°äº§å“æ¥ç»“æŸæˆ‘ä»¬çš„åº”ç”¨ç¨‹åºã€‚åœ¨è¿™ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä»¬å°†åšä¸¤ä»¶äº‹:

*   åœ¨é¡µé¢ä¸Šåˆ—å‡ºæ‰€æœ‰äº§å“
*   å…è®¸ç”¨æˆ·é€šè¿‡ç‚¹å‡»æŒ‰é’®æ¥è´­ä¹°å®ƒä»¬

é¦–å…ˆï¼Œè®©æˆ‘ä»¬åƒè¿™æ ·ä»`loadBlockchainData()`å‡½æ•°å†…çš„åŒºå—é“¾è·å–æ‰€æœ‰äº§å“:

```js
const productCount = await marketplace.methods.productCount().call()
    this.setState({ productCount })
    // Load products
    for (var i = 1; i <= productCount; i++) {
      const product = await marketplace.methods.products(i).call()
      this.setState({
        products: [...this.state.products, product]
      })
    } 
```

æˆ‘ä»¬ä½¿ç”¨åœ¨æ™ºèƒ½åˆçº¦ä¸­åˆ›å»ºçš„è®¡æ•°å™¨ç¼“å­˜æ¥ç¡®å®šå­˜åœ¨å¤šå°‘äº§å“ï¼Œç„¶åä½¿ç”¨ for å¾ªç¯æ¥å•ç‹¬è·å–æ¯ä¸ªäº§å“ï¼Œå¹¶å°†å…¶å­˜å‚¨åˆ° react çŠ¶æ€å¯¹è±¡ä¸­ã€‚æœ‰äº†è¿™äº›ä¿¡æ¯ï¼Œæˆ‘ä»¬å¯ä»¥ç«‹å³åœ¨é¡µé¢ä¸Šå‘ˆç°äº§å“ã€‚

ç°åœ¨ï¼Œè®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªè´­ä¹°äº§å“çš„å‡½æ•°:

```js
purchaseProduct(id, price) {
  this.setState({ loading: true })
  this.state.marketplace.methods.purchaseProduct(id).send({ from: this.state.account, value: price })
  .once('receipt', (receipt) => {
    this.setState({ loading: false })
  })
}
```

ç°åœ¨è®©æˆ‘ä»¬å°†å‡½æ•°ç»‘å®šåˆ°æ„é€ å‡½æ•°ä¸­:

```js
constructor(props) {
  // ...
  this.createProduct = this.createProduct.bind(this)
  this.purchaseProduct = this.purchaseProduct.bind(this)
}
```

ç°åœ¨æˆ‘ä»¬å°†æŠŠä¸¤ä¸ªæ–°é“å…·ä¼ ç»™`Main component:`

*   é¡µé¢ä¸Šå¯ä»¥åˆ—å‡ºçš„æ‰€æœ‰äº§å“
*   `purchaseProdct()`å‡½æ•°ï¼Œè¿™æ ·å®ƒå¯ä»¥åœ¨å­ç»„ä»¶ä¸­è¢«è°ƒç”¨

æˆ‘ä»¬å°†æ›´æ–°ä»£ç ï¼Œä½¿å…¶çœ‹èµ·æ¥åƒè¿™æ ·:

```js
<main role="main" className="col-lg-12 d-flex">
  { this.state.loading
    ? <div id="loader" className="text-center"><p className="text-center">Loading...</p></div>
    : <Main
      products={this.state.products}
      createProduct={this.createProduct}
      purchaseProduct={this.purchaseProduct} />
  }
</main>
```

å‰å®³ï¼ç°åœ¨è®©æˆ‘ä»¬æ›´æ–°`Main.js`æ–‡ä»¶ä¸­çš„ä»£ç ï¼Œåˆ—å‡ºæ‰€æœ‰äº§å“ï¼Œå¹¶å…è®¸ç”¨æˆ·è´­ä¹°ã€‚ç”¨ä»¥ä¸‹ä»£ç æ›¿æ¢`<tbody>`æ ‡ç­¾ä¸­çš„æ‰€æœ‰ä»£ç :

```js
{ this.props.products.map((product, key) => {
  return(
    <tr key={key}>
      <th scope="row">{product.id.toString()}</th>
      <td>{product.name}</td>
      <td>{window.web3.utils.fromWei(product.price.toString(), 'Ether')} Eth</td>
      <td>{product.owner}</td>
      <td>
        { !product.purchased
          ? <button
              name={product.id}
              value={product.price}
              onClick={(event) => {
                this.props.purchaseProduct(event.target.name, event.target.value)
              }}
            >
              Buy
            </button>
          : null
        }
        </td>
    </tr>
  )
})}
```

è¿™æ®µä»£ç åšäº†å‡ ä»¶äº‹:

*   éå†æ‰€æœ‰äº§å“ï¼Œå¹¶ä¸ºæ¯ä¸ªäº§å“åˆ›å»ºå”¯ä¸€çš„è¡¨è¡Œ
*   æ·»åŠ ä¸€ä¸ªæŒ‰é’®ï¼Œè¿™æ ·åªéœ€å•å‡»ä¸€ä¸‹å°±å¯ä»¥è´­ä¹°äº§å“ï¼Œè°ƒç”¨æˆ‘ä»¬åˆšåˆšåˆ›å»ºçš„`purchaseProduct()`å‡½æ•°ã€‚

å‰å®³ï¼ç°åœ¨è½¬åˆ°æ‚¨çš„æµè§ˆå™¨å¹¶å°è¯•è´­ä¹°äº§å“ï¼

FWEWï¼åœ¨è¿™ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä»¬ç¡®å®å¾ˆå¿«åœ°ä»‹ç»äº†å¾ˆå¤šä¿¡æ¯...å¦‚æœä½ ç¬¬ä¸€æ¬¡æ²¡æœ‰å®Œå…¨ç†è§£ï¼Œä¹Ÿä¸è¦æ‹…å¿ƒã€‚è¯·éšæ„[å†çœ‹ä¸€éè¿™éƒ¨åˆ†è§†é¢‘ï¼Œä»¥ä¾¿è¿›ä¸€æ­¥æ¾„æ¸…](https://www.youtube.com/watch?v=VH9Q2lf2mNo&feature=youtu.be&t=2h11m53s)ã€‚ä½ ä¹Ÿå¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°æ‰€æœ‰ä»£ç çš„[å‰¯æœ¬](https://github.com/dappuniversity/marketplace)ã€‚

## ç¬¬ 7 éƒ¨åˆ†:éƒ¨ç½²é¡¹ç›®

è¿™éƒ¨åˆ†æ•™ç¨‹çš„è§†é¢‘ç‰‡æ®µä» [02:27:44](https://www.youtube.com/watch?v=VH9Q2lf2mNo&feature=youtu.be&t=2h27m44s) å¼€å§‹ã€‚ä½ ä¹Ÿå¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°[çš„ä»£ç ](https://github.com/dappuniversity/marketplace)ã€‚

ç°åœ¨è®©æˆ‘ä»¬å°†æˆ‘ä»¬çš„é¡¹ç›®éƒ¨ç½²åˆ°ä¸€ä¸ªçœŸå®çš„åŒºå—é“¾ã€‚å¦‚æœæ‚¨èƒ½åœ¨è§†é¢‘ä¸­è·Ÿéšæˆ‘ï¼Œè€Œä¸æ˜¯å†™å‡ºè¿™ä¸€éƒ¨åˆ†çš„æ¯ä¸ªæ­¥éª¤ï¼Œæ•ˆæœä¼šæ›´å¥½ã€‚æˆ‘ä¸“é—¨ä¸ºè¿™æ¬¡éƒ¨ç½²æ·»åŠ äº†ä¸€ä¸ªå•ç‹¬çš„è§†é¢‘**ï¼Œæ‚¨å¯ä»¥åœ¨è¿™é‡Œè§‚çœ‹:**

[https://www.youtube.com/embed/TMnjVgZO7B4](https://www.youtube.com/embed/TMnjVgZO7B4)

ä¸‡å²ï¼ğŸ‰æ‚¨å·²ç»æ„å»ºäº†ä¸€ä¸ªå…¨æ ˆåŒºå—é“¾åº”ç”¨ç¨‹åºï¼æ­å–œä½ ï¼Œä½ å·²ç»åœ¨æœ¬æ•™ç¨‹ä¸­èµ°äº†è¿™ä¹ˆè¿œã€‚

å¯¹è¿™ä¸ªæ•™ç¨‹æ»¡æ„å—ï¼Ÿç„¶åä½ **éœ€è¦**åˆ°[åœ¨è¿™é‡Œå‚åŠ æˆ‘çš„å…è´¹åŸ¹è®­](/bootcamp)ï¼Œæˆ‘å°†å‘ä½ å±•ç¤ºå¦‚ä½•æ„å»ºä¸€ä¸ªçœŸå®ä¸–ç•Œçš„åŒºå—é“¾åº”ç”¨ç¨‹åºï¼Œè¿™æ ·ä½ å°±å¯ä»¥æˆä¸ºä¸€åé«˜è–ªçš„åŒºå—é“¾å¼€å‘è€…ï¼

*
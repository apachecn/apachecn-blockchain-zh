# å¦‚ä½•æ­å»ºåŒºå—é“¾ App -ä»¥å¤ªåŠå¾…åŠäº‹é¡¹ 2019

> åŸæ–‡ï¼š<https://www.dappuniversity.com/articles/blockchain-app-tutorial>

ä½œè€…æ ¼é›·æˆˆé‡ŒÂ·éº¦å¡å®¾2022 å¹´ 12 æœˆ 1 æ—¥

å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯æ¥è‡ª [Dapp å¤§å­¦çš„](https://www.youtube.com/c/DappUniversity)[Gregory](https://www.twitter.com/DappUniversity)ï¼

ä»Šå¤©æˆ‘å°†å‘æ‚¨å±•ç¤ºå¦‚ä½•æ„å»ºæ‚¨çš„ç¬¬ä¸€ä¸ªåŒºå—é“¾åº”ç”¨ç¨‹åºï¼è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªç”±ä»¥å¤ªåŠæ™ºèƒ½åˆçº¦æ”¯æŒçš„å¾…åŠäº‹é¡¹åˆ—è¡¨ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ Solidity ç¼–ç¨‹è¯­è¨€åˆ›å»ºä¸€ä¸ªæ™ºèƒ½å¥‘çº¦ã€‚ç„¶åï¼Œæˆ‘ä»¬å°†é’ˆå¯¹æ™ºèƒ½åˆçº¦ç¼–å†™æµ‹è¯•ï¼Œå¹¶å°†å…¶éƒ¨ç½²åˆ°åŒºå—é“¾ã€‚æœ€åï¼Œæˆ‘ä»¬å°†ä¸º todo åˆ—è¡¨åˆ›å»ºä¸€ä¸ªå®¢æˆ·ç«¯åº”ç”¨ç¨‹åºã€‚

[https://www.youtube.com/embed/rzvk2kdjr2I](https://www.youtube.com/embed/rzvk2kdjr2I)

[*JOIN MY FREE TRAINING!*](/bootcamp) *

ä½ å¯ä»¥åœ¨ä¸Šé¢ 90 åˆ†é’Ÿçš„è§†é¢‘ä¸­çœ‹åˆ°æˆ‘æ„å»ºå®Œæ•´çš„åŒºå—é“¾åº”ç”¨ç¨‹åºã€‚åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘è¿˜å°†é€æ­¥æŒ‡å¯¼æ‚¨ã€‚åœ¨æˆ‘ä»¬å¼€å§‹æ„å»º dApp ä¹‹å‰ï¼Œè®©æˆ‘å…ˆè§£é‡Šä¸€ä¸‹åŒºå—é“¾åº”ç”¨ç¨‹åºæ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚å¦‚æœä½ æ¸´æœ›å¼€å§‹ç¼–ç¨‹ï¼Œä½ å¯ä»¥[è·³åˆ°æ•™ç¨‹](#dependencies)çš„ä¸‹ä¸€éƒ¨åˆ†ã€‚ğŸ˜€

## ç›®å½•

*   ä»‹ç»

*   [åŒºå—é“¾åº”ç”¨æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ](#how)
*   [å®‰è£…ä¾èµ–å…³ç³»](#dependencies)

*   æ•™ç¨‹æ­¥éª¤

1.  [é¡¹ç›®è®¾ç½®](#projectSetup)
2.  [åˆ—å‡ºä»»åŠ¡](#listTasks)
3.  [åˆ›å»ºä»»åŠ¡](#createTasks)
4.  [å®Œæˆä»»åŠ¡](#completeTasks)

### åŒºå—é“¾åº”ç”¨æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ

æˆ‘ä¸ºæœ¬æ•™ç¨‹é€‰æ‹©äº†ä¸€ä¸ª todo list åº”ç”¨ç¨‹åºï¼Œå› ä¸ºå®ƒæ˜¯å­¦ä¹ ä»»ä½•æ–°ç¼–ç¨‹è¯­è¨€çš„æœ€å¸¸è§æ–¹æ³•ä¹‹ä¸€ã€‚å®ƒå°†æ•™ä¼šæˆ‘ä»¬å¦‚ä½•ä»åŒºå—é“¾ä¸­è¯»å–å’Œå†™å…¥æ•°æ®ï¼Œä»¥åŠæ‰§è¡Œæ§åˆ¶æˆ‘ä»¬çš„å¾…åŠäº‹é¡¹åˆ—è¡¨åº”ç”¨ç¨‹åºè¡Œä¸ºçš„ä¸šåŠ¡é€»è¾‘ã€‚å®ƒå°†æ•™ä½ å…³äºåŒºå—é“¾å¦‚ä½•å·¥ä½œä»¥åŠå¦‚ä½•å†™ä»¥å¤ªåŠæ™ºèƒ½åˆçº¦çš„åŸºç¡€çŸ¥è¯†ã€‚

ä¸ºäº†ç†è§£åŒºå—é“¾åº”ç”¨ç¨‹åºæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œè®©æˆ‘ä»¬é¦–å…ˆæ¥çœ‹çœ‹å¾…åŠäº‹é¡¹åˆ—è¡¨ä½œä¸º web åº”ç”¨ç¨‹åºæ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚è¦è®¿é—®å¾…åŠäº‹é¡¹åˆ—è¡¨ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨é€šè¿‡äº’è”ç½‘ä¸ web æœåŠ¡å™¨é€šä¿¡çš„ web æµè§ˆå™¨ã€‚æœåŠ¡å™¨åŒ…å«å¾…åŠäº‹é¡¹åˆ—è¡¨çš„æ‰€æœ‰ä»£ç å’Œæ•°æ®ã€‚

![Web Application Diagram](img/0ea8db5d24af597dff6727c4ae24afa8.png)

ä»¥ä¸‹æ˜¯æ‚¨å¯ä»¥åœ¨æœåŠ¡å™¨ä¸Šæ‰¾åˆ°çš„å†…å®¹åˆ—è¡¨:

*   HTMLã€CSS å’Œ JavaScript æ ¼å¼çš„å®¢æˆ·ç«¯æ–‡ä»¶
*   è´Ÿè´£åº”ç”¨ç¨‹åºä¸šåŠ¡é€»è¾‘çš„åç«¯ä»£ç 
*   å­˜å‚¨å¾…åŠäº‹é¡¹åˆ—è¡¨ä¸­çš„ä»»åŠ¡çš„æ•°æ®åº“

è¯¥æœåŠ¡å™¨æ˜¯ä¸€ä¸ªé›†ä¸­çš„å®ä½“ï¼Œå®Œå…¨æ§åˆ¶åº”ç”¨ç¨‹åºçš„å„ä¸ªæ–¹é¢ã€‚å¯¹æœåŠ¡å™¨æ‹¥æœ‰å®Œå…¨è®¿é—®æƒé™çš„ä»»ä½•äººéƒ½å¯ä»¥éšæ—¶æ›´æ”¹ä»£ç æˆ–æ•°æ®çš„ä»»ä½•éƒ¨åˆ†ã€‚åŒºå—é“¾åº”ç”¨ç¨‹åºçš„å·¥ä½œæ–¹å¼å®Œå…¨ä¸åŒã€‚å¾…åŠäº‹é¡¹åˆ—è¡¨ä¸­çš„æ‰€æœ‰ä»£ç å’Œæ•°æ®éƒ½ä¸åœ¨ä¸­å¤®æœåŠ¡å™¨ä¸Šã€‚ç›¸åï¼Œå®ƒåˆ†å¸ƒåœ¨æ•´ä¸ªåŒºå—é“¾ã€‚æ‰€æœ‰çš„ä»£ç å’Œæ•°æ®éƒ½æ˜¯å…±äº«çš„ï¼Œåœ¨åŒºå—é“¾ä¸Šæ˜¯ä¸å¯æ›´æ”¹çš„ã€‚

ä¸ºäº†è¯´æ˜è¿™ä¸€ç‚¹ï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹åŸºäºåŒºå—é“¾çš„å¾…åŠäº‹é¡¹åˆ—è¡¨æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚

![Blockchain Application Diagram](img/727876e073b6531e27c3161cfa5fce52.png)

ä¸ºäº†è®¿é—®åŒºå—é“¾çš„å¾…åŠäº‹é¡¹åˆ—è¡¨ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ web æµè§ˆå™¨ä¸å®¢æˆ·ç«¯åº”ç”¨ç¨‹åºè¿›è¡Œå¯¹è¯ï¼Œè¯¥åº”ç”¨ç¨‹åºå°†ä½¿ç”¨ HTMLã€CSS å’Œ JavaScript ç¼–å†™ã€‚å®¢æˆ·ç«¯åº”ç”¨ç¨‹åºå°†ç›´æ¥ä¸åŒºå—é“¾å¯¹è¯ï¼Œè€Œä¸æ˜¯ä¸åç«¯ web æœåŠ¡å™¨å¯¹è¯ã€‚

##### ä»€ä¹ˆæ˜¯åŒºå—é“¾ï¼Ÿ

åŒºå—é“¾æ˜¯è®¡ç®—æœºæˆ–èŠ‚ç‚¹çš„å¯¹ç­‰ç½‘ç»œï¼Œå®ƒä»¬å¯ä»¥ç›¸äº’é€šä¿¡ã€‚è¿™æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼ç½‘ç»œï¼Œæ‰€æœ‰å‚ä¸è€…å…±åŒæ‰¿æ‹…è¿è¡Œç½‘ç»œçš„è´£ä»»ã€‚æ¯ä¸ªç½‘ç»œå‚ä¸è€…éƒ½åœ¨åŒºå—é“¾ä¸Šä¿ç•™ä¸€ä»½ä»£ç å’Œæ•°æ®çš„å‰¯æœ¬ã€‚æ‰€æœ‰è¿™äº›æ•°æ®éƒ½åŒ…å«åœ¨ç§°ä¸ºâ€œå—â€çš„è®°å½•åŒ…ä¸­ï¼Œè¿™äº›è®°å½•â€œé“¾æ¥â€åœ¨ä¸€èµ·æ„æˆäº†åŒºå—é“¾ã€‚ç½‘ç»œä¸Šçš„æ‰€æœ‰èŠ‚ç‚¹éƒ½ç¡®ä¿è¿™äº›æ•°æ®æ˜¯å®‰å…¨ä¸”ä¸å¯æ›´æ”¹çš„ï¼Œè¿™ä¸ä»£ç å’Œæ•°æ®å¯ä»¥éšæ—¶æ›´æ”¹çš„é›†ä¸­å¼åº”ç”¨ç¨‹åºä¸åŒã€‚è¿™å°±æ˜¯åŒºå—é“¾å¦‚æ­¤å¼ºå¤§çš„åŸå› ï¼å› ä¸ºåŒºå—é“¾è´Ÿè´£å­˜å‚¨æ•°æ®ï¼Œæ‰€ä»¥å®ƒä»æ ¹æœ¬ä¸Šæ¥è¯´æ˜¯ä¸€ä¸ªæ•°æ®åº“ã€‚å› ä¸ºè¿™æ˜¯ä¸€ä¸ªç›¸äº’äº¤æµçš„è®¡ç®—æœºç½‘ç»œï¼Œæ‰€ä»¥è¿™æ˜¯ä¸€ä¸ªç½‘ç»œã€‚ä½ å¯ä»¥æŠŠå®ƒæƒ³è±¡æˆä¸€ä¸ªé›†ç½‘ç»œå’Œæ•°æ®åº“äºä¸€ä½“çš„ç³»ç»Ÿã€‚

æˆ‘è¿˜åº”è¯¥å¼ºè°ƒä¼ ç»Ÿ web åº”ç”¨ç¨‹åºå’ŒåŒºå—é“¾åº”ç”¨ç¨‹åºä¹‹é—´çš„å¦ä¸€ä¸ªåŸºæœ¬åŒºåˆ«:ä½ ä¸æ˜¯åº”ç”¨ç¨‹åºæœ¬èº«çš„ç”¨æˆ·ï¼Œè€Œæ˜¯ blockhain ç½‘ç»œçš„ç”¨æˆ·ã€‚è¯¥åº”ç”¨ç¨‹åºä¸ç®¡ç†ä»»ä½•ç”¨æˆ·æ•°æ®ã€‚é‚£æ˜¯åŒºå—é“¾çš„è´£ä»»ï¼

##### ä»€ä¹ˆæ˜¯æ™ºèƒ½åˆåŒ

åŒºå—é“¾ä¸Šçš„æ‰€æœ‰ä»£ç éƒ½åŒ…å«åœ¨æ™ºèƒ½åˆçº¦ä¸­ï¼Œæ™ºèƒ½åˆçº¦æ˜¯åœ¨åŒºå—é“¾ä¸Šè¿è¡Œçš„ç¨‹åºã€‚å®ƒä»¬æ˜¯åŒºå—é“¾åº”ç”¨ç¨‹åºçš„æ„é€ å—ã€‚åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†ç¼–å†™ä¸€ä¸ªæ™ºèƒ½å¥‘çº¦æ¥å¢å¼ºæˆ‘ä»¬çš„å¾…åŠäº‹é¡¹åˆ—è¡¨ã€‚å®ƒå°†è´Ÿè´£ä»åŒºå—é“¾è·å–æˆ‘ä»¬çš„å¾…åŠäº‹é¡¹åˆ—è¡¨ä¸­çš„æ‰€æœ‰ä»»åŠ¡ï¼Œæ·»åŠ æ–°ä»»åŠ¡ï¼Œä»¥åŠå®Œæˆä»»åŠ¡ã€‚

æ™ºèƒ½åˆçº¦æ˜¯ç”¨ä¸€ç§å«åš Solidity çš„ç¼–ç¨‹è¯­è¨€ç¼–å†™çš„ï¼Œè¿™ç§è¯­è¨€çœ‹èµ·æ¥å¾ˆåƒ JavaScriptã€‚æ™ºèƒ½åˆçº¦ä¸­çš„æ‰€æœ‰ä»£ç éƒ½æ˜¯ä¸å¯å˜çš„ã€‚ä¸€æ—¦æˆ‘ä»¬å°†æ™ºèƒ½åˆçº¦éƒ¨ç½²åˆ°åŒºå—é“¾ï¼Œæˆ‘ä»¬å°†æ— æ³•æ›´æ”¹æˆ–æ›´æ–°ä»»ä½•ä»£ç ã€‚è¿™æ˜¯ä¸€ä¸ªç¡®ä¿ä»£ç ä¸å¯ä¿¡ä¸”å®‰å…¨çš„è®¾è®¡ç‰¹æ€§ã€‚æˆ‘ç»å¸¸æŠŠæ™ºèƒ½åˆçº¦æ¯”ä½œ web ä¸Šçš„å¾®æœåŠ¡ã€‚å®ƒä»¬å……å½“ä»åŒºå—é“¾è¯»å–å’Œå†™å…¥æ•°æ®çš„æ¥å£ï¼Œå¹¶æ‰§è¡Œä¸šåŠ¡é€»è¾‘ã€‚å®ƒä»¬æ˜¯å…¬å¼€å¯è®¿é—®çš„ï¼Œè¿™æ„å‘³ç€ä»»ä½•è®¿é—® blockchian çš„äººéƒ½å¯ä»¥è®¿é—®å®ƒä»¬çš„æ¥å£ã€‚

##### åŒºå—é“¾å¾…åŠäº‹é¡¹åˆ—è¡¨å¦‚ä½•å·¥ä½œ

è®©æˆ‘ä»¬å›é¡¾ä¸€ä¸‹ï¼Œä»¥ç†è§£æˆ‘ä»¬å°†åœ¨æœ¬æ•™ç¨‹ä¸­æ„å»ºçš„åº”ç”¨ç¨‹åºæ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚æˆ‘ä»¬å°†ä¸ºå¾…åŠäº‹é¡¹åˆ—è¡¨åˆ›å»ºä¸€ä¸ªå®¢æˆ·ç«¯åº”ç”¨ç¨‹åºï¼Œå®ƒå°†ç›´æ¥ä¸åŒºå—é“¾å¯¹è¯ã€‚åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ä»¥å¤ªåŠåŒºå—é“¾ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å°†å®¢æˆ·ç«¯åº”ç”¨ç¨‹åºè¿æ¥åˆ°å•ä¸ªä»¥å¤ªåŠèŠ‚ç‚¹æ¥è®¿é—®å®ƒã€‚æˆ‘ä»¬å°†åœ¨ Solidity ä¸­ç¼–å†™ä¸€ä¸ªæ™ºèƒ½å¥‘çº¦æ¥ä¸ºå¾…åŠäº‹é¡¹åˆ—è¡¨æä¾›åŠŸèƒ½ï¼Œå¹¶å°†å®ƒéƒ¨ç½²åˆ°ä»¥å¤ªåŠåŒºå—é“¾ã€‚æˆ‘ä»¬è¿˜å°†ä½¿ç”¨ä»¥å¤ªåŠé’±åŒ…é€šè¿‡æˆ‘ä»¬çš„ä¸ªäººå¸æˆ·è¿æ¥åˆ°åŒºå—é“¾ç½‘ç»œï¼Œä»¥ä¾¿ä¸å¾…åŠäº‹é¡¹åº”ç”¨ç¨‹åºè¿›è¡Œäº¤äº’ã€‚

##### åº”ç”¨ç¨‹åºé¢„è§ˆ

è¿™æ˜¯æˆ‘ä»¬å°†åœ¨æœ¬æ•™ç¨‹ä¸­æ„å»ºçš„ todo list åº”ç”¨ç¨‹åºçš„é¢„è§ˆã€‚æˆ‘ä»¬å°†èƒ½å¤Ÿåœ¨å¾…åŠäº‹é¡¹åˆ—è¡¨ä¸­åˆ—å‡ºæ‰€æœ‰çš„ä»»åŠ¡ï¼Œåˆ›å»ºæ–°çš„ä»»åŠ¡ï¼Œå¹¶å®Œæˆå®ƒä»¬ã€‚

![Ethereum Todo List Application](img/506637af0713cf94b3888b6c3844c8a1.png)

### å®‰è£…ä¾èµ–é¡¹

ç°åœ¨è®©æˆ‘ä»¬å®‰è£…æ„å»ºé¡¹ç›®æ‰€éœ€çš„æ‰€æœ‰ä¾èµ–é¡¹ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬å°†å»ºç«‹ä¸€ä¸ªåŒºå—é“¾äººæ¥æœ¬åœ°å¼€å‘åº”ç”¨ç¨‹åºã€‚

##### Ganache ä¸ªäººåŒºå—é“¾

è¿™ç§ä¾èµ–æ€§æ˜¯ä¸€ç§ä¸ªäººåŒºå—é“¾ï¼Œæ˜¯ä¸€ç§æœ¬åœ°å¼€å‘åŒºå—é“¾ï¼Œå¯ç”¨äºæ¨¡ä»¿å…¬å…±åŒºå—é“¾çš„è¡Œä¸ºã€‚æˆ‘æ¨èä½¿ç”¨ [Ganache](http://truffleframework.com/ganache) ä½œä¸ºä½ ä»¥å¤ªåŠå¼€å‘çš„ä¸ªäººåŒºå—é“¾ã€‚å®ƒå°†å…è®¸æ‚¨éƒ¨ç½²æ™ºèƒ½åˆçº¦ã€å¼€å‘åº”ç”¨ç¨‹åºå’Œè¿è¡Œæµ‹è¯•ã€‚å®ƒå¯ä»¥ä½œä¸ºæ¡Œé¢åº”ç”¨ç¨‹åºå’Œå‘½ä»¤è¡Œå·¥å…·åœ¨ Windowsã€Mac å’Œ Linux ä¸Šä½¿ç”¨ï¼

![Ganache Personal Blockchain Application](img/ec8c8648c5fa5be4e5b4dbc42f7a411c.png)

åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘å°†æŒ‡å¯¼æ‚¨è®¾ç½®æ¡Œé¢åº”ç”¨ç¨‹åºã€‚ä½ å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°ä½ çš„æ“ä½œç³»ç»Ÿçš„æœ€æ–°ç‰ˆæœ¬ã€‚ä¸€æ—¦ä¸‹è½½äº†å­˜æ¡£çš„åŒ…ï¼Œè§£å‹å®‰è£…ç¨‹åºå¹¶è¿è¡Œå®‰è£…æ­¥éª¤ã€‚å®‰è£…å®Œæˆåï¼Œæ— è®ºä½•æ—¶æ‰“å¼€å®ƒï¼Œæ‚¨éƒ½ä¼šçœ‹åˆ°ä»¥ä¸‹å±å¹•:

![Ganache Personal Blockchain Application](img/406a84d52dfbafa5804518762028a0dd.png)

è€¶ï¼ğŸ‰ç°åœ¨ä½ æœ‰ä¸€ä¸ªä¸ªäººåŒºå—é“¾ç½‘ç»œè¿è¡Œï¼æ‚¨å¯ä»¥çœ‹åˆ°è¿è¡Œ Ganache çš„æœåŠ¡å™¨çš„ä¸€äº›è¯¦ç»†ä¿¡æ¯ï¼Œä»¥åŠè¿æ¥åˆ°ç½‘ç»œçš„å¸æˆ·åˆ—è¡¨ã€‚æ¯ä¸ªè´¦æˆ·éƒ½è¢«è®°å…¥ 100 è‹±é•‘ã€‚è¿™æ˜¯ä¸€ä¸ªå·¨å¤§çš„æ—¶é—´èŠ‚çœï¼å¦‚æœä½ æ‰“ç®—ä»å¤´å¼€å§‹åˆ›å»ºä½ è‡ªå·±çš„ä¸ªäººåŒºå—é“¾ç½‘ç»œï¼Œæˆ–è€…åœ¨ä¸€ä¸ªæµ‹è¯•ç½‘ç»œä¸Šå¼€å‘ä½ çš„åº”ç”¨ç¨‹åºï¼Œä½ å°†ä¸å¾—ä¸æ‰‹åŠ¨åˆ›å»ºæ‰€æœ‰ 10 ä¸ªå¸æˆ·ï¼Œå¹¶å‘æ¯ä¸ªå¸æˆ·å­˜å…¥ä¹™é†šã€‚è°¢å¤©è°¢åœ°ï¼ŒGanache å·²ç»ä¸ºæˆ‘ä»¬åšäº†è¿™ä»¶äº‹ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸å¿…æ‹…å¿ƒå®ƒã€‚

##### èŠ‚ç‚¹ã€‚å°„æµç ”ç©¶â€¦

æ—¢ç„¶æ‚¨å·²ç»è¿è¡Œäº†ç§æœ‰åŒºå—é“¾ï¼Œé‚£ä¹ˆæ‚¨éœ€è¦é…ç½®æ‚¨çš„ç¯å¢ƒæ¥å¼€å‘æ™ºèƒ½åˆçº¦ã€‚æ‚¨éœ€è¦çš„ç¬¬ä¸€ä¸ªä¾èµ–é¡¹æ˜¯ Node.js é™„å¸¦çš„[èŠ‚ç‚¹åŒ…ç®¡ç†å™¨](https://nodejs.org/en/)æˆ– NPMã€‚æ‚¨å¯ä»¥æŸ¥çœ‹æ˜¯å¦å·²ç»å®‰è£…äº† Nodeï¼Œæ–¹æ³•æ˜¯åœ¨ç»ˆç«¯ä¸Šé”®å…¥:

```js
$ node -v
```

å¦‚æœä½ è¿˜æ²¡æœ‰å®‰è£… nodeï¼Œä½ å¯ä»¥è®¿é—® [Node.js ç½‘ç«™](https://nodejs.org/en/)ä¸‹è½½ã€‚

##### å—èŒæ¡†æ¶

ç°åœ¨è®©æˆ‘ä»¬å®‰è£… [Truffle æ¡†æ¶](http://truffleframework.com/)ï¼Œå®ƒæä¾›äº†ä¸€å¥—ç”¨ Solidity ç¼–ç¨‹è¯­è¨€å¼€å‘ä»¥å¤ªåŠæ™ºèƒ½è”ç³»äººçš„å·¥å…·ã€‚

![Truffle Blockchain Smart Contract Development Framework](img/5bf384e0f0348826d8cb278471a06260.png)

ä»¥ä¸‹æ˜¯æˆ‘ä»¬å°†ä» Truffle æ¡†æ¶ä¸­è·å¾—çš„æ‰€æœ‰åŠŸèƒ½çš„æ¦‚è¿°:

*   æ™ºèƒ½åˆåŒç®¡ç† -ç”¨ Solidity ç¼–ç¨‹è¯­è¨€ç¼–å†™æ™ºèƒ½åˆåŒï¼Œå¹¶å°†å®ƒä»¬ç¼–è¯‘æˆè¿è¡Œåœ¨ä»¥å¤ªåŠè™šæ‹Ÿæœº(EVM)ä¸Šçš„å­—èŠ‚ç ã€‚
*   è‡ªåŠ¨åŒ–æµ‹è¯•(Automated Testing)â€”â€”é’ˆå¯¹ä½ çš„æ™ºèƒ½åˆçº¦ç¼–å†™æµ‹è¯•ï¼Œä»¥ç¡®ä¿å®ƒä»¬æŒ‰ç…§ä½ æƒ³è¦çš„æ–¹å¼è¿è¡Œã€‚è¿™äº›æµ‹è¯•å¯ä»¥ç”¨ JavaScript æˆ– Solidity ç¼–å†™ï¼Œå¯ä»¥åœ¨ Truffle é…ç½®çš„ä»»ä½•ç½‘ç»œä¸Šè¿è¡Œï¼ŒåŒ…æ‹¬å…¬å…±åŒºå—é“¾ç½‘ç»œã€‚
*   **éƒ¨ç½²&è¿ç§»** -ç¼–å†™è„šæœ¬å°†æ™ºèƒ½åˆçº¦è¿ç§»å’Œéƒ¨ç½²åˆ°ä»»ä½•å…¬å…±ä»¥å¤ªåŠåŒºå—é“¾ç½‘ç»œã€‚
*   **ç½‘ç»œç®¡ç†** -è¿æ¥åˆ°ä»»ä½•å…¬å…±ä»¥å¤ªåŠåŒºå—é“¾ç½‘ç»œï¼Œä»¥åŠä»»ä½•ä½ å¯èƒ½ç”¨äºå¼€å‘ç›®çš„çš„ä¸ªäººåŒºå—é“¾ç½‘ç»œã€‚
*   **å¼€å‘æ§åˆ¶å°**â€”â€”ä½¿ç”¨ Truffle æ§åˆ¶å°åœ¨ JavaScript è¿è¡Œæ—¶ç¯å¢ƒä¸­ä¸æ™ºèƒ½åˆçº¦è¿›è¡Œäº¤äº’ã€‚ä¸ºæ­¤ï¼Œæ‚¨å¯ä»¥è¿æ¥åˆ°æ‚¨åœ¨ç½‘ç»œé…ç½®ä¸­æŒ‡å®šçš„ä»»ä½•åŒºå—é“¾ç½‘ç»œã€‚
*   ç”¨ JavaScript ç¼–å†™å¯ä»¥åœ¨åŒºå—é“¾å…¬å…±ç½‘ç»œä¸Šè¿è¡Œçš„å®šåˆ¶è„šæœ¬ã€‚æ‚¨å¯ä»¥åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­ç¼–å†™ä»»æ„ä»£ç ï¼Œå¹¶åœ¨é¡¹ç›®ä¸­è¿è¡Œå®ƒã€‚
*   **å®¢æˆ·ç«¯å¼€å‘**â€”â€”é…ç½®æ‚¨çš„ truffle é¡¹ç›®æ¥æ‰˜ç®¡å®¢æˆ·ç«¯åº”ç”¨ç¨‹åºï¼Œè¿™äº›åº”ç”¨ç¨‹åºä¸éƒ¨ç½²åˆ°åŒºå—é“¾çš„æ™ºèƒ½åˆçº¦è¿›è¡Œå¯¹è¯ã€‚

ä½ å¯ä»¥åƒè¿™æ ·åœ¨å‘½ä»¤è¡Œä¸­å®‰è£…å¸¦æœ‰ NPM çš„æ¾éœ²ã€‚æ³¨æ„:ä¸ºäº†è·Ÿéšæœ¬æ•™ç¨‹ï¼Œä½¿ç”¨ä¸‹é¢æŒ‡å®šçš„æ¾éœ²çš„ç²¾ç¡®ç‰ˆæœ¬æ˜¯å¾ˆé‡è¦çš„ã€‚

```js
$ npm install -g [[emailÂ protected]](/cdn-cgi/l/email-protection)
```

##### Metamask ä»¥å¤ªåŠé’±åŒ…

ç°åœ¨æ˜¯æ—¶å€™æŠŠä½ çš„ç½‘ç»œæµè§ˆå™¨å˜æˆåŒºå—é“¾æµè§ˆå™¨äº†ã€‚å¤§å¤šæ•°ä¸»è¦çš„ç½‘ç»œæµè§ˆå™¨ç›®å‰éƒ½æ²¡æœ‰è¿æ¥åˆ°åŒºå—é“¾ç½‘ç»œï¼Œæ‰€ä»¥æˆ‘ä»¬å¿…é¡»å®‰è£…ä¸€ä¸ªæµè§ˆå™¨æ‰©å±•æ¥å…è®¸ä»–ä»¬è¿™æ ·åšã€‚

![Metamask Ethereum Wallet Browser Extension](img/8a69f48e4b01cf67ac98cf17178f69a4.png)

æˆ‘å°†ä¸ºè°·æ­Œæµè§ˆå™¨æ‰©å±•[å…ƒæ©ç ã€‚è¦å®‰è£… Metamaskï¼Œ](https://chrome.google.com/webstore/detail/metamask/nkbihfbeogaeaoehlefnkodbefgpgknn?hl=en)[è¯·è®¿é—®æ­¤é“¾æ¥](https://chrome.google.com/webstore/detail/metamask/nkbihfbeogaeaoehlefnkodbefgpgknn?hl=en)æˆ–åœ¨è°·æ­Œ Chrome ç½‘ç»œå•†åº—æœç´¢ Metamask Chrome æ’ä»¶ã€‚ä¸€æ—¦ä½ å®‰è£…äº†å®ƒï¼Œç¡®ä¿å®ƒåœ¨ä½ çš„æ‰©å±•åˆ—è¡¨ä¸­è¢«é€‰ä¸­ã€‚å®‰è£… Chrome æµè§ˆå™¨åï¼Œä½ ä¼šåœ¨æµè§ˆå™¨çš„å³ä¸Šè§’çœ‹åˆ°ç‹ç‹¸å›¾æ ‡ã€‚å¦‚æœé‡åˆ°å›°éš¾ï¼Œè¯·å‚è€ƒè§†é¢‘æ¼”ç¤ºï¼

Metamask è¿˜å…è®¸æˆ‘ä»¬åœ¨è¿æ¥åˆ°åŒºå—é“¾æ—¶ç®¡ç†æˆ‘ä»¬çš„ä¸ªäººè´¦æˆ·ï¼Œä»¥åŠç®¡ç†æˆ‘ä»¬éœ€è¦æ”¯ä»˜äº¤æ˜“çš„ä»¥å¤ªç½‘èµ„é‡‘ã€‚

## é¡¹ç›®è®¾ç½®

è¿™éƒ¨åˆ†æ•™ç¨‹çš„è§†é¢‘ç‰‡æ®µä» [9:26](https://www.youtube.com/watch?v=rzvk2kdjr2I&feature=youtu.be&t=9m26s) å¼€å§‹ã€‚

ç°åœ¨è®©æˆ‘ä»¬åˆ›å»ºé¡¹ç›®ï¼æˆ‘å°†é¦–å…ˆåˆ›å»ºä¸€ä¸ªé¡¹ç›®ç›®å½•ï¼Œå¹¶åƒè¿™æ ·è¾“å…¥:

```js
$ mkdir eth-todo-list
$ cd eth-todo-list

```

ç°åœ¨æˆ‘ä»¬åˆå§‹åŒ–ä¸€ä¸ªæ–°çš„ truffle é¡¹ç›®æ¥å¼€å‘æˆ‘ä»¬çš„é¡¹ç›®ï¼Œå¦‚ä¸‹æ‰€ç¤º:

```js
$ truffle init
```

å¤ªå¥½äº†ï¼æ‚¨çš„ç»ˆç«¯è¾“å‡ºåº”è¯¥æ˜¾ç¤ºé¡¹ç›®å·²ç»æˆåŠŸåˆ›å»ºã€‚æ‚¨å¯ä»¥æ‰“å¼€æ–‡æœ¬ç¼–è¾‘å™¨ï¼Œçœ‹åˆ°åœ¨è¿è¡Œè¯¥å‘½ä»¤ååˆ›å»ºäº†ä¸€äº›æ–°çš„æ–‡ä»¶å’Œç›®å½•ã€‚ç°åœ¨è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ª`package.json`æ–‡ä»¶æ¥å®‰è£…é¡¹ç›®æ‰€éœ€çš„ä¸€äº›å¼€å‘ä¾èµ–é¡¹ã€‚æ‚¨å¯ä»¥ä»å‘½ä»¤è¡Œè¿™æ ·åš:

```js
$ touch package.json
```

æ‚¨å¯ä»¥é€šè¿‡ç®€å•åœ°å°†ä¸‹é¢çš„ä»£ç å¤åˆ¶å¹¶ç²˜è´´åˆ°æ‚¨çš„`package.json`æ–‡ä»¶ä¸­æ¥å¼•å¯¼æ‚¨é¡¹ç›®çš„æ‰€æœ‰ä¾èµ–é¡¹:

```js
{
  "name": "eth-todo-list",
  "version": "1.0.0",
  "description": "Blockchain Todo List Powered By Ethereum",
  "main": "truffle-config.js",
  "directories": {
    "test": "test"
  },
  "scripts": {
    "dev": "lite-server",
    "test": "echo \"Error: no test specified\" && sexit 1"
  },
  "author": "[[emailÂ protected]](/cdn-cgi/l/email-protection)",
  "license": "ISC",
  "devDependencies": {
    "bootstrap": "4.1.3",
    "chai": "^4.1.2",
    "chai-as-promised": "^7.1.1",
    "chai-bignumber": "^2.0.2",
    "lite-server": "^2.3.0",
    "nodemon": "^1.17.3",
    "truffle": "5.0.2",
    "truffle-contract": "3.0.6"
  }
} 
```

ç°åœ¨ï¼Œæ‚¨å¯ä»¥ä»å‘½ä»¤è¡Œå®‰è£…ä¾èµ–é¡¹ï¼Œå¦‚ä¸‹æ‰€ç¤º:

```js
$ npm install
```

ç°åœ¨å·²ç»å®‰è£…äº†ä¾èµ–é¡¹ï¼Œè®©æˆ‘ä»¬æ£€æŸ¥ä¸€ä¸‹æˆ‘ä»¬åˆšåˆšåˆ›å»ºçš„é¡¹ç›®ç›®å½•ç»“æ„:

![Truffle Project Directory Structure](img/74542f26801fdd7e82c2b0a8fcb94528.png)

*   **åˆåŒç›®å½•:**è¿™æ˜¯æ‰€æœ‰æ™ºèƒ½è”ç³»äººæ‰€åœ¨çš„ä½ç½®ã€‚æˆ‘ä»¬å·²ç»æœ‰äº†ä¸€ä»½ç§»æ°‘åˆåŒï¼Œå¤„ç†æˆ‘ä»¬åˆ°åŒºå—é“¾çš„ç§»æ°‘äº‹å®œã€‚
*   **è¿ç§»ç›®å½•**:è¿™æ˜¯æ‰€æœ‰è¿ç§»æ–‡ä»¶æ‰€åœ¨çš„åœ°æ–¹ã€‚è¿™äº›è¿ç§»ç±»ä¼¼äºå…¶ä»–éœ€è¦è¿ç§»æ¥æ”¹å˜æ•°æ®åº“çŠ¶æ€çš„ web å¼€å‘æ¡†æ¶ã€‚æ¯å½“æˆ‘ä»¬åœ¨åŒºå—é“¾éƒ¨ç½²æ™ºèƒ½åˆçº¦æ—¶ï¼Œæˆ‘ä»¬éƒ½åœ¨æ›´æ–°åŒºå—é“¾çš„çŠ¶æ€ï¼Œå› æ­¤éœ€è¦è¿ç§»ã€‚
*   **node_modules ç›®å½•:**è¿™æ˜¯æˆ‘ä»¬åˆšåˆšå®‰è£…çš„æ‰€æœ‰èŠ‚ç‚¹ä¾èµ–é¡¹çš„ä¸»ç›®å½•ã€‚
*   æµ‹è¯•ç›®å½•:è¿™æ˜¯æˆ‘ä»¬ä¸ºæ™ºèƒ½åˆçº¦ç¼–å†™æµ‹è¯•çš„åœ°æ–¹ã€‚
*   **truffle-config.js æ–‡ä»¶:**è¿™æ˜¯æˆ‘ä»¬çš„ truffle é¡¹ç›®çš„ä¸»é…ç½®æ–‡ä»¶ï¼Œæˆ‘ä»¬å°†åœ¨å…¶ä¸­å¤„ç†ç½‘ç»œé…ç½®ä¹‹ç±»çš„äº‹æƒ…ã€‚

ç°åœ¨è®©æˆ‘ä»¬å¼€å§‹å¼€å‘ç®¡ç†å¾…åŠäº‹é¡¹åˆ—è¡¨çš„æ™ºèƒ½å¥‘çº¦ã€‚æˆ‘ä»¬å¯ä»¥è¿™æ ·åšï¼Œåœ¨`contracts`ç›®å½•ä¸­åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶ï¼Œå¦‚ä¸‹æ‰€ç¤º:

```js
$ touch ./contracts/TodoList.sol
```

åœ¨è¿™é‡Œï¼Œè®©æˆ‘ä»¬å¼€å‘æˆ‘ä»¬çš„å¾…åŠäº‹é¡¹åˆ—è¡¨æ™ºèƒ½å¥‘çº¦ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬å°†è¿™æ ·æŒ‡å®šç‰ˆæœ¬:

```js
pragma solidity ^0.5.0;
```

ç°åœ¨æˆ‘ä»¬å¯ä»¥è¿™æ ·å£°æ˜æ™ºèƒ½åˆçº¦:

```js
pragma solidity ^0.5.0;

contract TodoList {
    // Code goes here...
} 
```

æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªåä¸º`TodoList`çš„æ™ºèƒ½å¥‘çº¦ï¼Œåè·ŸèŠ±æ‹¬å·ã€‚æˆ‘ä»¬å°†åœ¨å…¶ä¸­æ·»åŠ æ™ºèƒ½åˆçº¦çš„æ‰€æœ‰ä»£ç ã€‚æˆ‘ä»¬è¦åšçš„äº‹æƒ…å°±æ˜¯è®°å½•å¾…åŠäº‹é¡¹åˆ—è¡¨ä¸­çš„ä»»åŠ¡æ•°é‡ã€‚è¿™å°†å…è®¸æˆ‘ä»¬ç¼–å†™ä¸€äº›ç®€å•çš„ä»£ç ï¼Œå¸®åŠ©æˆ‘ä»¬ç¡®ä¿é¡¹ç›®è®¾ç½®æ­£ç¡®ï¼Œå¹¶ä¸”æˆ‘ä»¬çš„ä»£ç åœ¨åŒºå—é“¾ä¸Šå·¥ä½œã€‚æˆ‘ä»¬å°†ç®€å•åœ°åˆ›å»ºä¸€ä¸ªåä¸º`taskCount`çš„çŠ¶æ€å˜é‡æ¥è·Ÿè¸ªä»»åŠ¡çš„æ•°é‡ï¼Œå¦‚ä¸‹æ‰€ç¤º:

```js
pragma solidity ^0.5.0;

contract TodoList {
  uint taskCount;
} 
```

è¿™é‡Œçš„`taskCount`æ˜¯ä¸€ç§ç‰¹æ®Šçš„å˜é‡ï¼Œç§°ä¸ºâ€œçŠ¶æ€å˜é‡â€ã€‚æˆ‘ä»¬å­˜å‚¨åœ¨è¿™ä¸ªçŠ¶æ€å˜é‡ä¸­çš„ä»»ä½•æ•°æ®éƒ½è¢«å†™å…¥åŒºå—é“¾ä¸Šçš„å­˜å‚¨å™¨ã€‚å®ƒæ›´æ”¹æ™ºèƒ½åå®šçš„çŠ¶æ€ï¼Œå¹¶åœ¨æ•´ä¸ªæ™ºèƒ½åå®šå†…å…·æœ‰ä½œç”¨åŸŸï¼Œè¿™ä¸ä»…åœ¨å‡½æ•°å†…å…·æœ‰ä½œç”¨åŸŸçš„å±€éƒ¨å˜é‡ç›¸åã€‚æˆ‘ä»¬å¯ä»¥è¿™æ ·è®¾ç½®è¿™ä¸ªçŠ¶æ€å˜é‡çš„é»˜è®¤å€¼`0`:

```js
pragma solidity ^0.5.0;

contract TodoList {
  uint taskCount = 0;
} 
```

ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ç§æ–¹æ³•åœ¨å¥‘çº¦ä¹‹å¤–è®¿é—®è¿™ä¸ªçŠ¶æ€å˜é‡çš„å€¼ã€‚æˆ‘ä»¬å¯ä»¥åœ¨ Solidity ä¸­ä½¿ç”¨ä¸€ä¸ªåä¸º`public`çš„ç‰¹æ®Šä¿®é¥°å…³é”®å­—æ¥å®ç°è¿™ä¸€ç‚¹ã€‚å½“æˆ‘ä»¬è¿™æ ·åšæ—¶ï¼ŒSolidity å°†ç¥å¥‡åœ°åˆ›å»ºä¸€ä¸ª`taskCount()`å‡½æ•°ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åœ¨æ™ºèƒ½å¥‘çº¦ä¹‹å¤–è®¿é—®è¿™ä¸ªå˜é‡çš„å€¼ã€‚å½“æˆ‘ä»¬åœ¨æ§åˆ¶å°ã€å®¢æˆ·ç«¯åº”ç”¨ç¨‹åºå’Œæµ‹è¯•æ–‡ä»¶ä¸­ä¸æ™ºèƒ½åˆçº¦äº¤äº’æ—¶ï¼Œè¿™å°†éå¸¸æœ‰ç”¨ã€‚

ç°åœ¨ï¼Œè®©æˆ‘ä»¬ç¼–è¯‘æ™ºèƒ½åˆçº¦å¹¶ç¡®ä¿æ²¡æœ‰é”™è¯¯:

```js
$ truffle compile
```

è€¶ï¼ğŸ‰ä½ åˆšåˆšå†™äº†ä½ çš„ç¬¬ä¸€ä»½ä»¥å¤ªåŠæ™ºèƒ½åˆçº¦ã€‚æ‚¨åº”è¯¥æ³¨æ„åˆ°ï¼Œæ¯å½“æ‚¨åœ¨ä»¥ä¸‹è·¯å¾„ç¼–è¯‘æ™ºèƒ½åˆçº¦æ—¶ï¼Œéƒ½ä¼šç”Ÿæˆä¸€ä¸ªæ–°æ–‡ä»¶:``./build/contracts/TodoList.json``ã€‚è¿™ä¸ªæ–‡ä»¶æ˜¯æ™ºèƒ½åˆåŒ ABI æ–‡ä»¶ï¼Œä»£è¡¨â€œæŠ½è±¡äºŒè¿›åˆ¶æ¥å£â€ã€‚è¯¥æ–‡ä»¶æœ‰è®¸å¤šèŒè´£ï¼Œä½†æˆ‘å°†åœ¨æ­¤å¼ºè°ƒä¸¤é¡¹:

*   å®ƒåŒ…å«å¯åœ¨ä»¥å¤ªåŠè™šæ‹Ÿæœº(EVM)å³ä»¥å¤ªåŠèŠ‚ç‚¹ä¸Šè¿è¡Œçš„ Solidity æ™ºèƒ½åˆçº¦ä»£ç çš„å·²ç¼–è¯‘å­—èŠ‚ç ç‰ˆæœ¬ã€‚
*   å®ƒåŒ…å«æ™ºèƒ½å¥‘çº¦å‡½æ•°çš„ JSON è¡¨ç¤ºï¼Œå¯ä»¥å‘å¤–éƒ¨å®¢æˆ·ç«¯å…¬å¼€ï¼Œå¦‚å®¢æˆ·ç«¯ JavaScript åº”ç”¨ç¨‹åºã€‚

æˆ‘ä»¬çš„ä¸‹ä¸€ä¸ªç›®æ ‡æ˜¯è®¿é—® Truffle æ§åˆ¶å°ä¸­çš„æ™ºèƒ½åˆçº¦ã€‚ç„¶è€Œï¼Œæˆ‘ä»¬ä¸èƒ½è¿è¡Œ Truffle æ§åˆ¶å°ï¼Œå› ä¸ºæˆ‘ä»¬çš„åº”ç”¨ç¨‹åºè¿˜æ²¡æœ‰è¿æ¥åˆ°æˆ‘ä»¬åœ¨ [dependencies](#dependencies) éƒ¨åˆ†è®¾ç½®çš„ Ganache ä¸ªäººåŒºå—é“¾ç½‘ç»œã€‚è¦åœ¨ Truffle æ§åˆ¶å°å†…ä¸ä¸ªäººåŒºå—é“¾ç½‘ç»œä¸Šçš„æ™ºèƒ½åˆçº¦å¯¹è¯ï¼Œæˆ‘ä»¬å¿…é¡»åšå‡ ä»¶äº‹:

*   æ›´æ–°æˆ‘ä»¬é¡¹ç›®çš„é…ç½®æ–‡ä»¶ï¼ŒæŒ‡å®šæˆ‘ä»¬æƒ³è¦è¿æ¥çš„ä¸ªäººåŒºå—é“¾ç½‘ç»œ(Ganache)ã€‚
*   åˆ›å»ºä¸€ä¸ªè¿ç§»è„šæœ¬ï¼Œå‘Šè¯‰ Truffle å¦‚ä½•å°†æ™ºèƒ½åˆåŒéƒ¨ç½²åˆ°ä¸ªäººåŒºå—é“¾ç½‘ç»œã€‚
*   è¿è¡Œæ–°åˆ›å»ºçš„è¿ç§»è„šæœ¬ï¼Œå°†æ™ºèƒ½åˆåŒéƒ¨ç½²åˆ°ä¸ªäººåŒºå—é“¾ç½‘ç»œã€‚

é¦–å…ˆï¼Œæˆ‘ä»¬å°†æ›´æ–°é¡¹ç›®é…ç½®æ–‡ä»¶ï¼Œä»¥æŒ‡å®šæˆ‘ä»¬å¸Œæœ›åœ¨ç¬¬ä¸€éƒ¨åˆ†ä¸­è®¾ç½®çš„ä¸ªäººåŒºå—é“¾ç½‘ç»œã€‚æ‰¾åˆ°æ–‡ä»¶`truffle-config.js`å¹¶ç²˜è´´ä»¥ä¸‹ä»£ç :

```js
module.exports = {
  networks: {
    development: {
      host: "127.0.0.1",
      port: 7545,
      network_id: "*" // Match any network id
    }
  },
  solc: {
    optimizer: {
      enabled: true,
      runs: 200
    }
  }
} 
```

æ³¨æ„:è¿™äº›åº”è¯¥ä¸ Ganache ä¸ªäººåŒºå—é“¾ç½‘ç»œæä¾›çš„é»˜è®¤è®¾ç½®ç›¸åŒ¹é…ã€‚å¦‚æœæ‚¨åœ¨ Ganache è®¾ç½®é¡µé¢ä¸­æ›´æ”¹äº†ä»»ä½•è®¾ç½®ï¼Œæ¯”å¦‚ç«¯å£ï¼Œè¿™äº›åº”è¯¥ä¼šåæ˜ åœ¨è¿™é‡Œã€‚

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†åœ¨è¿ç§»ç›®å½•ä¸­åˆ›å»ºä¸€ä¸ªè¿ç§»è„šæœ¬ï¼Œä»¥å°†æ™ºèƒ½åˆåŒéƒ¨ç½²åˆ°ä¸ªäººåŒºå—é“¾ç½‘ç»œã€‚ä»é¡¹ç›®æ ¹ç›®å½•ä¸­ï¼Œé€šè¿‡å‘½ä»¤è¡Œåˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶ï¼Œå¦‚ä¸‹æ‰€ç¤º:

```js
$ touch migrations/2_deploy_contracts.js
```

è®©æˆ‘è§£é‡Šä¸€ä¸‹è¿™ä¸ªæ–‡ä»¶çš„ä½œç”¨ã€‚æ¯å½“æˆ‘ä»¬åˆ›å»ºæ–°çš„æ™ºèƒ½åˆåŒæ—¶ï¼Œæˆ‘ä»¬éƒ½åœ¨æ›´æ–°åŒºå—é“¾çš„çŠ¶æ€ã€‚è®°ä½ï¼Œæˆ‘è¯´è¿‡åŒºå—é“¾åŸºæœ¬ä¸Šæ˜¯ä¸€ä¸ªæ•°æ®åº“ã€‚å› æ­¤ï¼Œæ— è®ºä½•æ—¶æˆ‘ä»¬æ°¸ä¹…åœ°æ”¹å˜å®ƒï¼Œæˆ‘ä»¬å¿…é¡»å°†å®ƒä»ä¸€ç§çŠ¶æ€è¿ç§»åˆ°å¦ä¸€ç§çŠ¶æ€ã€‚è¿™ä¸æ‚¨å¯èƒ½åœ¨å…¶ä»– web åº”ç”¨ç¨‹åºå¼€å‘æ¡†æ¶ä¸­æ‰§è¡Œçš„æ•°æ®åº“è¿ç§»éå¸¸ç›¸ä¼¼ã€‚

è¯·æ³¨æ„ï¼Œæˆ‘ä»¬ç”¨æ•°å­—ç»™è¿ç§»ç›®å½•ä¸­çš„æ‰€æœ‰æ–‡ä»¶ç¼–å·ï¼Œä»¥ä¾¿ Truffle çŸ¥é“ä»¥ä»€ä¹ˆé¡ºåºæ‰§è¡Œå®ƒä»¬ã€‚åœ¨è¿™ä¸ªæ–°åˆ›å»ºçš„è¿ç§»æ–‡ä»¶ä¸­ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä»£ç æ¥éƒ¨ç½²æ™ºèƒ½åˆçº¦:

```js
var TodoList = artifacts.require("./TodoList.sol");

module.exports = function(deployer) {
  deployer.deploy(TodoList);
}; 
```

é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦æˆ‘ä»¬å·²ç»åˆ›å»ºçš„å¥‘çº¦ï¼Œå¹¶å°†å®ƒèµ‹ç»™ä¸€ä¸ªåä¸ºâ€œTodoListâ€çš„å˜é‡ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†å®ƒæ·»åŠ åˆ°å·²éƒ¨ç½²å¥‘çº¦çš„æ¸…å•ä¸­ï¼Œä»¥ç¡®ä¿å®ƒåœ¨æˆ‘ä»¬è¿è¡Œè¿ç§»æ—¶å¾—åˆ°éƒ¨ç½²ã€‚ç°åœ¨ï¼Œè®©æˆ‘ä»¬ä»å‘½ä»¤è¡Œè¿è¡Œè¿™ä¸ªè¿ç§»è„šæœ¬ï¼Œå¦‚ä¸‹æ‰€ç¤º:

```js
$ truffle migrate
```

ç°åœ¨ï¼Œæˆ‘ä»¬å·²ç»æˆåŠŸåœ°å°†æ™ºèƒ½åˆåŒè¿ç§»åˆ°ä¸ªäººåŒºå—é“¾ç½‘ç»œï¼Œè®©æˆ‘ä»¬æ‰“å¼€æ§åˆ¶å°ä¸æ™ºèƒ½åˆåŒè¿›è¡Œäº¤äº’ã€‚æ‚¨å¯ä»¥ä»å‘½ä»¤è¡Œæ‰“å¼€ truffle æ§åˆ¶å°ï¼Œå¦‚ä¸‹æ‰€ç¤º:

```js
$ truffle console
```

ç°åœ¨æˆ‘ä»¬å·²ç»è¿›å…¥æ§åˆ¶å°ï¼Œè®©æˆ‘ä»¬è·å–ä¸€ä¸ªå·²éƒ¨ç½²çš„æ™ºèƒ½å¥‘çº¦çš„å®ä¾‹ï¼Œçœ‹çœ‹æˆ‘ä»¬æ˜¯å¦å¯ä»¥ä»å¥‘çº¦ä¸­è¯»å–`taskCount`ã€‚ä»æ§åˆ¶å°ä¸­ï¼Œè¿è¡Œä»¥ä¸‹ä»£ç :

```js
todoList = await TodoList.deployed()
```

è¿™é‡Œçš„`TodoList`æ˜¯æˆ‘ä»¬åœ¨è¿ç§»æ–‡ä»¶ä¸­åˆ›å»ºçš„å˜é‡çš„åç§°ã€‚æˆ‘ä»¬ç”¨`deployed()`å‡½æ•°æ£€ç´¢äº†ä¸€ä¸ªå·²éƒ¨ç½²çš„å¥‘çº¦å®ä¾‹ï¼Œå¹¶å°†å…¶åˆ†é…ç»™ä¸€ä¸ª`todoList`ã€‚å¦å¤–ï¼Œè¯·æ³¨æ„`await`å…³é”®å­—çš„ä½¿ç”¨ã€‚æˆ‘ä»¬å¿…é¡»ä»¥å¼‚æ­¥æ–¹å¼ä¸åŒºå—é“¾äº¤äº’ã€‚å› æ­¤ï¼ŒJavaScript æ˜¯å®¢æˆ·ç«¯ä¸åŒºå—é“¾æ™ºèƒ½åˆçº¦äº¤äº’çš„ç»ä½³é€‰æ‹©ã€‚JavaScript ä¸­æœ‰å‡ ç§å¤„ç†å¼‚æ­¥åŠ¨ä½œçš„ç­–ç•¥ã€‚æœ€æµè¡Œçš„æ–¹å¼ä¹‹ä¸€æ˜¯æˆ‘åœ¨è¿™é‡Œé€‰æ‹©çš„`async/await`æ¨¡å¼ã€‚Truffle æœ€è¿‘åœ¨ Truffle æ§åˆ¶å°ä¸­å‘å¸ƒäº†å¯¹æ­¤çš„æ”¯æŒã€‚ä½ å¯ä»¥åœ¨è¿™é‡Œé˜…è¯»æ›´å¤šå…³äº[å¼‚æ­¥/ç­‰å¾…æ¨¡å¼çš„ä¿¡æ¯](https://javascript.info/async-await)ã€‚

é¦–å…ˆï¼Œæˆ‘ä»¬å¯ä»¥è·å¾—éƒ¨ç½²åˆ°åŒºå—é“¾çš„æ™ºèƒ½åˆçº¦çš„åœ°å€ï¼Œå¦‚ä¸‹æ‰€ç¤º:

```js
todoList.address
// => '0xABC123...' 

```

ç°åœ¨æˆ‘ä»¬å¯ä»¥åƒè¿™æ ·ä»å­˜å‚¨å™¨ä¸­è¯»å–`taskCount`çš„å€¼:

```js
takCount = await app.taskCount()
// => 0 

```

è€¶ï¼ğŸ‰æ‚¨å·²ç»æˆåŠŸå®Œæˆäº†æœ¬æ•™ç¨‹çš„ç¬¬ä¸€éƒ¨åˆ†ã€‚æ‚¨å·²ç»å®Œæˆäº†ä»¥ä¸‹æ‰€æœ‰æ“ä½œ:

*   ä¸ºåŒºå—é“¾å¼€å‘è®¾ç½®æ‚¨çš„æœºå™¨
*   åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„æ¾éœ²é¡¹ç›®
*   åˆ›å»ºæ‚¨çš„ç¬¬ä¸€ä¸ªæ™ºèƒ½åˆåŒ
*   åœ¨å®æ—¶åŒºå—é“¾ä¸Šä¸æ‚¨æ–°åˆ›å»ºçš„æ™ºèƒ½åˆåŒè¿›è¡Œäº¤äº’

å¦‚æœæ‚¨åœ¨ä»»ä½•ä¸€ä¸ªæ­¥éª¤ä¸Šé‡åˆ°å›°éš¾ï¼Œå¯ä»¥ä» [github](https://github.com/dappuniversity/eth-todo-list) ä¸­å…‹éš†è¿™ä¸ªéƒ¨åˆ†çš„é¡¹ç›®ä»£ç ã€‚æ‚¨ä¹Ÿå¯ä»¥ä»è¿™é‡Œå¼€å§‹å‚è€ƒæœ¬èŠ‚çš„è§†é¢‘æ•™ç¨‹ã€‚

## åˆ—å‡ºä»»åŠ¡

è¿™éƒ¨åˆ†æ•™ç¨‹çš„è§†é¢‘ç‰‡æ®µä» [22:47](https://www.youtube.com/watch?v=rzvk2kdjr2I&feature=youtu.be&t=22m47s) å¼€å§‹ã€‚

ç°åœ¨è®©æˆ‘ä»¬å¼€å§‹åœ¨å¾…åŠäº‹é¡¹åˆ—è¡¨ä¸­åˆ—å‡ºä»»åŠ¡ã€‚ä»¥ä¸‹æ˜¯æˆ‘ä»¬å°†åœ¨æœ¬éƒ¨åˆ†å®Œæˆçš„æ‰€æœ‰æ­¥éª¤:

1.  ç¼–å†™ä»£ç ä»¥åœ¨æ™ºèƒ½åˆçº¦ä¸­åˆ—å‡ºä»»åŠ¡
2.  åœ¨ Truffle æ§åˆ¶å°ä¸­åˆ—å‡ºæ™ºèƒ½åˆçº¦ä¸­çš„ä»»åŠ¡
3.  åœ¨å®¢æˆ·ç«¯åº”ç”¨ç¨‹åºä¸­åˆ—å‡ºä»»åŠ¡
4.  ç¼–å†™åˆ—å‡ºä»»åŠ¡çš„æµ‹è¯•

ä¸ºäº†åˆ—å‡ºæ™ºèƒ½åˆçº¦ä¸­çš„ä»»åŠ¡ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ç§åœ¨ solidity ä¸­å»ºæ¨¡ä»»åŠ¡çš„æ–¹æ³•ã€‚Solidity å…è®¸ä½ ç”¨[ç»“æ„](https://solidity.readthedocs.io/en/v0.5.3/types.html#structs)å®šä¹‰è‡ªå·±çš„æ•°æ®ç±»å‹ã€‚åˆ©ç”¨è¿™ä¸ªå¼ºå¤§çš„ç‰¹æ€§ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹ä»»æ„æ•°æ®è¿›è¡Œå»ºæ¨¡ã€‚æˆ‘ä»¬å°†ä½¿ç”¨ä¸€ä¸ªç»“æ„æ¥ä¸ºæˆ‘ä»¬çš„ todo åˆ—è¡¨å»ºæ¨¡ä»»åŠ¡ï¼Œå¦‚ä¸‹æ‰€ç¤º:

```js
pragma solidity ^0.5.0;

contract TodoList {
  uint public taskCount = 0;

  struct Task {
    uint id;
    string content;
    bool completed;
  }
} 
```

é¦–å…ˆï¼Œæˆ‘ä»¬ç”¨å…³é”®å­—`struct`ä¸ºä»»åŠ¡å»ºæ¨¡ï¼Œåè·Ÿæ–°ç»“æ„çš„åç§°`Task`ã€‚æ³¨æ„ï¼Œè¿™å¹¶ä¸ä»£è¡¨ä¸€ä¸ª`Task`çš„å®ä¾‹ï¼Œè€Œåªæ˜¯ä¸€ä¸ª`Task`ç»“æ„çš„å®šä¹‰ã€‚èŠ±æ‹¬å·ä¸­åŒ…å«çš„è¡Œå®šä¹‰äº†`Task`ç»“æ„çš„å±æ€§:

*   `uint id` -è¿™æ˜¯ç»“æ„çš„å”¯ä¸€æ ‡è¯†ç¬¦ã€‚å®ƒå°†æœ‰ä¸€ä¸ª`id`ï¼Œå°±åƒä¼ ç»Ÿçš„æ•°æ®åº“è®°å½•ä¸€æ ·ã€‚æ³¨æ„ï¼Œæˆ‘ä»¬å°†æ ‡è¯†ç¬¦çš„æ•°æ®ç±»å‹å£°æ˜ä¸º`uint`ï¼Œå®ƒä»£è¡¨â€œæ— ç¬¦å·æ•´æ•°â€ã€‚è¿™ä»…ä»…æ„å‘³ç€å®ƒæ˜¯ä¸€ä¸ªéè´Ÿæ•´æ•°ã€‚å®ƒå‰é¢æ²¡æœ‰â€œç¬¦å·â€ï¼Œå³ä¸€ä¸ª`-`æˆ–`+`ç¬¦å·ï¼Œæš—ç¤ºå®ƒæ€»æ˜¯æ­£çš„ã€‚
*   `string content` -è¿™æ˜¯ todo åˆ—è¡¨ä¸­ä»»åŠ¡çš„æ–‡æœ¬ï¼ŒåŒ…å«åœ¨ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­ã€‚
*   `bool completed` -è¿™æ˜¯å¾…åŠäº‹é¡¹åˆ—è¡¨çš„å¤é€‰æ¡†çŠ¶æ€ï¼Œå³`true/false`ã€‚å¦‚æœæ˜¯`true`ï¼Œä»»åŠ¡å°†è¢«â€œå®Œæˆâ€æˆ–ä»å¾…åŠäº‹é¡¹åˆ—è¡¨ä¸­å‹¾æ‰ã€‚

æ—¢ç„¶æˆ‘ä»¬å·²ç»å»ºæ¨¡äº†ä¸€ä¸ªä»»åŠ¡ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªåœ°æ–¹æ¥å°†æ‰€æœ‰çš„ä»»åŠ¡æ”¾åœ¨ todo åˆ—è¡¨ä¸­ï¼æˆ‘ä»¬å¸Œæœ›å°†å®ƒä»¬å­˜å‚¨åœ¨åŒºå—é“¾ä¸Šï¼Œè¿™æ ·æ™ºèƒ½åˆçº¦çš„çŠ¶æ€å°†æ˜¯æŒä¹…çš„ã€‚æˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªçŠ¶æ€å˜é‡æ¥è®¿é—®åŒºå—é“¾çš„å­˜å‚¨å™¨ï¼Œå°±åƒæˆ‘ä»¬ç”¨`taskCount`åšçš„é‚£æ ·ã€‚æˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ª`tasks`çŠ¶æ€å˜é‡ã€‚å®ƒå°†ä½¿ç”¨ä¸€ç§ç‰¹æ®Šçš„å®ä½“æ•°æ®ç»“æ„ï¼Œç§°ä¸ºæ˜ å°„ï¼Œå¦‚ä¸‹æ‰€ç¤º:

```js
pragma solidity ^0.5.0;

contract TodoList {
  uint public taskCount = 0;

  struct Task {
    uint id;
    string content;
    bool completed;
  }

  mapping(uint => Task) public tasks;
} 
```

Solidity ä¸­çš„æ˜ å°„å¾ˆåƒå…¶ä»–ç¼–ç¨‹è¯­è¨€ä¸­çš„å…³è”æ•°ç»„æˆ–æ•£åˆ—ã€‚å®ƒåˆ›å»ºå­˜å‚¨åœ¨åŒºå—é“¾ä¸Šçš„é”®å€¼å¯¹ã€‚æˆ‘ä»¬å°†ä½¿ç”¨å”¯ä¸€çš„ id ä½œä¸ºå¯†é’¥ã€‚ä»·å€¼å°†æ˜¯ä»»åŠ¡æœ¬èº«ã€‚è¿™å°†å…è®¸æˆ‘ä»¬é€šè¿‡`id`æŸ¥æ‰¾ä»»ä½•ä»»åŠ¡ï¼

ç°åœ¨è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªç”¨äºåˆ›å»ºä»»åŠ¡çš„å‡½æ•°ã€‚è¿™å°†å…è®¸æˆ‘ä»¬åœ¨é»˜è®¤æƒ…å†µä¸‹å‘ todo åˆ—è¡¨æ·»åŠ æ–°ä»»åŠ¡ï¼Œä»¥ä¾¿æˆ‘ä»¬å¯ä»¥åœ¨æ§åˆ¶å°ä¸­åˆ—å‡ºå®ƒä»¬ã€‚

```js
pragma solidity ^0.5.0;

contract TodoList {
  uint public taskCount = 0;

  struct Task {
    uint id;
    string content;
    bool completed;
  }

  mapping(uint => Task) public tasks;

  function createTask(string memory _content) public {
    taskCount ++;
    tasks[taskCount] = Task(taskCount, _content, false);
  }

} 
```

æˆ‘å°†è§£é‡Šè¿™ä¸ªå‡½æ•°:

*   é¦–å…ˆï¼Œæˆ‘ä»¬ç”¨å…³é”®å­—`function`åˆ›å»ºå‡½æ•°ï¼Œå¹¶ç»™å®ƒå‘½åä¸º`createTask()`
*   æˆ‘ä»¬å…è®¸å‡½æ•°æ¥å—ä¸€ä¸ªåä¸º`_content`çš„å‚æ•°ï¼Œè¿™å°†æ˜¯ä»»åŠ¡çš„æ–‡æœ¬ã€‚æˆ‘ä»¬æŒ‡å®šè¿™ä¸ªå‚æ•°å°†æ˜¯`string`æ•°æ®ç±»å‹ï¼Œå¹¶ä¸”å®ƒå°†åœ¨`memory`ä¸­ä¿æŒä¸å˜
*   æˆ‘ä»¬å°†å‡½æ•° visibility è®¾ç½®ä¸º`public`,è¿™æ ·å°±å¯ä»¥åœ¨æ™ºèƒ½åˆçº¦ä¹‹å¤–è°ƒç”¨å®ƒï¼Œæ¯”å¦‚åœ¨æ§åˆ¶å°ä¸­ï¼Œæˆ–è€…ä»å®¢æˆ·ç«¯è°ƒç”¨
*   åœ¨å‡½æ•°å†…éƒ¨ï¼Œæˆ‘ä»¬ä¸ºæ–°ä»»åŠ¡åˆ›å»ºäº†ä¸€ä¸ª`id`ã€‚æˆ‘ä»¬ç®€å•åœ°å°†ç°æœ‰çš„`taskCount`åŠ  1ã€‚
*   ç°åœ¨æˆ‘ä»¬é€šè¿‡è°ƒç”¨`Task(taskCount, _content, false);`å¹¶ä¼ å…¥æ–°ä»»åŠ¡çš„å€¼æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„ä»»åŠ¡ç»“æ„ã€‚
*   æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬é€šè¿‡å°†è¿™ä¸ªæ–°ä»»åŠ¡æ·»åŠ åˆ°`tasks`æ˜ å°„æ¥å­˜å‚¨åœ¨åŒºå—é“¾ä¸Šï¼Œå¦‚ä¸‹æ‰€ç¤º:`task[taskCount] = ...`ã€‚

ç°åœ¨ï¼Œæ¯å½“æ™ºèƒ½åˆçº¦éƒ¨ç½²åˆ°åŒºå—é“¾æ—¶ï¼Œæˆ‘ä»¬éƒ½å¸Œæœ›å‘ todo åˆ—è¡¨æ·»åŠ ä¸€ä¸ªä»»åŠ¡ï¼Œè¿™æ ·å®ƒå°†æ‹¥æœ‰ä¸€ä¸ªé»˜è®¤ä»»åŠ¡ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ§åˆ¶å°ä¸­æ£€æŸ¥å®ƒã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡è°ƒç”¨æ™ºèƒ½å¥‘çº¦çš„æ„é€ å‡½æ•°ä¸­çš„`createTask()`å‡½æ•°æ¥å®ç°è¿™ä¸€ç‚¹ï¼Œå¦‚ä¸‹æ‰€ç¤º:

```js
 contract TodoList {
      // ....

      constructor() public {
        createTask("Check out dappuniversity.com");
      }

      // ....

    } 
```

æ­£å¦‚ä½ åœ¨ä¸Šé¢çœ‹åˆ°çš„ï¼Œæˆ‘ä»¬ç”¨å…³é”®å­—`constructor`åˆ›å»ºäº†æ„é€ å‡½æ•°ã€‚æ¯å½“å¥‘çº¦è¢«åˆå§‹åŒ–ï¼Œå³è¢«éƒ¨ç½²åˆ°åŒºå—é“¾æ—¶ï¼Œè¯¥å‡½æ•°å°†ä»…è¿è¡Œä¸€æ¬¡ã€‚åœ¨è¿™ä¸ªå‡½æ•°ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„é»˜è®¤ä»»åŠ¡ï¼Œå…¶å­—ç¬¦ä¸²å†…å®¹ä¸º[â€œCheck out DAP university . comâ€](/free-download)ã€‚

ç°åœ¨ï¼Œè®©æˆ‘ä»¬å°†è¿™ä¸ªæ™ºèƒ½åˆåŒéƒ¨ç½²åˆ°åŒºå—é“¾ã€‚ä¸ºäº†åšåˆ°è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬å¿…é¡»éƒ¨ç½²ä»£ç çš„æ–°å‰¯æœ¬*ã€‚è®°ä½ï¼Œæ™ºèƒ½åˆçº¦ä»£ç æ˜¯ä¸å¯å˜çš„ï¼å®ƒä¸èƒ½æ”¹å˜ã€‚å› æ­¤ï¼Œæ¯å½“æˆ‘ä»¬æ›´æ”¹ä»£ç æ—¶ï¼Œéƒ½å¿…é¡»åˆ›å»ºä¸€ä¸ªæ–°çš„æ™ºèƒ½å¥‘çº¦ã€‚å¹¸è¿çš„æ˜¯ï¼ŒTruffle æä¾›äº†ä¸€æ¡æ·å¾„æ¥å¸®åŠ©è§£å†³è¿™ä¸ªé—®é¢˜ã€‚æˆ‘ä»¬å¯ä»¥åƒè¿™æ ·é‡æ–°è¿è¡Œè¿ç§»:*

```js
$ truffle migrate --reset
```

ç»´å¥¥æ‹‰ã€‚ç°åœ¨æˆ‘ä»¬æœ‰äº†åŒºå—é“¾æ™ºèƒ½åˆçº¦çš„æ–°å‰¯æœ¬ã€‚ç°åœ¨è®©æˆ‘ä»¬åˆ—å‡ºæ§åˆ¶å°ä¸­çš„ä»»åŠ¡ã€‚

```js
$ truffle console
```

åœ¨æ§åˆ¶å°ä¸­ï¼Œè®©æˆ‘ä»¬è·å¾—æ–°æ™ºèƒ½åˆçº¦çš„å·²éƒ¨ç½²å‰¯æœ¬ã€‚

```js
todoList = await TodoList.deployed()
```

ç°åœ¨æˆ‘ä»¬å¯ä»¥é€šè¿‡è°ƒç”¨`tasks()`å‡½æ•°ä» todo åˆ—è¡¨ä¸­è·å–ä»»åŠ¡ã€‚è¿™å°†å…è®¸æˆ‘ä»¬é€šè¿‡`id`è®¿é—®æ¥è‡ª`tasks`æ˜ å°„çš„å€¼ã€‚å½“æˆ‘ä»¬è°ƒç”¨è¿™ä¸ªå‡½æ•°æ—¶ï¼Œæˆ‘ä»¬å°†ç®€å•åœ°ä¼ å…¥åˆ—è¡¨ä¸­ç¬¬ä¸€ä¸ªä»»åŠ¡çš„`id`:

```js
task = await todoList.tasks(1)
```

è€¶ï¼ğŸ‰å¦‚ä½•åœ¨æ§åˆ¶å°ä¸­æ£€æŸ¥è¯¥ä»»åŠ¡çš„å€¼ã€‚ğŸ˜ƒ

æ—¢ç„¶æˆ‘ä»¬å·²ç»å°†è¿™ä¸ªæ™ºèƒ½åˆçº¦è¿ç§»åˆ°äº†åŒºå—é“¾ï¼Œé‚£ä¹ˆè®©æˆ‘ä»¬åˆ›å»ºå®¢æˆ·ç«¯ä»£ç æ¥ä¸å¾…åŠäº‹é¡¹åˆ—è¡¨æ™ºèƒ½åˆçº¦è¿›è¡Œäº¤äº’ã€‚æ‚¨éœ€è¦ä¸ºæ‚¨çš„é¡¹ç›®åˆ›å»ºä»¥ä¸‹æ–‡ä»¶:

*   `bs-config.json`
*   `src/index.html`
*   `src/app.js`

æˆ‘ä»¬å°†é€ä¸€å¡«å……æ‰€æœ‰è¿™äº›æ–‡ä»¶çš„ä»£ç ã€‚æˆ‘ä»¬ä½¿ç”¨ [lite-server](https://github.com/johnpapa/lite-server) ä¸ºå®¢æˆ·ç«¯æä¾›æ‰€æœ‰çš„é¡¹ç›®æ–‡ä»¶ã€‚æˆ‘ä»¬éœ€è¦å‘Šè¯‰ lite-server æ‰€æœ‰è¿™äº›æ–‡ä»¶çš„ä½ç½®ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨`bs-config.json`æ–‡ä»¶ä¸­æ›´æ–° lite-server çš„ browsersync é…ç½®æ¥åšåˆ°è¿™ä¸€ç‚¹ã€‚å°†æ­¤é…ç½®ç²˜è´´åˆ°é¡¹ç›®æ–‡ä»¶ä¸­:

```js
{
  "server": {
    "baseDir": [
      "./src",
      "./build/contracts"
    ],
    "routes": {
      "/vendor": "./node_modules"
    }
  }
}
```

è¿™ä¸ªé…ç½®å‘Šè¯‰ lite-server å°†`src`å’Œ`build/contracts`ç›®å½•ä¸­çš„æ‰€æœ‰æ–‡ä»¶æš´éœ²ç»™ web æœåŠ¡å™¨çš„æ ¹ç›®å½•ã€‚å®ƒè¿˜ä¸ºå‡ºç°åœ¨`vendor`è·¯å¾„ä¸­çš„`node_modules`ç›®å½•ä¸­çš„ä»»ä½•æ–‡ä»¶æ·»åŠ äº†ä¸€ä¸ªåˆ«åã€‚è¿™å°†å…è®¸æˆ‘ä»¬é€šè¿‡`vendor`è·¯å¾„å°†ä»»ä½•é¡¹ç›®ä¾èµ–å…³ç³»(å¦‚ [bootstrap](https://getbootstrap.com/) )æ‹‰å…¥å®¢æˆ·ç«¯ï¼Œæˆ‘ä»¬ç¨åä¼šçœ‹åˆ°ã€‚

ç°åœ¨è®©æˆ‘ä»¬ä¸ºå¾…åŠäº‹é¡¹åˆ—è¡¨å¡«å…… HTML ä»£ç ã€‚æœ¬æ•™ç¨‹ä¸»è¦å…³æ³¨åŒºå—é“¾æŠ€æœ¯ï¼Œæ‰€ä»¥æˆ‘ä¸æƒ³åœ¨ HTML å’Œ CSS éƒ¨åˆ†èŠ±å¤ªå¤šæ—¶é—´ã€‚æˆ‘å°†ç®€å•åœ°åœ¨è¿™é‡Œç²˜è´´ HTML ä»£ç :

```js
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Dapp University | Todo List</title>

    <!-- Bootstrap -->
    <link href="vendor/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <style>
      main {
        margin-top: 60px;
      }

      #content {
        display: none;
      }

      form {
        width: 350px;
        margin-bottom: 10px;
      }

      ul {
        margin-bottom: 0px;
      }

      #completedTaskList .content {
        color: grey;
        text-decoration: line-through;
      }
    </style>
  </head>
  <body>
    <nav class="navbar navbar-dark fixed-top bg-dark flex-md-nowrap p-0 shadow">
      <a class="navbar-brand col-sm-3 col-md-2 mr-0" href="http://www.dappuniversity.com/free-download" target="_blank">Dapp University | Todo List</a>
      <ul class="navbar-nav px-3">
        <li class="nav-item text-nowrap d-none d-sm-none d-sm-block">
          <small><a class="nav-link" href="#"><span id="account"></span></a></small>
        </li>
      </ul>
    </nav>
    <div class="container-fluid">
      <div class="row">
        <main role="main" class="col-lg-12 d-flex justify-content-center">
          <div id="loader" class="text-center">
            <p class="text-center">Loading...</p>
          </div>
          <div id="content">
         <!-- <form onSubmit="App.createTask(); return false;">
              <input id="newTask" type="text" class="form-control" placeholder="Add task..." required>
              <input type="submit" hidden="">
            </form> -->
            <ul id="taskList" class="list-unstyled">
              <div class="taskTemplate" class="checkbox" style="display: none">
                <label>
                  <input type="checkbox" />
                  <span class="content">Task content goes here...</span>
                </label>
              </div>
            </ul>
            <ul id="completedTaskList" class="list-unstyled">
            </ul>
          </div>
        </main>
      </div>
    </div>

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="vendor/bootstrap/dist/js/bootstrap.min.js"></script>
    <script src="vendor/truffle-contract/dist/truffle-contract.js"></script>
    <script src="app.js"></script>
  </body>
</html>
```

è¿™ä¸ªæ–‡ä»¶æ­å»ºäº†é¡¹ç›®æ‰€éœ€çš„æ‰€æœ‰ HTMLã€‚æˆ‘å·²ç»æ³¨é‡Šæ‰äº†è¡¨å•ä»£ç ï¼Œæˆ‘ä»¬å°†åœ¨åé¢çš„éƒ¨åˆ†å¯ç”¨å®ƒã€‚è¯¥æ–‡ä»¶å¼•å…¥äº†é¡¹ç›®çš„æ‰€æœ‰ä¾èµ–é¡¹ï¼Œå¦‚å¼•å¯¼æ¨¡æ¿æ¡†æ¶ï¼Œå®ƒå°†å…è®¸æˆ‘ä»¬åˆ›å»ºå¥½çœ‹çš„ UI å…ƒç´ ï¼Œè€Œä¸å¿…ç¼–å†™å¤ªå¤šçš„ CSSã€‚å®ƒè¿˜ä½¿ç”¨äº† Truffle Conract åº“ï¼Œå…è®¸æˆ‘ä»¬ç”¨ JavaScript ä¸ todo list æ™ºèƒ½å¥‘çº¦è¿›è¡Œäº¤äº’ã€‚

ç°åœ¨è®©æˆ‘ä»¬å¡«å†™è¿™ä¸€éƒ¨åˆ†çš„ JavaScript ä»£ç ã€‚æˆ‘ä»¬å°†å‘æ–°åˆ›å»ºçš„`app.js`æ–‡ä»¶æ·»åŠ ä»£ç ï¼Œå¦‚ä¸‹æ‰€ç¤º:

```js
App = {
  loading: false,
  contracts: {},

  load: async () => {
    await App.loadWeb3()
    await App.loadAccount()
    await App.loadContract()
    await App.render()
  },

  // https://medium.com/metamask/https-medium-com-metamask-breaking-change-injecting-web3-7722797916a8
  loadWeb3: async () => {
    if (typeof web3 !== 'undefined') {
      App.web3Provider = web3.currentProvider
      web3 = new Web3(web3.currentProvider)
    } else {
      window.alert("Please connect to Metamask.")
    }
    // Modern dapp browsers...
    if (window.ethereum) {
      window.web3 = new Web3(ethereum)
      try {
        // Request account access if needed
        await ethereum.enable()
        // Acccounts now exposed
        web3.eth.sendTransaction({/* ... */})
      } catch (error) {
        // User denied account access...
      }
    }
    // Legacy dapp browsers...
    else if (window.web3) {
      App.web3Provider = web3.currentProvider
      window.web3 = new Web3(web3.currentProvider)
      // Acccounts always exposed
      web3.eth.sendTransaction({/* ... */})
    }
    // Non-dapp browsers...
    else {
      console.log('Non-Ethereum browser detected. You should consider trying MetaMask!')
    }
  },

  loadAccount: async () => {
    // Set the current blockchain account
    App.account = web3.eth.accounts[0]
  },

  loadContract: async () => {
    // Create a JavaScript version of the smart contract
    const todoList = await $.getJSON('TodoList.json')
    App.contracts.TodoList = TruffleContract(todoList)
    App.contracts.TodoList.setProvider(App.web3Provider)

    // Hydrate the smart contract with values from the blockchain
    App.todoList = await App.contracts.TodoList.deployed()
  },

  render: async () => {
    // Prevent double render
    if (App.loading) {
      return
    }

    // Update app loading state
    App.setLoading(true)

    // Render Account
    $('#account').html(App.account)

    // Render Tasks
    await App.renderTasks()

    // Update loading state
    App.setLoading(false)
  },

  renderTasks: async () => {
    // Load the total task count from the blockchain
    const taskCount = await App.todoList.taskCount()
    const $taskTemplate = $('.taskTemplate')

    // Render out each task with a new task template
    for (var i = 1; i <= taskCount; i++) {
      // Fetch the task data from the blockchain
      const task = await App.todoList.tasks(i)
      const taskId = task[0].toNumber()
      const taskContent = task[1]
      const taskCompleted = task[2]

      // Create the html for the task
      const $newTaskTemplate = $taskTemplate.clone()
      $newTaskTemplate.find('.content').html(taskContent)
      $newTaskTemplate.find('input')
                      .prop('name', taskId)
                      .prop('checked', taskCompleted)
                      // .on('click', App.toggleCompleted)

      // Put the task in the correct list
      if (taskCompleted) {
        $('#completedTaskList').append($newTaskTemplate)
      } else {
        $('#taskList').append($newTaskTemplate)
      }

      // Show the task
      $newTaskTemplate.show()
    }
  },

  setLoading: (boolean) => {
    App.loading = boolean
    const loader = $('#loader')
    const content = $('#content')
    if (boolean) {
      loader.show()
      content.hide()
    } else {
      loader.hide()
      content.show()
    }
  }
}

$(() => {
  $(window).load(() => {
    App.load()
  })
})
```

æˆ‘æ¥è§£é‡Šä¸€ä¸‹è¿™æ®µä»£ç ã€‚æˆ‘ä»¬å·²ç»åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„`App`å¯¹è±¡ï¼Œå®ƒåŒ…å«äº†è¿è¡Œ JavaScript åº”ç”¨ç¨‹åºæ‰€éœ€çš„æ‰€æœ‰å‡½æ•°ã€‚æˆ‘å°†åœ¨è¿™é‡Œè§£é‡Šé‡è¦çš„åŠŸèƒ½ã€‚å®Œæ•´çš„è§£é‡Šï¼Œ[çœ‹æˆ‘åœ¨ 40:25](https://youtu.be/rzvk2kdjr2I?t=40m25s) è§£é‡Šè§†é¢‘ä¸­çš„ JavaScript ä»£ç ã€‚è¿˜è¦æ³¨æ„ï¼Œæˆ‘å·²ç»æ³¨é‡Šæ‰äº†å‡ è¡Œä»£ç ï¼Œæˆ‘ä»¬å°†åœ¨åé¢çš„å°èŠ‚ä¸­å¯ç”¨å®ƒä»¬ã€‚

*   web3.js æ˜¯ä¸€ä¸ª JavaScript åº“ï¼Œå…è®¸æˆ‘ä»¬çš„å®¢æˆ·ç«¯åº”ç”¨ç¨‹åºä¸åŒºå—é“¾å¯¹è¯ã€‚æˆ‘ä»¬åœ¨è¿™é‡Œé…ç½® web3ã€‚è¿™æ˜¯å…ƒæ©ç æŒ‡å®šçš„é»˜è®¤ web3 é…ç½®ã€‚å¦‚æœä½ ä¸å®Œå…¨æ˜ç™½è¿™é‡Œå‘ç”Ÿäº†ä»€ä¹ˆï¼Œä¸è¦æ‹…å¿ƒã€‚è¿™æ˜¯ Metamask å»ºè®®çš„å¤åˆ¶ç²˜è´´å®ç°ã€‚
*   è¿™æ˜¯æˆ‘ä»¬ä»åŒºå—é“¾åŠ è½½æ™ºèƒ½åˆçº¦æ•°æ®çš„åœ°æ–¹ã€‚æˆ‘ä»¬ç”¨ Truffle å¥‘çº¦åº“åˆ›å»ºäº†æ™ºèƒ½å¥‘çº¦çš„ JavaScript è¡¨ç¤ºã€‚ç„¶åï¼Œæˆ‘ä»¬ç”¨ web3 åŠ è½½æ™ºèƒ½åˆåŒæ•°æ®ã€‚è¿™å°†å…è®¸æˆ‘ä»¬åœ¨å¾…åŠäº‹é¡¹åˆ—è¡¨ä¸­åˆ—å‡ºä»»åŠ¡ã€‚
*   è¿™æ˜¯æˆ‘ä»¬åœ¨å¾…åŠäº‹é¡¹åˆ—è¡¨ä¸­å®é™…åˆ—å‡ºä»»åŠ¡çš„åœ°æ–¹ã€‚è¯·æ³¨æ„ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª for å¾ªç¯æ¥å•ç‹¬è®¿é—®æ¯ä¸ªä»»åŠ¡ã€‚è¿™æ˜¯å› ä¸ºæˆ‘ä»¬æ— æ³•ä»æ™ºèƒ½åˆçº¦ä¸­è·å–æ•´ä¸ªä»»åŠ¡æ˜ å°„ã€‚æˆ‘ä»¬å¿…é¡»é¦–å…ˆç¡®å®š`taskCount`å¹¶é€ä¸ªè·å–æ¯ä¸ªä»»åŠ¡ã€‚

ç°åœ¨è®©æˆ‘ä»¬å¯åŠ¨ web æœåŠ¡å™¨ï¼Œå¹¶ç¡®ä¿é¡¹ç›®å°†åœ¨æµè§ˆå™¨ä¸­åŠ è½½ã€‚

```js
$ npm run dev
```

è€¶ï¼ğŸ‰æ‚¨å·²ç»æˆåŠŸåŠ è½½äº†å®¢æˆ·ç«¯åº”ç”¨ç¨‹åºã€‚ğŸ˜ƒè¯·æ³¨æ„ï¼Œæ‚¨çš„åº”ç”¨ç¨‹åºæ˜¾ç¤ºâ€œæ­£åœ¨åŠ è½½...â€ã€‚é‚£æ˜¯å› ä¸ºæˆ‘ä»¬è¿˜æ²¡æœ‰ç™»å½•åˆ°åŒºå—é“¾ï¼ä¸ºäº†è¿æ¥åˆ°åŒºå—é“¾ï¼Œæˆ‘ä»¬éœ€è¦å°†å…¶ä¸­ä¸€ä¸ªå¸æˆ·ä» Ganache å¯¼å…¥ Metamaskã€‚ä½ å¯ä»¥[åœ¨ 43:55](https://youtu.be/rzvk2kdjr2I?t=43m55s) çœ‹æˆ‘åœ¨è§†é¢‘é‡Œè®¾ç½® Metamaskã€‚

![Ethereum Todo List Loading](img/dc3b304b96a9f02452fc9308b6cc71bc.png)

ä¸€æ—¦æ‚¨ä¸ Metamask å»ºç«‹äº†è¿æ¥ï¼Œæ‚¨åº”è¯¥ä¼šçœ‹åˆ°æ‰€æœ‰çš„åˆåŒå’Œå¸æˆ·æ•°æ®éƒ½å·²åŠ è½½ã€‚

![Ethereum Todo List Loaded](img/f66fa8011788c78a1930ce1de68091c9.png)

ğŸ’¥å˜£ï¼è¿™æ˜¯ä½ çš„å¾…åŠäº‹é¡¹åˆ—è¡¨ï¼ğŸ˜ƒ

#### æµ‹è¯•

ç°åœ¨ï¼Œè®©æˆ‘ä»¬ç¼–å†™ä¸€ä¸ªåŸºæœ¬æµ‹è¯•æ¥ç¡®ä¿å¾…åŠäº‹é¡¹åˆ—è¡¨æ™ºèƒ½å¥‘çº¦æ­£å¸¸å·¥ä½œã€‚é¦–å…ˆï¼Œè®©æˆ‘è§£é‡Šä¸€ä¸‹ä¸ºä»€ä¹ˆåœ¨å¼€å‘æ™ºèƒ½åˆåŒæ—¶æµ‹è¯•å¦‚æ­¤é‡è¦ã€‚æˆ‘ä»¬å¸Œæœ›ç¡®ä¿åˆåŒæ²¡æœ‰ bugï¼ŒåŸå› å¦‚ä¸‹:

1.  ä»¥å¤ªåŠåŒºå—é“¾ä¸Šçš„æ‰€æœ‰ä»£ç éƒ½æ˜¯ä¸å¯å˜çš„ï¼›å®ƒä¸èƒ½æ”¹å˜ã€‚å¦‚æœåˆåŒåŒ…å«ä»»ä½•é”™è¯¯ï¼Œæˆ‘ä»¬å¿…é¡»ç¦ç”¨å®ƒå¹¶éƒ¨ç½²ä¸€ä¸ªæ–°çš„å‰¯æœ¬ã€‚è¿™ä¸ªæ–°å‰¯æœ¬ä¸æ—§åˆåŒçš„çŠ¶æ€ä¸åŒï¼Œåœ°å€ä¹Ÿä¸åŒã€‚
2.  éƒ¨ç½²å¥‘çº¦éœ€è¦è€—è´¹å¤§é‡èµ„æºï¼Œå› ä¸ºå®ƒä¼šåˆ›å»ºä¸€ä¸ªäº‹åŠ¡å¹¶å°†æ•°æ®å†™å…¥åŒºå—é“¾ã€‚è¿™éœ€è¦æ¶ˆè€—ä¹™é†šï¼Œè€Œæˆ‘ä»¬å¸Œæœ›å°½å¯èƒ½å‡å°‘ä¹™é†šçš„ç”¨é‡ã€‚
3.  å¦‚æœå†™å…¥åŒºå—é“¾çš„ä»»ä½•å¥‘çº¦å‡½æ•°åŒ…å«é”™è¯¯ï¼Œè°ƒç”¨è¯¥å‡½æ•°çš„å¸æˆ·å¯èƒ½ä¼šæµªè´¹èµ„æºï¼Œå¹¶ä¸”å®ƒå¯èƒ½ä¸ä¼šæŒ‰ç…§é¢„æœŸçš„æ–¹å¼è¿è¡Œã€‚

è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªè¿™æ ·çš„æµ‹è¯•æ–‡ä»¶:

```js
$ test/TodoList.test.js
```

æˆ‘ä»¬å°†åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­ç”¨ Javascript ç¼–å†™æ‰€æœ‰çš„æµ‹è¯•ï¼Œç”¨[Mocha æµ‹è¯•æ¡†æ¶](https://mochajs.org/)å’Œ[Chai æ–­è¨€åº“](http://www.chaijs.com/)ã€‚è¿™äº›éƒ½ä¸ Truffle æ¡†æ¶æ†ç»‘åœ¨ä¸€èµ·ã€‚æˆ‘ä»¬å°†ä½¿ç”¨ Javascript ç¼–å†™æ‰€æœ‰è¿™äº›æµ‹è¯•æ¥æ¨¡æ‹Ÿå®¢æˆ·ç«¯ä¸æ™ºèƒ½åˆçº¦çš„äº¤äº’ï¼Œå°±åƒæˆ‘ä»¬åœ¨æ§åˆ¶å°ä¸­æ‰€åšçš„ä¸€æ ·ã€‚ä»¥ä¸‹æ˜¯æµ‹è¯•çš„æ‰€æœ‰ä»£ç :

```js
const TodoList = artifacts.require('./TodoList.sol')

contract('TodoList', (accounts) => {
  before(async () => {
    this.todoList = await TodoList.deployed()
  })

  it('deploys successfully', async () => {
    const address = await this.todoList.address
    assert.notEqual(address, 0x0)
    assert.notEqual(address, '')
    assert.notEqual(address, null)
    assert.notEqual(address, undefined)
  })

  it('lists tasks', async () => {
    const taskCount = await this.todoList.taskCount()
    const task = await this.todoList.tasks(taskCount)
    assert.equal(task.id.toNumber(), taskCount.toNumber())
    assert.equal(task.content, 'Check out dappuniversity.com')
    assert.equal(task.completed, false)
    assert.equal(taskCount.toNumber(), 1)
  })
})
```

æˆ‘æ¥è§£é‡Šä¸€ä¸‹è¿™æ®µä»£ç ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦è¦æ±‚å¥‘çº¦å¹¶å°†å…¶èµ‹ç»™ä¸€ä¸ªå˜é‡ï¼Œå°±åƒæˆ‘ä»¬åœ¨è¿ç§»æ–‡ä»¶ä¸­æ‰€åšçš„é‚£æ ·ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è°ƒç”¨â€œå¥‘çº¦â€å‡½æ•°ï¼Œå¹¶åœ¨å›è°ƒå‡½æ•°ä¸­ç¼–å†™æˆ‘ä»¬æ‰€æœ‰çš„æµ‹è¯•ã€‚è¿™ä¸ªå›è°ƒå‡½æ•°æä¾›äº†ä¸€ä¸ªâ€œaccountsâ€å˜é‡ï¼Œä»£è¡¨æˆ‘ä»¬çš„åŒºå—é“¾ä¸Šçš„æ‰€æœ‰å¸æˆ·ï¼Œç”± Ganache æä¾›ã€‚

ç¬¬ä¸€ä¸ªæµ‹è¯•é€šè¿‡æ£€æŸ¥åœ°å€æ¥æ£€æŸ¥å¥‘çº¦æ˜¯å¦è¢«æ­£ç¡®åœ°éƒ¨ç½²åˆ°åŒºå—é“¾ã€‚

ä¸‹ä¸€ä¸ªæµ‹è¯•é€šè¿‡æ£€æŸ¥æˆ‘ä»¬åœ¨åˆå§‹åŒ–å‡½æ•°ä¸­åˆ›å»ºçš„é»˜è®¤ä»»åŠ¡æ¥æ£€æŸ¥æ™ºèƒ½å¥‘çº¦æ˜¯å¦æ­£ç¡®åˆ—å‡ºäº†ä»»åŠ¡ã€‚

ç°åœ¨è®©æˆ‘ä»¬ä»å‘½ä»¤è¡Œè¿è¡Œæµ‹è¯•ï¼Œå¦‚ä¸‹æ‰€ç¤º:

```js
$ truffle test
```

è€¶ï¼Œä»–ä»¬é€šè¿‡äº†ï¼ğŸ‰å¦‚æœä½ è¢«å¡ä½äº†ï¼Œä½ å¯ä»¥åœ¨æˆ‘å†™è¿™äº›æµ‹è¯•çš„è§†é¢‘ä¸­è·Ÿæˆ‘ä¸€èµ·åšè¿›ä¸€æ­¥çš„è§£é‡Šã€‚

## åˆ›å»ºä»»åŠ¡

è¿™éƒ¨åˆ†æ•™ç¨‹çš„è§†é¢‘ç‰‡æ®µä» [1:05:07](https://www.youtube.com/watch?v=rzvk2kdjr2I&feature=youtu.be&t=1h05m07s) å¼€å§‹ã€‚

æˆ‘ä»¬å·²ç»åˆ›å»ºäº†ä¸€ä¸ªåˆ›å»ºä»»åŠ¡çš„å‡½æ•°ï¼Œä½†æ˜¯å®ƒè¿˜æ²¡æœ‰å®Œæˆã€‚è¿™æ˜¯å› ä¸ºæˆ‘æƒ³åœ¨åˆ›å»ºæ–°ä»»åŠ¡æ—¶è§¦å‘ä¸€ä¸ªäº‹ä»¶ã€‚å¯é æ€§å…è®¸æˆ‘ä»¬è§¦å‘å¤–éƒ¨æ¶ˆè´¹è€…å¯ä»¥è®¢é˜…çš„ä»»æ„äº‹ä»¶ã€‚å®ƒå°†å…è®¸æˆ‘ä»¬åœ¨å®¢æˆ·ç«¯åº”ç”¨ç¨‹åºç­‰ä¸­ç›‘å¬è¿™äº›äº‹ä»¶...è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ª`TaskCreated()`äº‹ä»¶ï¼Œå¹¶åœ¨`createTask()`å‡½æ•°ä¸­åˆ›å»ºæ–°ä»»åŠ¡æ—¶è§¦å‘å®ƒï¼Œå¦‚ä¸‹æ‰€ç¤º:

```js
pragma solidity ^0.5.0;

contract TodoList {

  // ...

  event TaskCreated(
    uint id,
    string content,
    bool completed
  );

  // ...

  function createTask(string memory _content) public {
    taskCount ++;
    tasks[taskCount] = Task(taskCount, _content, false);
    emit TaskCreated(taskCount, _content, false);
  }

}
```

ç°åœ¨ï¼Œè®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæµ‹è¯•ï¼Œä»¥ç¡®ä¿æ¯å½“åˆ›å»ºæ–°ä»»åŠ¡æ—¶éƒ½ä¼šè§¦å‘è¯¥äº‹ä»¶ã€‚åˆ›å»ºæ–°ä»»åŠ¡æ—¶ï¼Œæˆ‘ä»¬å°†æ£€æŸ¥äº¤æ˜“æ”¶æ®ã€‚è¿™å°†åŒ…å«æ‰€æœ‰åŒ…å«äº‹ä»¶æ•°æ®çš„æ—¥å¿—ä¿¡æ¯ã€‚æˆ‘ä»¬å¯ä»¥åƒè¿™æ ·åœ¨æµ‹è¯•ä¸­æ£€æŸ¥è¿™äº›æ•°æ®ï¼Œä»¥ç¡®ä¿äº‹ä»¶è¢«æ­£ç¡®è§¦å‘:

```js
it('creates tasks', async () => {
  const result = await this.todoList.createTask('A new task')
  const taskCount = await this.todoList.taskCount()
  assert.equal(taskCount, 2)
  const event = result.logs[0].args
  assert.equal(event.id.toNumber(), 2)
  assert.equal(event.content, 'A new task')
  assert.equal(event.completed, false)
})
```

ç°åœ¨è®©æˆ‘ä»¬è¿è¡Œæµ‹è¯•:

```js
$ truffle test
```

è€¶ï¼Œä»–ä»¬é€šè¿‡äº†ï¼ğŸ‰ç°åœ¨ï¼Œè®©æˆ‘ä»¬å°†æ™ºèƒ½åˆçº¦çš„æ–°å‰¯æœ¬éƒ¨ç½²åˆ°åŒºå—é“¾ï¼Œå› ä¸ºä»£ç å·²ç»æ›´æ”¹:

```js
$ truffle migrate --reset
```

ç°åœ¨è®©æˆ‘ä»¬æ›´æ–°å®¢æˆ·ç«¯ä»£ç ã€‚æˆ‘ä»¬å°†é¦–å…ˆå–æ¶ˆå¯¹`index.html`æ–‡ä»¶ä¸­è¡¨å•ä»£ç çš„æ³¨é‡Š:

```js
<form onSubmit="App.createTask(); return false;">
  <input id="newTask" type="text" class="form-control" placeholder="Add task..." required>
  <input type="submit" hidden="">
</form>
```

ç°åœ¨æˆ‘ä»¬å°†åœ¨`app.js`æ–‡ä»¶ä¸­æ·»åŠ ä¸€ä¸ª`createTask()`å‡½æ•°ï¼Œå¦‚ä¸‹æ‰€ç¤º:

```js
createTask: async () => {
  App.setLoading(true)
  const content = $('#newTask').val()
  await App.todoList.createTask(content)
  window.location.reload()
},
```

ç°åœ¨ï¼Œæ‚¨åº”è¯¥èƒ½å¤Ÿä»å®¢æˆ·ç«¯åº”ç”¨ç¨‹åºæ·»åŠ æ–°ä»»åŠ¡äº†ï¼æ³¨æ„ï¼Œè¡¨å•ä¸Šæ²¡æœ‰â€œæäº¤â€æŒ‰é’®ã€‚æˆ‘å…³é—­å®ƒæ˜¯ä¸ºäº†ç®€åŒ–ç”¨æˆ·ç•Œé¢ã€‚ä½ å¿…é¡»æŒ‰ä¸‹é”®ç›˜ä¸Šçš„â€œå›è½¦â€é”®æ¥æäº¤ä»»åŠ¡ã€‚ä¸€æ—¦ä½ è¿™æ ·åšï¼Œä½ ä¼šçœ‹åˆ°ä¸€ä¸ªå…ƒæ©ç ç¡®è®¤å¼¹å‡ºã€‚æ‚¨å¿…é¡»ç­¾ç½²æ­¤äº‹åŠ¡æ‰èƒ½åˆ›å»ºä»»åŠ¡ã€‚

## å®Œæˆä»»åŠ¡

æœ¬æ•™ç¨‹è¿™ä¸€éƒ¨åˆ†çš„è§†é¢‘ç‰‡æ®µä» [1:16:40](https://www.youtube.com/watch?v=rzvk2kdjr2I&feature=youtu.be&t=1h16m40s) å¼€å§‹ã€‚

ç°åœ¨ï¼Œæˆ‘ä»¬åœ¨æœ¬æ•™ç¨‹ä¸­è¦åšçš„æœ€åä¸€ä»¶äº‹æ˜¯â€œæ£€æŸ¥â€å¾…åŠäº‹é¡¹åˆ—è¡¨ä¸­çš„ä»»åŠ¡ã€‚ä¸€æ—¦æˆ‘ä»¬è¿™æ ·åšäº†ï¼Œå®ƒä»¬å°±ä¼šå‡ºç°åœ¨â€œå·²å®Œæˆâ€åˆ—è¡¨ä¸­ï¼Œå°½ç®¡ä¼šè¢«åˆ é™¤ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬å°†æ›´æ–°æ™ºèƒ½åˆåŒã€‚æˆ‘ä»¬å°†æ·»åŠ ä¸€ä¸ª`TaskComplted()`äº‹ä»¶ï¼Œå¹¶åœ¨ä¸€ä¸ªæ–°çš„`toggleCompleted()`å‡½æ•°ä¸­è§¦å‘å®ƒï¼Œå¦‚ä¸‹æ‰€ç¤º:

```js
pragma solidity ^0.5.0;

contract TodoList {

  // ...

  event TaskCompleted(
    uint id,
    bool completed
  );

  // ...

  function toggleCompleted(uint _id) public {
    Task memory _task = tasks[_id];
    _task.completed = !_task.completed;
    tasks[_id] = _task;
    emit TaskCompleted(_id, _task.completed);
  }

}
```

ç°åœ¨æˆ‘ä»¬å°†ç¼–å†™ä¸€ä¸ªè¿™æ ·çš„æµ‹è¯•:

```js
it('toggles task completion', async () => {
  const result = await this.todoList.toggleCompleted(1)
  const task = await this.todoList.tasks(1)
  assert.equal(task.completed, true)
  const event = result.logs[0].args
  assert.equal(event.id.toNumber(), 1)
  assert.equal(event.completed, true)
})
```

ç°åœ¨è®©æˆ‘ä»¬è¿è¡Œæµ‹è¯•:

```js
$ truffle test
```

è€¶ï¼Œå®ƒè¿‡å»äº†ï¼ğŸ‰ç°åœ¨ï¼Œè®©æˆ‘ä»¬å°†æ™ºèƒ½åˆçº¦çš„æ–°å‰¯æœ¬éƒ¨ç½²åˆ°åŒºå—é“¾ï¼Œå› ä¸ºä»£ç å·²ç»æ›´æ”¹:

```js
$ truffle migrate --reset
```

ç°åœ¨è®©æˆ‘ä»¬æ›´æ–°å®¢æˆ·ç«¯ä»£ç ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬å°†å–æ¶ˆå¯¹`renderTasks()`å‡½æ•°ä¸­äº‹ä»¶ç›‘å¬å™¨çš„æ³¨é‡Š:

```js
$newTaskTemplate.find('input')
  .prop('name', taskId)
  .prop('checked', taskCompleted)
  .on('click', App.toggleCompleted)
```

ç°åœ¨æˆ‘ä»¬å°†åœ¨`app.js`æ–‡ä»¶ä¸­æ·»åŠ ä¸€ä¸ª`toggleCompleted()`å‡½æ•°ï¼Œå¦‚ä¸‹æ‰€ç¤º:

```js
toggleCompleted: async (e) => {
  App.setLoading(true)
  const taskId = e.target.name
  await App.todoList.toggleCompleted(taskId)
  window.location.reload()
},
```

ç°åœ¨ï¼Œåœ¨å®¢æˆ·ç«¯åº”ç”¨ç¨‹åºä¸­æ‰¾åˆ°ä¸€ä¸ªä»»åŠ¡ï¼Œç„¶åå•å‡»å¤é€‰æ¡†ã€‚ä¸€æ—¦æ‚¨ç­¾ç½²äº†æ­¤äº‹åŠ¡ï¼Œå®ƒå°†ä»å¾…åŠäº‹é¡¹åˆ—è¡¨ä¸­æ£€æŸ¥ä»»åŠ¡ï¼

æ­å–œä½ ï¼ğŸ‰æ‚¨å·²ç»æˆåŠŸæ„å»ºäº†ä¸€ä¸ªç”±ä»¥å¤ªåŠæ™ºèƒ½åˆçº¦æ”¯æŒçš„å…¨æ ˆåŒºå—é“¾åº”ç”¨ç¨‹åºï¼ä½ å¯ä»¥åœ¨è¿™é‡Œä¸‹è½½æœ¬æ•™ç¨‹çš„å®Œæ•´æºä»£ç [ï¼Œåœ¨è¿™é‡Œ](https://github.com/dappuniversity/eth-todo-list)è§‚çœ‹å®Œæ•´è§†é¢‘[ã€‚](https://www.youtube.com/watch?v=rzvk2kdjr2I)

å¯¹è¿™ä¸ªæ•™ç¨‹æ»¡æ„å—ï¼Ÿç„¶åä½ **éœ€è¦**åˆ°[åœ¨è¿™é‡Œå‚åŠ æˆ‘çš„å…è´¹åŸ¹è®­](/bootcamp)ï¼Œæˆ‘å°†å‘ä½ å±•ç¤ºå¦‚ä½•æ„å»ºä¸€ä¸ªçœŸå®ä¸–ç•Œçš„åŒºå—é“¾åº”ç”¨ç¨‹åºï¼Œè¿™æ ·ä½ å°±å¯ä»¥æˆä¸ºä¸€åé«˜è–ªçš„åŒºå—é“¾å¼€å‘è€…ï¼

*